<!DOCTYPE html>
<html>
    <head>
	  <meta charset="utf-8">
	  <meta http-equiv="x-ua-compatible" content="ie=edge">
	  <meta name="viewport" content="width=device-width, initial-scale=1">

	  <title>Examples</title>
	  
	  <link rel="shortcut icon" type="image/x-icon" href="/imandra-docs/favicon.ico">
	  <link rel="stylesheet" href="/imandra-docs/css/main.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,300i,400,400i%7CMerriweather:300,300i,400,400i%7CRoboto+Slab:300,300i,400,400i">

	  <link rel="canonical" href="https://docs.imandra.ai//imandra-docs/examples/">
	  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.1/jquery.min.js"></script>
	  <script type="text/javascript" src = "/imandra-docs/jekyll-resources/assets/scripts/jquery.scrollme.min.js"></script>
	  <script type="text/javascript" src = "/imandra-docs/jekyll-resources/assets/scripts/jquery.sticky.min.js"></script>
	  <script type="text/javascript">
	  	 
		$(document).ready(function(){
			$("#StickMenu").sticky({topSpacing:52});
		});

	  </script>

</head> 


    <body>
	      <div class="TopRowContainer">
	<div class="TopRow">
		<div class="TopNavLogoContainer">
			<a class="TopNavLogoLink" href="https://docs.imandra.ai/">
				<img class="TopNavLogo" src = "/imandra-docs/jekyll-resources/assets/img/imandra_doc_logo_main.svg">
			</a>
		</div>
		<nav class="TopNavContainer">
			<ul class="TopNavList">
				
				 
				
				 
				
				
				
				
				<li class="TopNavListItem"><a class="TopNavLink" href="/imandra-docs/configuration/">Configuration</a></li>
				
				
				 
				
				
				
				
				<li class="TopNavListItem"><a class="TopNavLink TopNavLink__Active" href="/imandra-docs/examples/">Examples</a></li>
				
				
				 
				
				
				
				
				<li class="TopNavListItem"><a class="TopNavLink" href="/imandra-docs/hacking/">Hacking</a></li>
				
				
				 
				
				
				
				
				<li class="TopNavListItem"><a class="TopNavLink" href="/imandra-docs/regionDecomposition/">Region Decomposition</a></li>
				
				
				 
				
				
				
				
				<li class="TopNavListItem"><a class="TopNavLink" href="/imandra-docs/extra/">Further functionality</a></li>
				
				
				
			</ul>
		</nav>
	</div>
</div>

<header class="TemplateHeader">
	<div class="TemplateHeaderImageContainer">
	<a href ="/imandra-docs">
		<img class="SiteSpecificImage" src="/imandra-docs/assets/img/site_specific_image_v_2.svg">
	</a>
	</div>
</header>


	      <main class="MainContentColumn">
		        <article class="ArticleContainer">
			          <!-- Sidebar -->
<div class="SideMenuContainer">
    <div id="StickMenu" class="SideMenu">
        
        
        
        
        <A href=#>Examples</A>
        
        
        
        <A href=#gauss>Gauss</A>
        
        
        
        <A href=#insertionSort>Insertion sort</A>
        
        
        
        <A href=#orderRankingTransitivity>Order ranking transitivity</A>
        
        
        
        <A href=#inductionTermination>Induction and Termination</A>
        
        
        
    </div>
</div>
<!--MainContent-->
<div class="MainContent">
    
    
    
    <h2 id=examples>Examples</h2>
    
    <p>In this section, we collect useful examples that concretely illustrate Imandra in various contexts.</p>

<p>Each example is self-contained. We suggest beginning with <code class="highlighter-rouge">Gauss.</code></p>

    
    
    <h2 class="internalLink-padding" id=gauss>Gauss</h2>
    
    <p>Let’s use Imandra to reason about a simple recursive function.</p>

<p>Given an input integer <code class="highlighter-rouge">n</code>, this function sums up the integers from <code class="highlighter-rouge">0</code> to <code class="highlighter-rouge">n</code>.</p>

<p>First, we enable “rational division,” which causes Imandra’s reasoning engine to treat division between integers as exact rational division:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># :rational_div on
</code></pre></div></div>

<p>Whenever we define a recursive function, Imandra must be able to prove that the function is terminating (also called being “total”).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># let rec sum(n) =
  if n &lt;= 0 then 0 else n + sum (n-1);;
val sum : int -&gt; int = &lt;fun&gt;
</code></pre></div></div>

<p>This particular function was easy for Imandra to prove totality, but it is worth taking a look at the <code class="highlighter-rouge">:skipterm</code> directive and “termination measures” in case you have a problematic function.</p>

<p>Now that this function is defined, we can compute with it:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># sum 3;;
- : int = 6
# sum 10;;
- : int = 55
# sum 99;;
- : int = 4950
# sum 100;;
- : int = 5050
</code></pre></div></div>

<p>Now, we ask Imandra to verify a key property of the summation function:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># verify gauss (n) =
  n &gt;= 0
    ==&gt;
  sum n = (n * (n+1)) / 2;;

thm gauss = &lt;proved&gt;
</code></pre></div></div>

<p>But what if we had tried to verify something that was false? 
Notice below that we make a mistake, replacing <code class="highlighter-rouge">(n+1)</code> with <code class="highlighter-rouge">(n-1)</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># verify gauss_bad (n) =
  n &gt;= 0
  ==&gt;
  sum n = (n * (n-1)) / 2;;

Counterexample:

{ n = 1; }
</code></pre></div></div>

    
    
    <h2 class="internalLink-padding" id=insertionSort>Insertion sort</h2>
    
    <p>Let’s use Imandra to verify an implementation of <em>insertion sort</em>. 
[block:api-header]
{
  “type”: “basic”,
  “title”: “1. Define the function”
}
[/block]
You may be familiar with languages like Python. Here’s a Python implementation of the algorithm:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">i_sort</span><span class="p">(</span> <span class="n">lst</span> <span class="p">):</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)):</span>
  <span class="n">tmp</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">k</span> <span class="o">=</span> <span class="n">i</span>
  <span class="k">while</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="n">lst</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">k</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">lst</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
</code></pre></div></div>

<p>Notice the nested iteration, i.e., the while-loop nested inside of the outer for-loop.</p>

<p>Mathematically, this suggests that we use two recursive functions to give a functional definition of this algorithm.</p>

<p>Let’s implement this in Imandra.</p>

<p>First, we’ll define the <code class="highlighter-rouge">insert</code> function:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># let rec insert (a,lst) =
  match lst with
  []      -&gt; [a]
  | x :: xs -&gt;
    if a &lt; x then a :: x :: xs else x :: insert(a, xs);;

val insert : 'a * 'a list -&gt; 'a list = &lt;fun&gt;,
</code></pre></div></div>

<p>Next, we’ll define the <code class="highlighter-rouge">sorting</code> function:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># let rec i_sort lst =
  match lst with
  []      -&gt; []
  | x :: xs -&gt; insert(x, i_sort xs);;

val i_sort : 'a list -&gt; 'a list = &lt;fun&gt;
</code></pre></div></div>
<p>Note that both definitions were accepted (and thus proved to be terminating) by Imandra.</p>

<p>Note also the type of <code class="highlighter-rouge">i_sort</code> computed by Imandra. This type <code class="highlighter-rouge">'a list -&gt; 'a list</code> tells us that <code class="highlighter-rouge">i_sort</code> is a polymorphic function: It will accept as input a list of any type of values (all values in the list having type <code class="highlighter-rouge">'a</code> where <code class="highlighter-rouge">'a</code> is arbitrary), and will compute as output a list of the same type.
(This is possible as the comparison function <code class="highlighter-rouge">&lt;</code> used in the definition of <code class="highlighter-rouge">insert</code> is itself polymorphic.)</p>

<p>With these functions admitted, we can now compute with them:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># i_sort [7; 3; 890; 100];;

- : int list = [3; 7; 100; 890]
</code></pre></div></div>

<p>Excellent. But is the code actually correct? Are there ever any corner cases where it can fail to produce a sorted list as output?</p>

<p>We can ask Imandra.</p>

<p>First, we define a specification of what it means for a list to be sorted:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># let rec is_sorted (x) =
  match x with
  | a :: b :: xs -&gt; (a &lt;= b) &amp;&amp; is_sorted (b::xs)
  | _ -&gt; true;;

val is_sorted : 'a list -&gt; bool = &lt;fun&gt;
</code></pre></div></div>

<p>Take some time to think about this definition.</p>

<p>Now, we can ask Imandra to verify a correctness theorem:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># verify i_sort_spec x =
  is_sorted (i_sort x);;

thm i_sort_spec = &lt;proved&gt;
</code></pre></div></div>

<p>Success! And very quickly:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># :t\nLast timed event: 0.395 sec.
</code></pre></div></div>

<p>But now let’s think more about our spec. Is our spec really expressing what we want it to?</p>

<p>Not completely! Why? Consider the following function:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># let i_sort_bad (x) = [];;

val i_sort_bad : 'a -&gt; 'b list = &lt;fun&gt;
</code></pre></div></div>

<p>This function also satisfies our spec:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># verify i_sort_bad_spec x =
  is_sorted (i_sort_bad x);;

thm i_sort_bad_spec = &lt;proved&gt;
</code></pre></div></div>
<p>We must also consider the property that the output is a permutation of its input.</p>

<p>Defining and proving this property of <code class="highlighter-rouge">i_sort</code> is a great Imandra exercise!</p>

    
    
    <h2 class="internalLink-padding" id=orderRankingTransitivity>Order ranking transitivity</h2>
    
    <p>This example is based on our white paper titled ‘Case Study: 2015 SEC fine against UBS ATS’.</p>

<p>As part of the case study, we took the publicly available Form ATS (dated June 1st, 2015) and encoded it as an Imandra venue model. Our goal was to demonstrate how UBS could could have automatically picked up the issues raised by the SEC with Imandra.</p>

<p>In particular, the report demonstrates verification goals targeting ‘sub-penny’ pricing and crossing restrictions. In the course of creating the model and verified those goals, we realised that under one interpretation of their Form ATS, their model’s ranking function violates transitivity.</p>

<p>Let us analyse!</p>

<h4 id="transitivity">Transitivity</h4>

<p>As a simple example, consider three numbers a, b and c.</p>

<p>If <code class="highlighter-rouge">a &gt; b</code> and <code class="highlighter-rouge">b &gt; c</code>, then it must be true that <code class="highlighter-rouge">a &gt; c</code>. This is a fundamental property of the “greater than” function. This property is called <em>transitivity</em>. We say that <code class="highlighter-rouge">&gt;</code> is <em>transitive</em>.</p>

<p>When we use a sorting algorithm to sort a list of items with respect to some comparison function, it’s important that the comparison be transitive.</p>

<p>Similarly, the way that orders are sorted within an order book must also be transitive. Otherwise, the sorting algorithm may easily rank orders incorrectly, and ensuring regulations like “best execution” becomes hopeless. Flaws like this are very difficult to catch by analysing a venue’s post-trade data alone. For example, in modern dark pools, there can be many valid (and legal) reasons why two orders that agree in price will not trade with one another.</p>

<p>Fundamentally, this is an issue of the matching logic that must be analysed and eliminated.</p>

<h4 id="loading-the-example-in-imandra-cloud">Loading the example in Imandra Cloud</h4>

<p>The Examples folder of your Imandra installation should have the full version of the code we’re referencing, under <code class="highlighter-rouge">Transitivity</code>. So, we will just provide the most relevant fragment here.</p>

<p>Below we define the function <code class="highlighter-rouge">order_higher_ranked</code> that is used by the sorting algorithm to ensure that the book is always order with respect to priority.</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">order_higher_ranked</span> <span class="p">(</span><span class="n">side</span><span class="o">,</span> <span class="n">o1</span><span class="o">,</span> <span class="n">o2</span><span class="o">,</span> <span class="n">mkt</span><span class="p">)</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">ot1</span> <span class="o">=</span> <span class="n">o1</span><span class="o">.</span><span class="n">order_type</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">ot2</span> <span class="o">=</span> <span class="n">o2</span><span class="o">.</span><span class="n">order_type</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">p_price1</span> <span class="o">=</span> <span class="n">priority_price</span> <span class="p">(</span><span class="n">side</span><span class="o">,</span> <span class="n">o1</span><span class="o">,</span> <span class="n">mkt</span><span class="p">)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">p_price2</span> <span class="o">=</span> <span class="n">priority_price</span> <span class="p">(</span><span class="n">side</span><span class="o">,</span> <span class="n">o2</span><span class="o">,</span> <span class="n">mkt</span><span class="p">)</span> <span class="k">in</span>
  
  <span class="k">let</span> <span class="n">wins_price</span> <span class="o">=</span>
    <span class="k">begin</span>
      <span class="k">if</span> <span class="n">side</span> <span class="o">=</span> <span class="nc">BUY</span> <span class="k">then</span>
        <span class="k">begin</span>
          <span class="k">if</span> <span class="n">p_price1</span> <span class="o">&gt;</span> <span class="n">p_price2</span> <span class="k">then</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="k">if</span> <span class="n">p_price1</span> <span class="o">=</span> <span class="n">p_price2</span> <span class="k">then</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="k">begin</span>
          <span class="k">if</span> <span class="n">p_price1</span> <span class="o">&lt;</span> <span class="n">p_price2</span> <span class="k">then</span> <span class="mi">1</span>
          <span class="k">else</span> <span class="k">if</span> <span class="n">p_price1</span> <span class="o">=</span> <span class="n">p_price2</span> <span class="k">then</span> <span class="mi">0</span>
          <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">end</span>
    <span class="k">end</span> <span class="k">in</span>

  <span class="k">let</span> <span class="n">wins_time</span> <span class="o">=</span> 
    <span class="k">begin</span>
      <span class="k">if</span> <span class="n">o1</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">o2</span><span class="o">.</span><span class="n">time</span> <span class="k">then</span> <span class="mi">1</span>
      <span class="k">else</span> <span class="k">if</span> <span class="n">o1</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">o2</span><span class="o">.</span><span class="n">time</span> <span class="k">then</span> <span class="mi">0</span>
      <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">end</span> <span class="k">in</span>
      <span class="c">(* Note that the CI priority is price, quantity and then time *)</span>
      <span class="k">if</span> <span class="n">wins_price</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span> <span class="bp">true</span>
      <span class="k">else</span> <span class="k">if</span> <span class="n">wins_price</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">then</span> <span class="bp">false</span>
      <span class="k">else</span>
        <span class="k">begin</span>
          <span class="c">(* Same price level - first check to see whether we're comparing two   *)</span>
          <span class="c">(* CI orders here                                                      *)</span>
          <span class="k">if</span> <span class="n">not</span> <span class="p">(</span><span class="n">non_ci</span> <span class="p">(</span><span class="n">ot1</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="n">not</span> <span class="p">(</span><span class="n">non_ci</span> <span class="p">(</span><span class="n">ot2</span><span class="p">))</span> <span class="k">then</span>
            <span class="n">o1</span><span class="o">.</span><span class="n">leaves_qty</span> <span class="o">&gt;</span> <span class="n">o2</span><span class="o">.</span><span class="n">leaves_qty</span>
          <span class="k">else</span>
            <span class="k">begin</span>
              <span class="k">if</span> <span class="n">wins_time</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span> <span class="bp">true</span>
              <span class="k">else</span> <span class="k">if</span> <span class="n">wins_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">then</span> <span class="bp">false</span>
              <span class="k">else</span> <span class="p">(</span>
                <span class="k">if</span> <span class="n">non_ci</span><span class="p">(</span><span class="n">ot1</span><span class="p">)</span> <span class="k">then</span> <span class="bp">true</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">not</span><span class="p">(</span><span class="n">non_ci</span><span class="p">(</span><span class="n">ot1</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="n">non_ci</span><span class="p">(</span><span class="n">ot2</span><span class="p">))</span> <span class="k">then</span> <span class="bp">false</span>
                <span class="k">else</span> <span class="n">o1</span><span class="o">.</span><span class="n">leaves_qty</span> <span class="o">&gt;</span> <span class="n">o2</span><span class="o">.</span><span class="n">leaves_qty</span><span class="p">)</span>
            <span class="k">end</span>
        <span class="k">end</span>
<span class="p">;;</span>
</code></pre></div></div>

<p>Armed with the definition of the ranking function, we’re now ready to look for a transitivity counterexample. We will use the check command to start the direct search for it. The code is listed below. Note the constraints that the verification goal lists for the orders and market data.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>check _ (side, o1, o2, o3, mkt) =
  
  (order_higher_ranked(side,o1,o2,mkt) &amp;&amp;
    order_higher_ranked(side,o2,o3,mkt) &amp;&amp;
    o1.leaves_qty &lt;= o1.qty &amp;&amp;
    o2.leaves_qty &lt;= o2.qty &amp;&amp;
    o3.leaves_qty &lt;= o3.qty &amp;&amp;
    o1.time &gt;= 0 &amp;&amp;
    o2.time &gt;= 0 &amp;&amp;
    o3.time &gt;= 0 &amp;&amp;
    o1.price &gt; 0.0 &amp;&amp;
    o2.price &gt; 0.0 &amp;&amp;
    o3.price &gt; 0.0 &amp;&amp;
    o1.qty &gt; 0 &amp;&amp;
    o2.qty &gt; 0 &amp;&amp;
    o3.qty &gt; 0 &amp;&amp;
    o1.leaves_qty &gt;= 0 &amp;&amp;
    o2.leaves_qty &gt;= 0 &amp;&amp;
    o3.leaves_qty &gt;= 0 &amp;&amp;
    mkt.nbb &gt; 0.0 &amp;&amp;
    mkt.nbo &gt; 0.0)
  ==&gt;
    order_higher_ranked(side, o1, o3, mkt);;

</code></pre></div></div>

<p>When we run this, Imandra computes the following counterexample:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Counterexample:
{ 
  side = SELL;
  o1 = {
    id = 4;
    peg = FAR;
    client_id = 5;
    order_type = PEGGED;
    qty = 2289;
    min_qty = 6;
    leaves_qty = 1052;
    price = 3.0;
    time = 7720;
    src = 7;
    order_attr = RESIDENT;
    capacity = Principal;
    category = C_ONE;
    cross_restrict = {
      cr_self_cross = false;
      cr_ubs_principal = false;
      cr_round_lot_only = false;
      cr_no_locked_nbbo = false;
      cr_pegged_mid_point_mode = 3;
      cr_enable_conditionals = false;
      cr_min_qty = false;
      cr_cat_elig = {
        c_one_elig = false;
        c_two_elig = false;
        c_three_elig = false;
        c_four_elig = false;
      }; 
    }; 
    locate_found = false;
    expiry_time = 8; 
  };
  
  o2 = {
    id = 10;
    peg = FAR;
    client_id = 11;
    order_type = PEGGED_CI;
    qty = 2438;
    min_qty = 12;
    leaves_qty = 1052;
    price = 3.0;
    time = 7721;
    src = 13;
    order_attr = RESIDENT;
    capacity = Principal;
    category = C_ONE;
    cross_restrict = {
      cr_self_cross = false;
      cr_ubs_principal = false;
      cr_round_lot_only = false;
      cr_no_locked_nbbo = false;
      cr_pegged_mid_point_mode = 9;
      cr_enable_conditionals = false;
      cr_min_qty = false;
      cr_cat_elig = {
        c_one_elig = false;
        c_two_elig = false;
        c_three_elig = false;
        c_four_elig = false;
      };
    };
    locate_found = false;
    expiry_time = 14; 
  };
  
  o3 = {
    id = 18;
    peg = NEAR;
    client_id = 19;
    order_type = PEGGED_CI;
    qty = 8856;
    min_qty = 20;
    leaves_qty = 1051;
    price = 3.0;
    time = 7719;
    src = 21;
    order_attr = RESIDENT;
    capacity = Principal;
    category = C_ONE;
    cross_restrict = {
      cr_self_cross = false;
      cr_ubs_principal = false;
      cr_round_lot_only = false;
      cr_no_locked_nbbo = false;
      cr_pegged_mid_point_mode = 17;
      cr_enable_conditionals = false;
      cr_min_qty = false;
      cr_cat_elig = { 
        c_one_elig = false;
        c_two_elig = false;
        c_three_elig = false;
        c_four_elig = false; 
      }; 
    };
    locate_found = false;
    expiry_time = 22; 
  };
  
  mkt = {
    nbb = 1.0;
    nbo = 2.0;
    l_up = 4.0;
    l_down = 5.0; 
  }; 
}
</code></pre></div></div>

    
    
    <h2 class="internalLink-padding" id=inductionTermination>Induction and Termination</h2>
    
    <p>Proofs by induction are based upon an <em>induction principle.</em></p>

<p>With induction, we <em>deduce</em> a universal property <code class="highlighter-rouge">Forall x. P(x)</code> by assuming the property P holds for some ``smaller’’ values, and then combining the results.</p>

<p>Perhaps this reminds you of something: With recursion, we <em>compute</em> a value F(x) of a function by first computing F with respect to some <code class="highlighter-rouge">smaller</code> values, and then combining the results.</p>

<p>Indeed, recursion and induction are intimately related.</p>

<p>In Imandra, if we wish to prove a property about a recursive function, we will usually do this by induction. There are many subtleties, e.g., exactly which induction principle should be used, whether or not the formula being proved should be generalised, etc.</p>

<p>Let us approach these subjects with concrete examples.</p>

<h4 id="deleting-an-element-preserves-sorting">Deleting an element preserves sorting</h4>

<p>Note the use of the custom termination measure below. This gives us a simpler induction principle than the default, which allows us to prove our goal sorted_stable. (Will write more soon!).</p>
<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">let</span> <span class="k">rec</span> <span class="n">is_sorted</span> <span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">xs</span> <span class="k">with</span>
  <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">y</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span>
    <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">is_sorted</span> <span class="p">(</span><span class="nn">List</span><span class="p">.</span><span class="n">tl</span> <span class="n">xs</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">_</span> <span class="o">-&gt;</span> <span class="bp">true</span>
<span class="p">;;</span>


<span class="c">(* @meta[measure : delete_at]
    let measure_delete_at (i, xs) = List.length xs
  @end
*)</span>

<span class="k">let</span> <span class="k">rec</span> <span class="n">delete_at</span> <span class="p">(</span><span class="n">i</span><span class="o">,</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">xs</span> <span class="k">else</span>
    <span class="k">match</span> <span class="n">xs</span> <span class="k">with</span>
    <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
        <span class="n">rest</span>
      <span class="k">else</span>
        <span class="n">x</span> <span class="o">::</span> <span class="n">delete_at</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">rest</span><span class="p">)</span>
    <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
<span class="p">;;</span>

<span class="n">theorem</span><span class="p">[</span><span class="n">rw</span><span class="p">]</span> <span class="n">sorted_stable</span> <span class="p">(</span><span class="n">i</span><span class="o">,</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span>
  <span class="n">is_sorted</span> <span class="n">xs</span> <span class="o">==&gt;</span> <span class="n">is_sorted</span><span class="p">(</span><span class="n">delete_at</span><span class="p">(</span><span class="n">i</span><span class="o">,</span><span class="n">xs</span><span class="p">))</span>
<span class="p">;;</span>

</code></pre></div></div>

    
    
</div>
		        </article>
	      </main>
	      <footer class="Footer">
	  <a class="Copyrights"href="http://imandra.ai">&#9400; 2018 Aesthetic Integration Ltd. All rights reserved.</a>
</footer>

    </body>

</html>
