<!DOCTYPE html>
<html>
    <head><meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Imandra Documentation - Key Pair Security in Imandra</title>
        <meta property="og:url" content="https://docs.imandra.ai/imandra-docs/notebooks/key-pair-security/">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Imandra Documentation - Key Pair Security in Imandra">
        <meta property="og:description" content="In this ReasonML notebook, we use imandra to very quickly discover the 'man in the middle' attack for protocols with private/public key exchance protocols.">
        <meta property="og:image" content="https://storage.googleapis.com/imandra-assets/images/og_image_default_i78.jpg">


        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116937440-6"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());

         gtag('config', 'UA-116937440-1');
        </script>
        <script type="text/javascript"> var sc_project=11767520; var sc_invisible=1; var sc_security="fa7e88d1"; </script>
        <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
        <noscript><div class="statcounter">
            <a title="Web Analytics" href="http://statcounter.com/" target="_blank">
                <img class="statcounter" src="//c.statcounter.com/11767520/0/fa7e88d1/1/" alt="Web Analytics"></a>
        </div></noscript>
        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,300i,400,400i%7CMerriweather:300,300i,400,400i%7CRoboto+Slab:300,300i,400,400i">

        <link rel="stylesheet" href="/imandra-docs/static/style/style.min.9ef6027e.css" type="text/css">
        <link rel="stylesheet" href="/imandra-docs/static/nbextensions/nbimandra/styles.b466ce6f.css" type="text/css">
        <link rel="stylesheet" href="/imandra-docs/static/docs-styles.86fc0481.css" type="text/css">
        
        <link rel="stylesheet" href="/imandra-docs/static/jekyll-styles.8c9c0088.css" type="text/css">
        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="/imandra-docs/static/nbimandra-rjs-bundle.2469bcb7.js"></script>

        <style type="text/css">
         .highlight .hll { background-color: #ffffcc }
         .highlight  { background: #f8f8f8; }
         .highlight .c { color: #408080; font-style: italic } /* Comment */
         .highlight .err { border: 1px solid #FF0000 } /* Error */
         .highlight .k { color: #008000; font-weight: bold } /* Keyword */
         .highlight .o { color: #666666 } /* Operator */
         .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
         .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
         .highlight .cp { color: #BC7A00 } /* Comment.Preproc */
         .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
         .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
         .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
         .highlight .gd { color: #A00000 } /* Generic.Deleted */
         .highlight .ge { font-style: italic } /* Generic.Emph */
         .highlight .gr { color: #FF0000 } /* Generic.Error */
         .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
         .highlight .gi { color: #00A000 } /* Generic.Inserted */
         .highlight .go { color: #888888 } /* Generic.Output */
         .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
         .highlight .gs { font-weight: bold } /* Generic.Strong */
         .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
         .highlight .gt { color: #0044DD } /* Generic.Traceback */
         .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
         .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
         .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
         .highlight .kp { color: #008000 } /* Keyword.Pseudo */
         .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
         .highlight .kt { color: #B00040 } /* Keyword.Type */
         .highlight .m { color: #666666 } /* Literal.Number */
         .highlight .s { color: #BA2121 } /* Literal.String */
         .highlight .na { color: #7D9029 } /* Name.Attribute */
         .highlight .nb { color: #008000 } /* Name.Builtin */
         .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
         .highlight .no { color: #880000 } /* Name.Constant */
         .highlight .nd { color: #AA22FF } /* Name.Decorator */
         .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
         .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
         .highlight .nf { color: #0000FF } /* Name.Function */
         .highlight .nl { color: #A0A000 } /* Name.Label */
         .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
         .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
         .highlight .nv { color: #19177C } /* Name.Variable */
         .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
         .highlight .w { color: #bbbbbb } /* Text.Whitespace */
         .highlight .mb { color: #666666 } /* Literal.Number.Bin */
         .highlight .mf { color: #666666 } /* Literal.Number.Float */
         .highlight .mh { color: #666666 } /* Literal.Number.Hex */
         .highlight .mi { color: #666666 } /* Literal.Number.Integer */
         .highlight .mo { color: #666666 } /* Literal.Number.Oct */
         .highlight .sa { color: #BA2121 } /* Literal.String.Affix */
         .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
         .highlight .sc { color: #BA2121 } /* Literal.String.Char */
         .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
         .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
         .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
         .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
         .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
         .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
         .highlight .sx { color: #008000 } /* Literal.String.Other */
         .highlight .sr { color: #BB6688 } /* Literal.String.Regex */
         .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
         .highlight .ss { color: #19177C } /* Literal.String.Symbol */
         .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
         .highlight .fm { color: #0000FF } /* Name.Function.Magic */
         .highlight .vc { color: #19177C } /* Name.Variable.Class */
         .highlight .vg { color: #19177C } /* Name.Variable.Global */
         .highlight .vi { color: #19177C } /* Name.Variable.Instance */
         .highlight .vm { color: #19177C } /* Name.Variable.Magic */
         .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
        </style>

        <!-- Loading mathjax macro -->
        <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --><script>
  function handleCopyClick() {
      var el = this;
      var terminal = el.closest('.terminal');
      var highlight = terminal.getElementsByClassName('highlight')[0];
      copyToClipboardMsg(highlight);

      terminal.classList.add('terminal--hide');
      setTimeout(function () {
          terminal.classList.remove('terminal--hide');
      }, 2000);


      function copyToClipboardMsg(elem) {
          var succeed = copyToClipboard(elem);
          var msg;
          if (!succeed) {
              msg = 'Error!';
          } else {
              msg = 'Copied!';
          }

          var msgElem = terminal.querySelector('.terminal__copy-msg');
          msgElem.innerHTML = msg;
          setTimeout(function () {
              msgElem.innerHTML = 'You rock!';
          }, 1000);
      }

      function copyToClipboard(elem) {
          // create hidden text element, if it doesn't already exist
          var targetId = '_hiddenCopyText_';
          var isInput = elem.tagName === 'INPUT' || elem.tagName === 'TEXTAREA';
          var origSelectionStart, origSelectionEnd;
          if (isInput) {
              // can just use the original source element for the selection and copy
              target = elem;
              origSelectionStart = elem.selectionStart;
              origSelectionEnd = elem.selectionEnd;
          } else {
              // must use a temporary form element for the selection and copy
              target = terminal.querySelector('#' + targetId);
              if (!target) {
                  var target = document.createElement('textarea');
                  // target.style.display = 'flex';
                  // target.style.position = 'absolute';
                  // target.style.left = '-1000%';
                  target.id = targetId;
                 elem.appendChild(target);
              }
              target.textContent = elem.textContent.trim();
          }

          // select the content
          var currentFocus = document.activeElement;
          target.focus();
          target.setSelectionRange(0, target.value.length);

          // copy the selection
          var succeed;
          try {
              succeed = document.execCommand('copy');
          } catch (e) {
              succeed = false;
          }
          // restore original focus
          if (currentFocus && typeof currentFocus.focus === 'function') {
              currentFocus.focus();
          }

          if (isInput) {
              // restore prior selection
              elem.setSelectionRange(origSelectionStart, origSelectionEnd);
          } else {
              // clear temporary content
              elem.removeChild(target);
          }
          return succeed;
      }
  }
</script>
    </head>
    <body>
        <div class="background">
        </div>
        <div class="page-container">
            <main class="main-content-column">
                <!-- Jupyter (Imandra core docs) version -->
<header class="header">
    <div class="top-row-container">
        <div class="top-row">

            <div id="toggler--left" class="side__left-menu-toggler">
                <div class="side__toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p class="side__toggle-text">Docs</p>
            </div>

            <div class="side__logo-container">
                <a class="side__logo-link" href="/">
                    <img class="side__logo " src = "/imandra-docs/jekyll-resources/assets/img/imandra-gradient-logo-docs.svg">
                </a>
            </div>

            <div id="toggler--right" class="side__right-menu-toggler">
                <p class="side__toggle-text">Pages</p>
                <div class="side__toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <nav class="side__nav-container side__nav-container--hidden">

                <ul class="side__nav-list">
                    
                    <li class="side__nav-list-item TopNavListItem">
                        <a class="side__nav-link" href="/">Documentation Home</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item TopNavListItem">
                        <a class="side__nav-link side__nav-link--active" href="/imandra-docs">Imandra</a>
                        
                        <ul class="side__nav-list--sub-level-1">
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/welcome">A Quick Tour</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/installation">Installation</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-simple">Installer</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-docker">Docker Image</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-vscode">VSCode</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-jupyter">Jupyter</a>
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/logic-and-program-modes">Logic and Program Modes</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/verification-commands">Verification</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-commands">Commands</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes">Attributes</a>
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes/#Verification-Hints">Verification Hints</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes/#Rule-Classes">Rule Classes</a>
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-unrolling">Unrolling</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification">Simplification</a>
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification/#Rewrite-Rules">Rewrite Rules</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification/#Forward-chaining-Rules">Forward-chaining Rules</a>
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-blast">Blast</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction">Induction</a>
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction/#Functional-Induction">Functional Induction</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction/#Structural-Induction">Structural Induction</a>
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall">Waterfall</a>
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Simplification">Simplification</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Unrolling-check">Unrolling check</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Destructor-Elimination">Destructor Elimination</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Fertilization">Fertilization</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Generalization">Generalization</a>
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Induction">Induction</a>
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/extracting-ocaml-modules-with-imandra-extract">Extracting OCaml modules with imandra-extract</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/proving-program-termination">Proving Program Termination</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                Region Decomposition
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/decomposition-flags">Decomposition Flags</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/imandra-tools-intro">Imandra Tools Introduction</a>
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/examples">Examples</a>
                                
                                <ul class="side__nav-list--sub-level-2">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/recursion-induction-and-rewriting">Recursion, Induction and Rewriting</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verifying-merge-sort">Verifying Merge Sort in Imandra</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/ubs-case-study">Analysing the UBS ATS Dark Pool</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/webservice-auth-logic">Analysing Web-app Authentication Logic</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/simple-vehicle-controller">Simple Vehicle Controller</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/ripple-carry-adder">Verifying a Ripple Carry Adder</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verifying-an-ros-node">Creating and Verifying a ROS Node</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/reasonml-tic-tac-toe">Tic Tac Toe with ReasonML</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/probabilistic-reasoning-in-reasonml">Probabilistic Reasoning in ReasonML</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/sudoku">Solving Sudoku with Imandra</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/crossing-river-safely">Crossing the River Safely</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/reasonml-facetime-state-machines">Exploring The Apple FaceTime Bug with ReasonML State Machines</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link side__nav-link--active" href="/imandra-docs/notebooks/key-pair-security">Key Pair Security in Imandra</a>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/a-comparison-with-tla-plus">A comparison with TLA+</a>
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                        </ul>
                        
                    </li>
                    
                    <li class="side__nav-list-item TopNavListItem">
                        <a class="side__nav-link" href="/ipl">Imandra Protocol Language</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item TopNavListItem">
                        <a class="side__nav-link" href="/fix-engine">FIX Engine</a>
                        
                    </li>
                    
                </ul>
            </nav>
        </div>
    </div>

    <div class="background">
    </div>

    <div class="template-header">
        <div class="top-bar">
            <nav class="top-bar__nav-container">
                <a href="#" class="top-bar__toggle">≡</a>
                <ul class="top-bar__nav-list top-bar__nav-list--hidden">
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://www.imandra.ai/">Home</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://try.imandra.ai/">Try</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://medium.com/imandra">Blog</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://www.imandra.ai/research">Research</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://docs.imandra.ai/">Docs</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://www.imandra.ai/media">Media</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://www.imandra.ai/about">About AI</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://www.imandra.ai/careers">CAREERS</a></li>
                    <li class="top-bar__nav-list-item"><a class="top-bar__nav-link" href="https://www.imandra.ai/contact">CONTACT</a></li>
                </ul>
            </nav>
        </div>

        <div class="template-header__image-container template-header__image-container--jupyter">
            <div class="template-header__image" href ="/imandra-docs">
                <img class="site-specific-image" src="/imandra-docs/static/img/site_specific_image_v_2.svg">
            </div>
        </div>
        
    </div>

    <script>
        document.getElementById('toggler--left').addEventListener('click', function () {
            document.querySelector('.side__right-menu-toggler .side__toggle').classList.remove('side__toggle--active');
            document.querySelector('.side__left-menu-toggler .side__toggle').classList.toggle('side__toggle--active');
            document.getElementsByClassName('side__nav-container')[0].classList.toggle('side__nav-container--hidden');
            document.getElementsByClassName('top-bar__nav-list')[0].classList.add('top-bar__nav-list--hidden');
        });

        document.getElementById('toggler--right').addEventListener('click', function () {
            document.querySelector('.side__left-menu-toggler .side__toggle').classList.remove('side__toggle--active');
            document.querySelector('.side__right-menu-toggler .side__toggle').classList.toggle('side__toggle--active');
            document.getElementsByClassName('side__nav-container')[0].classList.add('side__nav-container--hidden');
            document.getElementsByClassName('top-bar__nav-list')[0].classList.toggle('top-bar__nav-list--hidden');
        });

    </script>
</header>
                <article class="article__container article__container--notebooks">
                    <div class="main-content main-content--jupyter">
                        
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In this notebook we introduce a simple implementation of a key pair exchange protocol in ReasonML. Messages can either be key requests, unencrypted responses to key requests with a public key or encrypted messages with a private key. In addition to this we introduce the concept of a "listener" - an agent who can intercept other messagers.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-2" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="k">type</span> <span class="nc">person</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Mallory</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Bob</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Alice</span><span class="p">;</span><span class="w"></span>

<span class="k">type</span> <span class="nc">public_key</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Public</span><span class="p">(</span><span class="n">person</span><span class="p">);</span><span class="w"></span>
<span class="k">type</span> <span class="nc">private_key</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Private</span><span class="p">(</span><span class="n">person</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* identifier person (purporting from) + payload */</span><span class="w"></span>
<span class="k">type</span> <span class="nc">full_unencrypted_payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">public_key</span><span class="p">);</span><span class="w"></span>
<span class="k">type</span> <span class="nc">full_encrypted_payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="p">);</span><span class="w"></span>

<span class="k">type</span> <span class="nc">data</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">UnEncrypted</span><span class="p">(</span><span class="n">full_unencrypted_payload</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* where it&#39;s believed to be being sent and the actual public key used */</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Encrypted</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">public_key</span><span class="p">),</span><span class="w"> </span><span class="n">full_encrypted_payload</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* actual people */</span><span class="w"></span>
<span class="k">type</span> <span class="nc">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">from</span>: <span class="nc">person</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">to_</span>: <span class="nc">person</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">swap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">c</span>: <span class="nc">channel</span><span class="p">)</span>: <span class="nc">channel</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">from</span>: <span class="nc">c</span><span class="p">.</span><span class="n">to_</span><span class="p">,</span><span class="w"> </span><span class="n">to_</span>: <span class="nc">c</span><span class="p">.</span><span class="n">from</span><span class="p">};</span><span class="w"></span>

<span class="k">type</span> <span class="nc">known</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">asker</span>: <span class="nc">person</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">ident</span>: <span class="nc">person</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">actual</span>: <span class="nc">person</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">type</span> <span class="nc">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">channel</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">data</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">type</span> <span class="nc">action</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Listen</span><span class="p">(</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">KeyRequest</span><span class="p">(</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nb">Send</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w"></span>

<span class="k">type</span> <span class="nc">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* fst arg believes 2nd arg to be that person */</span><span class="w"></span>
<span class="w">  </span><span class="n">believed_identities</span>: <span class="nc">list</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">)),</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* can learn a key */</span><span class="w"></span>
<span class="w">  </span><span class="n">can_learn_keys</span>: <span class="nc">list</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">)),</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* person knows a given key */</span><span class="w"></span>
<span class="w">  </span><span class="n">known_keys</span>: <span class="nc">list</span><span class="p">(</span><span class="n">known</span><span class="p">),</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* a &#39;listener&#39; / spy on a channel */</span><span class="w"></span>
<span class="w">  </span><span class="n">listeners</span>: <span class="nc">list</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">)),</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* msg was decrypted and read by person */</span><span class="w"></span>
<span class="w">  </span><span class="n">decrypted</span>: <span class="nc">list</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">full_encrypted_payload</span><span class="p">)),</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* actual encrypted channel messages sent */</span><span class="w"></span>
<span class="w">  </span><span class="n">msgs</span>: <span class="nc">list</span><span class="p">((</span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="n">full_encrypted_payload</span><span class="p">)),</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">believed_identity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span>: <span class="nc">state</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">person</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">believed_identities</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Has person A requested person B&#39;s key? */</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">can_learn_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span>: <span class="nc">state</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">person</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">can_learn_keys</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Does person A know person B&#39;s key? */</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">knows_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span>: <span class="nc">state</span><span class="p">,</span><span class="w"> </span><span class="n">asker</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">ident</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">actual</span>: <span class="nc">person</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">asker</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">({</span><span class="n">asker</span><span class="p">,</span><span class="w"> </span><span class="n">ident</span><span class="p">,</span><span class="w"> </span><span class="n">actual</span><span class="p">},</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">known_keys</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Is person A listening to channel C? Partially reflexive and symmetric! */</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span>: <span class="nc">state</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">c</span>: <span class="nc">channel</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">c</span><span class="p">.</span><span class="n">to_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">  </span><span class="o">||</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="w"></span>
<span class="w">       </span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">swap</span><span class="p">(</span><span class="n">c2</span><span class="p">)),</span><span class="w"></span>
<span class="w">       </span><span class="n">s</span><span class="p">.</span><span class="n">listeners</span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="p">);</span><span class="w"></span>

<span class="cm">/* For all appropriate listeners on a given channel, do something */</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">map_listeners</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">s</span>: <span class="nc">state</span><span class="p">,</span><span class="w"> </span><span class="n">c</span>: <span class="nc">channel</span><span class="p">,</span><span class="w"> </span><span class="n">guard</span>: <span class="nc">person</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">person</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="na">&#39;b</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="n">doit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">l_p</span><span class="p">,</span><span class="w"> </span><span class="n">l_c</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">listening</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">l_p</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">guard</span><span class="p">(</span><span class="n">l_p</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">Some</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">l_p</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">None</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="n">List</span><span class="p">.</span><span class="n">filter_map</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">doit</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">listeners</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span>: <span class="nc">state</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>: <span class="nc">action</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* We can only listen in on messages between distinct people */</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Listen</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">from</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">to_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">from</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">to_</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="p">...</span><span class="n">s</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">listeners</span>: <span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">),</span><span class="w"> </span><span class="p">...</span><span class="n">s</span><span class="p">.</span><span class="n">listeners</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">KeyRequest</span><span class="p">(</span><span class="n">asker</span><span class="p">,</span><span class="w"> </span><span class="n">key_owner</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* filter out self requests */</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">asker</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key_owner</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">ks</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">map_listeners</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">s</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="p">{</span><span class="n">from</span>: <span class="nc">asker</span><span class="p">,</span><span class="w"> </span><span class="n">to_</span>: <span class="nc">key_owner</span><span class="p">},</span><span class="w"></span>
<span class="w">          </span><span class="n">l</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">l</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">key_owner</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* once asker asks key_owner for his key, he believes this person&#39;s identity */</span><span class="w"></span>
<span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="n">s</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">can_learn_keys</span>: <span class="p">[(</span><span class="n">asker</span><span class="p">,</span><span class="w"> </span><span class="n">key_owner</span><span class="p">),</span><span class="w"> </span><span class="p">...</span><span class="n">ks</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">can_learn_keys</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">believed_identities</span>: <span class="p">[(</span><span class="n">key_owner</span><span class="p">,</span><span class="w"> </span><span class="n">asker</span><span class="p">),</span><span class="w"> </span><span class="p">...</span><span class="n">s</span><span class="p">.</span><span class="n">believed_identities</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nb">Send</span><span class="p">({</span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="n">data</span>: <span class="nc">UnEncrypted</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">Public</span><span class="p">(</span><span class="n">key_owner</span><span class="p">)))})</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* filter out self sends */</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* if the asker already believes he knows a key belonging to person then don&#39;t accept the key */</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="w"></span>
<span class="w">         </span><span class="p">({</span><span class="n">asker</span><span class="p">,</span><span class="w"> </span><span class="n">ident</span><span class="p">,</span><span class="w"> </span><span class="n">actual</span><span class="p">})</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">asker</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ident</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">person</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="n">s</span><span class="p">.</span><span class="n">known_keys</span><span class="p">,</span><span class="w"></span>
<span class="w">       </span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* the recipent must be able to learn the key and the sender must know the key of key_owner believing it to be of person */</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">can_learn_key</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">)</span><span class="w"></span>
<span class="w">       </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">knows_key</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">key_owner</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* The sink of the channel now knows the sent key */</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">asker</span>: <span class="nc">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">,</span><span class="w"> </span><span class="n">ident</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">actual</span>: <span class="nc">key_owner</span><span class="p">};</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* All listeners on the channel now know p&#39;s key */</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">ks</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">map_listeners</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">s</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">channel</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">l</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">can_learn_key</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">),</span><span class="w"></span>
<span class="w">          </span><span class="n">l</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">asker</span>: <span class="nc">l</span><span class="p">,</span><span class="w"> </span><span class="n">ident</span>: <span class="nc">person</span><span class="p">,</span><span class="w"> </span><span class="n">actual</span>: <span class="nc">key_owner</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="p">{...</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">known_keys</span>: <span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">ks</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">known_keys</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nb">Send</span><span class="p">({</span><span class="w"></span>
<span class="w">      </span><span class="n">channel</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">data</span>: <span class="nc">Encrypted</span><span class="p">((</span><span class="n">recipient_ident</span><span class="p">,</span><span class="w"> </span><span class="n">Public</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">)),</span><span class="w"></span>
<span class="w">    </span><span class="p">})</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* filter out self sends */</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="w"></span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">recipient_ident</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="w"></span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="w"></span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">recipient_ident</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* if channel.from asked for the key and the identity is different don&#39;t accept the message */</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">believed_identity</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"></span>
<span class="w">      </span><span class="cm">/* if public key is known by sender and the key matches the channel.to_ */</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">knows_key</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">recipient_ident</span><span class="p">,</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">)</span><span class="w"></span>
<span class="w">       </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="n">s</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">decrypted</span>: <span class="p">[(</span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">)),</span><span class="w"> </span><span class="p">...</span><span class="n">s</span><span class="p">.</span><span class="n">decrypted</span><span class="p">],</span><span class="w"></span>
<span class="w">        </span><span class="n">msgs</span>: <span class="p">[(</span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">)),</span><span class="w"> </span><span class="p">...</span><span class="n">s</span><span class="p">.</span><span class="n">msgs</span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">init</span>: <span class="nc">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">believed_identities</span>: <span class="p">[],</span><span class="w"></span>
<span class="w">  </span><span class="n">can_learn_keys</span>: <span class="p">[],</span><span class="w"></span>
<span class="w">  </span><span class="n">known_keys</span>: <span class="p">[],</span><span class="w"></span>
<span class="w">  </span><span class="n">listeners</span>: <span class="p">[],</span><span class="w"></span>
<span class="w">  </span><span class="n">decrypted</span>: <span class="p">[],</span><span class="w"></span>
<span class="w">  </span><span class="n">msgs</span>: <span class="p">[],</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type person = Mallory | Bob | Alice
type public_key = Public of person
type private_key = Private of person
type full_unencrypted_payload = person * public_key
type full_encrypted_payload = person * int
type data =
    UnEncrypted of full_unencrypted_payload
  | Encrypted of (person * public_key) * full_encrypted_payload
type channel = { from : person; to_ : person; }
val swap : channel -&gt; channel = &lt;fun&gt;
type known = { asker : person; ident : person; actual : person; }
type msg = { channel : channel; data : data; }
type action =
    Listen of person * channel
  | KeyRequest of person * person
  | Send of msg
type state = {
  believed_identities : (person * person) list;
  can_learn_keys : (person * person) list;
  known_keys : known list;
  listeners : (person * channel) list;
  decrypted : (person * full_encrypted_payload) list;
  msgs : (channel * full_encrypted_payload) list;
}
val believed_identity : state -&gt; person -&gt; person -&gt; bool = &lt;fun&gt;
val can_learn_key : state -&gt; person -&gt; person -&gt; bool = &lt;fun&gt;
val knows_key : state -&gt; person -&gt; person -&gt; person -&gt; bool = &lt;fun&gt;
val listening : state -&gt; person -&gt; channel -&gt; bool = &lt;fun&gt;
val map_listeners :
  state -&gt; channel -&gt; (person -&gt; bool) -&gt; (person -&gt; &#39;b) -&gt; &#39;b list = &lt;fun&gt;
val step : state -&gt; action -&gt; state = &lt;fun&gt;
val init : state =
  {believed_identities = []; can_learn_keys = []; known_keys = [];
   listeners = []; decrypted = []; msgs = []}
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can introduce some printing functions so that any traces produced can be visually interpreted.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-4" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">person_to_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Alice</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Mallory</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;Mallory&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Bob</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val person_to_string : person -&gt; string = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This step allows us to depict message transitions between agents.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-6" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">graph_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span>: <span class="nc">action</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Listen</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&gt;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">from</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;[style=dotted];</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&gt;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">to_</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;[style=dotted];</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">KeyRequest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;edge [color=yellow];</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&gt;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nb">Send</span><span class="p">({</span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="n">data</span>: <span class="nc">UnEncrypted</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">Public</span><span class="p">(</span><span class="n">key_owner</span><span class="p">)))})</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&gt;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;[label=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">key_owner</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">,color=blue];</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nb">Send</span><span class="p">({</span><span class="w"></span>
<span class="w">      </span><span class="n">channel</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">data</span>: <span class="nc">Encrypted</span><span class="p">((</span><span class="n">recipient_ident</span><span class="p">,</span><span class="w"> </span><span class="n">Public</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">)),</span><span class="w"></span>
<span class="w">    </span><span class="p">})</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">channel</span><span class="p">.</span><span class="n">from</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&gt;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">channel</span><span class="p">.</span><span class="n">to_</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;[label=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="n">person_to_string</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">,color=black];</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val graph_step : action -&gt; String.t = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-7" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">rec</span><span class="w"> </span><span class="n">graph_inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xs</span>:<span class="nc">list</span><span class="p">(</span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="w">      </span><span class="n">graph_step</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">++</span><span class="n">graph_inner</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val graph_inner : action list -&gt; String.t = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-7f11bbf5-3923-4008-bafc-3949dd2ed38f"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-c87d7fde-8ffc-465a-9922-0e0fd5a67701"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `graph_inner (List.tl xs)` from `graph_inner xs`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-b5e1712e-409d-4cec-894c-efb22b96c50d"><table><tr><td><b>original</b></td><td>graph_inner xs</td></tr><tr><td><b>sub</b></td><td>graph_inner (List.tl xs)</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count xs)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (List.tl xs))</td></tr><tr><td><b>path</b></td><td>[not (xs = [])]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-06d6781e-a4da-4980-9db0-da109d19d746"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-b2d680a8-b37b-494a-bf0a-59d857ece0e0"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-d3237ff4-e74a-46c1-8b82-4567df30a60b"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.029s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-29ec3d8f-3d68-4170-a884-b863f2b01107"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-356e0705-a36d-45c4-8dde-61446e7edf58"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-a2df7ca1-e70c-4db6-a9c1-27d4acd3c4c8"><table><tr><td><b>num checks</b></td><td>8</td></tr><tr><td><b>arith assert lower</b></td><td>12</td></tr><tr><td><b>arith pivots</b></td><td>10</td></tr><tr><td><b>rlimit count</b></td><td>7505</td></tr><tr><td><b>mk clause</b></td><td>43</td></tr><tr><td><b>datatype occurs check</b></td><td>38</td></tr><tr><td><b>mk bool var</b></td><td>666</td></tr><tr><td><b>arith assert upper</b></td><td>9</td></tr><tr><td><b>datatype splits</b></td><td>182</td></tr><tr><td><b>decisions</b></td><td>66</td></tr><tr><td><b>arith add rows</b></td><td>18</td></tr><tr><td><b>propagations</b></td><td>23</td></tr><tr><td><b>conflicts</b></td><td>9</td></tr><tr><td><b>arith fixed eqs</b></td><td>5</td></tr><tr><td><b>datatype accessor ax</b></td><td>95</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>datatype constructor ax</b></td><td>240</td></tr><tr><td><b>num allocs</b></td><td>1455336245</td></tr><tr><td><b>final checks</b></td><td>10</td></tr><tr><td><b>added eqs</b></td><td>871</td></tr><tr><td><b>del clause</b></td><td>4</td></tr><tr><td><b>arith eq adapter</b></td><td>7</td></tr><tr><td><b>memory</b></td><td>18.880000</td></tr><tr><td><b>max memory</b></td><td>26.910000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-29ec3d8f-3d68-4170-a884-b863f2b01107';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-249cc25e-9c14-4c93-908e-7ceac67ab75a"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.029s]
  not (xs = []) &amp;&amp; Ordinal.count xs &gt;= 0 &amp;&amp; Ordinal.count (List.tl xs) &gt;= 0
  ==&gt; List.tl xs = []
      || Ordinal.&lt;&lt; (Ordinal.Int (Ordinal.count (List.tl xs)))
         (Ordinal.Int (Ordinal.count xs))</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-26e840c7-fea1-4db5-bbc3-ceff82a82722"><table><tr><td><b>into</b></td><td><pre>(not
 ((not (xs = []) &amp;&amp; Ordinal.count xs &gt;= 0) &amp;&amp; Ordinal.count (List.tl xs) &gt;= 0)
 || List.tl xs = [])
|| Ordinal.&lt;&lt; (Ordinal.Int (Ordinal.count (List.tl xs)))
   (Ordinal.Int (Ordinal.count xs))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-1cec2f3a-d5ee-4443-8fec-b8b0cdefa39f"><table><tr><td><b>expr</b></td><td><pre>(|Ordinal.&lt;&lt;_115| (|Ordinal.Int_106|
                    (|count_`action list`_2113| (|get.::.1_2103…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-cc2ee9e9-76f3-4bc5-bd75-882d78bf0a35"><table><tr><td><b>expr</b></td><td><pre>(|count_`action list`_2113| (|get.::.1_2103| xs_2104))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-40da7c1a-a82a-471a-af9f-a723bc900afe"><table><tr><td><b>expr</b></td><td><pre>(|count_`action list`_2113| xs_2104)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 ((_ is (UnEncrypted_994 (|`(person * public_key)`_2089|) data_993))
             (data_10…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-249cc25e-9c14-4c93-908e-7ceac67ab75a';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-b2d680a8-b37b-494a-bf0a-59d857ece0e0';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-06d6781e-a4da-4980-9db0-da109d19d746';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-c87d7fde-8ffc-465a-9922-0e0fd5a67701';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-7f11bbf5-3923-4008-bafc-3949dd2ed38f';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In the final printer function, we depict encrypted messages with black transition lines, key requests with yellow lines, and unencrypted messages with blue transition lines. Listeners to other parties are depicted with dashed lines.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-9" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="p">[</span><span class="o">@</span><span class="n">program</span><span class="p">]</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xs</span>:<span class="nc">list</span><span class="p">(</span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">Document</span><span class="p">.</span><span class="n">graphviz</span><span class="p">(</span><span class="s">&quot;digraph G {</span><span class="se">\n</span><span class="s">Alice [color=blue];</span><span class="se">\n</span><span class="s">Mallory [color=red];</span><span class="se">\n</span><span class="s">Bob [color=green];</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">++</span><span class="n">graph_inner</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">++</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">[</span><span class="o">@</span><span class="n">install_doc</span><span class="w"> </span><span class="n">graph</span><span class="p">];</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val graph : action list -&gt; Imandra_surface.Document.t = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now ask imandra to prove correctness properties about the protocol. For example, is it possible for a message to be decrypted by someone who is not the intended recipient. Click on the <code>Load graph</code> button to visually interpret the counterexample found by imandra.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-11" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="cm">/* Can xq decrypt a message saying it&#39;s from xw, but actually it&#39;s been sent by another party? */</span><span class="w"></span>
<span class="p">[</span><span class="o">@</span><span class="n">blast</span><span class="p">]</span><span class="w"></span>
<span class="n">verify</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">fold_left</span><span class="p">(</span><span class="n">step</span><span class="p">,</span><span class="w"> </span><span class="n">init</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">decrypted</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">==&gt;</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">(({</span><span class="n">from</span>: <span class="nc">x2</span><span class="p">,</span><span class="w"> </span><span class="n">to_</span>: <span class="nc">x1</span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">msgs</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="n">CX</span><span class="p">.</span><span class="n">xs</span><span class="p">;</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : person -&gt; person -&gt; int -&gt; action list -&gt; bool = &lt;fun&gt;
module CX :
  sig val x1 : person val x2 : person val m : Z.t val xs : action list end
- : action list = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Counterexample (after 66 steps, 0.134s):
  let x1 = Mallory
  let x2 = Alice
  let m = 0
  let xs =
    [Listen (Bob, {from = Mallory; to_ = Alice});
     KeyRequest (Alice, Mallory);
     Send
     {channel = {from = Mallory; to_ = Bob};
      data = UnEncrypted (Mallory, Public Mallory)};
     Send
     {channel = {from = Bob; to_ = Mallory};
      data = Encrypted ((Mallory, Public Mallory), (Alice, 0))}]
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px dashed #D84315; border-bottom: 1px dashed #D84315"><i class="fa fa-times-circle-o" style="margin-right: 0.5em; color: #D84315"></i><span>Refuted</span></div><div><div></div></div></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-graphviz" id="graphviz-60f988a3-ee54-41a6-b763-6eeab9ebe359"><textarea style="display: none">digraph G {
Alice [color=blue];
Mallory [color=red];
Bob [color=green];
Bob-&gt;Mallory[style=dotted];
Bob-&gt;Alice[style=dotted];
edge [color=yellow];
Alice-&gt;Mallory;
Mallory-&gt;Bob[label=&quot;Mallory&quot;,color=blue];
Bob-&gt;Mallory[label=&quot;Mallory&quot;,color=black];

}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-60f988a3-ee54-41a6-b763-6eeab9ebe359';
  graphviz.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that imandra, and in particular the <code>[@blast]</code> capability finds a counterexample very quickly. We can further ask whether if a particpant decodes a message then it must have been sent by the original sender of the message.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/KeyPairSecurity.ipynb%23try-cell-13" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-rust"><pre><span></span><span class="cm">/* if a message has been sent by x2 and x1 decodes that message then they must be the same message */</span><span class="w"></span>
<span class="p">[</span><span class="o">@</span><span class="n">blast</span><span class="p">]</span><span class="w"></span>
<span class="n">verify</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x3</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">fold_left</span><span class="p">(</span><span class="n">step</span><span class="p">,</span><span class="w"> </span><span class="n">init</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">(({</span><span class="n">from</span>: <span class="nc">x2</span><span class="p">,</span><span class="w"> </span><span class="n">to_</span>: <span class="nc">x3</span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">msgs</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">mem</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)),</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">decrypted</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">==&gt;</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x3</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="n">CX</span><span class="p">.</span><span class="n">xs</span><span class="p">;</span><span class="w"></span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : person -&gt; person -&gt; person -&gt; int -&gt; action list -&gt; bool = &lt;fun&gt;
module CX :
  sig
    val x1 : person
    val x2 : person
    val x3 : person
    val m : Z.t
    val xs : action list
  end
- : action list = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Counterexample (after 93 steps, 0.434s):
  let x1 = Alice
  let x2 = Bob
  let x3 = Mallory
  let m = 0
  let xs =
    [Listen (Mallory, {from = Bob; to_ = Alice}); KeyRequest (Bob, Alice);
     Send
     {channel = {from = Mallory; to_ = Bob};
      data = UnEncrypted (Alice, Public Mallory)};
     Send
     {channel = {from = Alice; to_ = Mallory};
      data = UnEncrypted (Alice, Public Alice)};
     Send
     {channel = {from = Mallory; to_ = Alice};
      data = Encrypted ((Alice, Public Alice), (Bob, 0))};
     Send
     {channel = {from = Bob; to_ = Mallory};
      data = Encrypted ((Alice, Public Mallory), (Bob, 0))}]
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px dashed #D84315; border-bottom: 1px dashed #D84315"><i class="fa fa-times-circle-o" style="margin-right: 0.5em; color: #D84315"></i><span>Refuted</span></div><div><div></div></div></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-graphviz" id="graphviz-ae87d8a2-33d3-4e65-88ff-165c6311df4e"><textarea style="display: none">digraph G {
Alice [color=blue];
Mallory [color=red];
Bob [color=green];
Mallory-&gt;Bob[style=dotted];
Mallory-&gt;Alice[style=dotted];
edge [color=yellow];
Bob-&gt;Alice;
Mallory-&gt;Bob[label=&quot;Mallory&quot;,color=blue];
Alice-&gt;Mallory[label=&quot;Alice&quot;,color=blue];
Mallory-&gt;Alice[label=&quot;Alice&quot;,color=black];
Bob-&gt;Mallory[label=&quot;Mallory&quot;,color=black];

}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-ae87d8a2-33d3-4e65-88ff-165c6311df4e';
  graphviz.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here imandra very quickly finds a counter-example which corresponds to the well-known "man in the middle attack" - where Mallory listens to the conversation between Alice and Bob and can intercept and forward messages, potentially tampering with the content. Again - click on the <code>Load graph</code> button to visually interpret the counterexample found by imandra.</p>
</div>
</div>
</div>
                    </div>

                    </article>
            </main>
            <footer class="footer">
                <a class="copyrights"href="http://imandra.ai">&#9400; 2018 - 2019 Imandra Inc. All rights reserved.</a>
            </footer>
        </div>
    
 


    </body>
</html>
