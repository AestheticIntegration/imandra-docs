<!DOCTYPE html>
<html>
    <head><meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Imandra Documentation - Region Decomposition - Exchange Pricing</title>
        <meta property="og:url" content="https://docs.imandra.ai/imandra-docs/notebooks/six-swiss-exchange-pricing/">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Imandra Documentation - Region Decomposition - Exchange Pricing">
        <meta property="og:description" content="In this notebook we'll use imandra to model a fragment of the SIX Swiss trading logic and decompose its state space using region decomposition">
        <meta property="og:image" content="https://storage.googleapis.com/imandra-assets/images/og_image_default_i78.jpg">


        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116937440-6"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());

         gtag('config', 'UA-116937440-1');
        </script>
        <script type="text/javascript"> var sc_project=11767520; var sc_invisible=1; var sc_security="fa7e88d1"; </script>
        <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
        <noscript><div class="statcounter">
            <a title="Web Analytics" href="http://statcounter.com/" target="_blank">
                <img class="statcounter" src="//c.statcounter.com/11767520/0/fa7e88d1/1/" alt="Web Analytics"></a>
        </div></noscript>
        

        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,300i,400,400i%7CMerriweather:300,300i,400,400i%7CRoboto+Slab:300,300i,400,400i">

        <link rel="stylesheet" href="/imandra-docs/static/style/style.min.c7df16ea.css" type="text/css">
        <link rel="stylesheet" href="/imandra-docs/static/nbextensions/nbimandra/styles.b466ce6f.css" type="text/css">
        <link rel="stylesheet" href="/imandra-docs/static/docs-styles.b9de737f.css" type="text/css">
        
        <link rel="stylesheet" href="/imandra-docs/static/jekyll-styles.f5a34715.css" type="text/css">
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="/imandra-docs/static/nbimandra-rjs-bundle.b85e58fd.js"></script>

        <style type="text/css">
         .highlight .hll { background-color: #ffffcc }
         .highlight  { background: #f8f8f8; }
         .highlight .c { color: #408080; font-style: italic } /* Comment */
         .highlight .err { border: 1px solid #FF0000 } /* Error */
         .highlight .k { color: #008000; font-weight: bold } /* Keyword */
         .highlight .o { color: #666666 } /* Operator */
         .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
         .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
         .highlight .cp { color: #BC7A00 } /* Comment.Preproc */
         .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
         .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
         .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
         .highlight .gd { color: #A00000 } /* Generic.Deleted */
         .highlight .ge { font-style: italic } /* Generic.Emph */
         .highlight .gr { color: #FF0000 } /* Generic.Error */
         .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
         .highlight .gi { color: #00A000 } /* Generic.Inserted */
         .highlight .go { color: #888888 } /* Generic.Output */
         .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
         .highlight .gs { font-weight: bold } /* Generic.Strong */
         .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
         .highlight .gt { color: #0044DD } /* Generic.Traceback */
         .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
         .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
         .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
         .highlight .kp { color: #008000 } /* Keyword.Pseudo */
         .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
         .highlight .kt { color: #B00040 } /* Keyword.Type */
         .highlight .m { color: #666666 } /* Literal.Number */
         .highlight .s { color: #BA2121 } /* Literal.String */
         .highlight .na { color: #7D9029 } /* Name.Attribute */
         .highlight .nb { color: #008000 } /* Name.Builtin */
         .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
         .highlight .no { color: #880000 } /* Name.Constant */
         .highlight .nd { color: #AA22FF } /* Name.Decorator */
         .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
         .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
         .highlight .nf { color: #0000FF } /* Name.Function */
         .highlight .nl { color: #A0A000 } /* Name.Label */
         .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
         .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
         .highlight .nv { color: #19177C } /* Name.Variable */
         .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
         .highlight .w { color: #bbbbbb } /* Text.Whitespace */
         .highlight .mb { color: #666666 } /* Literal.Number.Bin */
         .highlight .mf { color: #666666 } /* Literal.Number.Float */
         .highlight .mh { color: #666666 } /* Literal.Number.Hex */
         .highlight .mi { color: #666666 } /* Literal.Number.Integer */
         .highlight .mo { color: #666666 } /* Literal.Number.Oct */
         .highlight .sa { color: #BA2121 } /* Literal.String.Affix */
         .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
         .highlight .sc { color: #BA2121 } /* Literal.String.Char */
         .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
         .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
         .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
         .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
         .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
         .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
         .highlight .sx { color: #008000 } /* Literal.String.Other */
         .highlight .sr { color: #BB6688 } /* Literal.String.Regex */
         .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
         .highlight .ss { color: #19177C } /* Literal.String.Symbol */
         .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
         .highlight .fm { color: #0000FF } /* Name.Function.Magic */
         .highlight .vc { color: #19177C } /* Name.Variable.Class */
         .highlight .vg { color: #19177C } /* Name.Variable.Global */
         .highlight .vi { color: #19177C } /* Name.Variable.Instance */
         .highlight .vm { color: #19177C } /* Name.Variable.Magic */
         .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
        </style>

        <!-- Loading mathjax macro -->
        <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"> </script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                },
                "HTML-CSS": {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration --><script>
  function handleCopyClick() {
      var el = this;
      var terminal = el.closest('.terminal');
      var highlight = terminal.getElementsByClassName('highlight')[0];
      copyToClipboardMsg(highlight);

      terminal.classList.add('terminal--hide');
      setTimeout(function () {
          terminal.classList.remove('terminal--hide');
      }, 2000);


      function copyToClipboardMsg(elem) {
          var succeed = copyToClipboard(elem);
          var msg;
          if (!succeed) {
              msg = 'Error!';
          } else {
              msg = 'Copied!';
          }

          var msgElem = terminal.querySelector('.terminal__copy-msg');
          msgElem.innerHTML = msg;
          setTimeout(function () {
              msgElem.innerHTML = 'You rock!';
          }, 1000);
      }

      function copyToClipboard(elem) {
          // create hidden text element, if it doesn't already exist
          var targetId = '_hiddenCopyText_';
          var isInput = elem.tagName === 'INPUT' || elem.tagName === 'TEXTAREA';
          var origSelectionStart, origSelectionEnd;
          if (isInput) {
              // can just use the original source element for the selection and copy
              target = elem;
              origSelectionStart = elem.selectionStart;
              origSelectionEnd = elem.selectionEnd;
          } else {
              // must use a temporary form element for the selection and copy
              target = terminal.querySelector('#' + targetId);
              if (!target) {
                  var target = document.createElement('textarea');
                  // target.style.display = 'flex';
                  // target.style.position = 'absolute';
                  // target.style.left = '-1000%';
                  target.id = targetId;
                 elem.appendChild(target);
              }
              target.textContent = elem.textContent.trim();
          }

          // select the content
          var currentFocus = document.activeElement;
          target.focus();
          target.setSelectionRange(0, target.value.length);

          // copy the selection
          var succeed;
          try {
              succeed = document.execCommand('copy');
          } catch (e) {
              succeed = false;
          }
          // restore original focus
          if (currentFocus && typeof currentFocus.focus === 'function') {
              currentFocus.focus();
          }

          if (isInput) {
              // restore prior selection
              elem.setSelectionRange(origSelectionStart, origSelectionEnd);
          } else {
              // clear temporary content
              elem.removeChild(target);
          }
          return succeed;
      }
  }
</script>
    </head>
    <body>
        <div class="background">
        </div>
        <div class="page-container">
            <main class="main-content-column">
                <!-- Jupyter (Imandra core docs) version -->
<header class="header">
    <div class="top-row-container">
        <div class="top-row">

            <div id="toggler--left" class="side__left-menu-toggler">
                <div class="side__toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p class="side__toggle-text">Docs</p>
            </div>

            <div class="side__logo-container">
                <a class="side__logo-link" href="/">
                    <img class="side__logo " src = "/imandra-docs/jekyll-resources/assets/img/imandra-gradient-logo-docs.svg" alt="Imandra Logo" title="Imandra Logo">
                    <img class="side__logo--min " src="/imandra-docs/jekyll-resources/assets/img/imandra-gradient-logo-min.svg" alt="Imandra Logo" title="Imandra Logo">

                </a>
            </div>

            <div id="toggler--right" class="side__right-menu-toggler">
                <p class="side__toggle-text">Pages</p>
                <div class="side__toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <nav id="side-nav-menu" class="side__nav-container side__nav-container--hidden">
                <ul class="side__nav-list">
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/">Documentation Home</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link side__nav-link--active" href="/imandra-docs">Imandra Core</a>
                        
                        <ul class="side__nav-list--sub-level-1">
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/welcome">A quick tour</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 ">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/installation">Installation</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/installation-simple">Installer</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/installation-manual-opam">Manual (opam)</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/installation-docker">Docker Image</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/installation-jupyter">Jupyter Notebook</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/installation-vscode">VSCode</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/installation-server-image">Server Image</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/logic-and-program-modes">Logic and Program modes</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 ">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/verification">Verification</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-commands">Commands</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes">Attributes</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-unrolling">Unrolling</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification">Simplification</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-blast">Blast</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction">Induction</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall">Waterfall</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/proving-program-termination">Proving program termination</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 ">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/decomposition">Region Decomposition</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/imandra-tools-intro">Imandra tools introduction</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/idf">Iterative Decomposition Framework</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/region-probabilities">Region Probabilities</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/loading-files">Multifile development</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/extracting-ocaml-modules-with-imandra-extract">Extracting OCaml modules</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/plugins">Code generation and plugins</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 side__nav-list--sub-level-1--empty">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/reflection">Reflection of terms</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 ">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/examples">Examples</a>
                                
                                <ul class="side__nav-list--sub-level-2  side__nav-list--sub-level-2--active">
                                    
                                    
                                    
                                    
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                        <span class="side__nav-link side__nav-link--minisec">Beginner</span>
                                        </li>
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/webservice-auth-logic">Analysing Web-app authentication logic</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/simple-vehicle-controller">Simple vehicle controller</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/simple-stoplight-model">Simple car intersection model</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/reasonml-tic-tac-toe">Tic Tac Toe with ReasonML</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/reasonml-facetime-state-machines">Exploring The Apple FaceTime Bug with ReasonML State Machines</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/crossing-river-safely">Crossing the river safely</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                        <span class="side__nav-link side__nav-link--minisec">Intermediate</span>
                                        </li>
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/ubs-case-study">Analysing the UBS ATS Dark Pool</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link side__nav-link--active" href="/imandra-docs/notebooks/six-swiss-exchange-pricing">Region Decomposition - Exchange Pricing</a>
                                            
                                            
                                            
                                            <div class="side__within-page-nav--sub-level-2">
                                            
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Modelling-trading-venues">Modelling trading venues</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Order-type-definitions">Order type definitions</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Auxiliary-functions">Auxiliary functions</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Pricing-logic">Pricing logic</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Region-Decomposition-of-match_price">Region Decomposition of match_price</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Analysis-of-the-results">Analysis of the results</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Refinement-and-pretty-printing">Refinement and pretty-printing</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Adding-constraints-(side-conditions)">Adding constraints (side conditions)</a>
  
  
  
  <a class="side__nav-link--within-page side__nav-link--within-page--h2" href="#Generating-instances">Generating instances</a>
  
  
                                            </div>
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verifying-an-ros-node">Creating and Verifying a ROS Node</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/key-pair-security">Key Pair Security in Imandra</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/sudoku">Solving Sudoku with Imandra</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/solver-synthesis">Synthesising a game solver in Imandra</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/exchange-implied-trading">Exchange Implied Trading</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/school-scheduler">Solving school scheduling during COVID</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                        <span class="side__nav-link side__nav-link--minisec">Advanced</span>
                                        </li>
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/recursion-induction-and-rewriting">Recursion, Induction and Rewriting</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/verifying-merge-sort">Verifying merge sort in Imandra</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/ripple-carry-adder">Verifying a Ripple Carry Adder</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/region-probabilities-example">Calculating Region Probabilities</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/supervised-learning">Analysing Machine Learning Models</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/probabilistic-reasoning-in-reasonml">Probabilistic Reasoning in ReasonML</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/notebooks/a-comparison-with-tla-plus">A comparison with TLA+</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                </ul>
                                
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1 ">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/reference">Reference</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    
                                    
                                    
                                        
                                        
                                        
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/odoc/imandra-base/Imandra_prelude/">Standard Library</a>
                                            
                                            
                                            
                                        </li>
                                        
                                        <li class="side__nav-list-item--sub-level-2 side__nav-list--sub-level-2--empty">
                                            
                                            <a class="side__nav-link" href="/imandra-docs/odoc/">API Docs</a>
                                            
                                            
                                            
                                        </li>
                                        
                                    
                                </ul>
                                
                            </li>
                            
                        </ul>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/idf-py">Py IDF</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/ipl">Imandra Protocol Language</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/imandra-rule-synth">Imandra Rule Synth</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/fix-engine">FIX Engine</a>
                        
                    </li>
                    
                </ul>
            </nav>
        </div>
    </div>

    <div class="background">
    </div>



    <div class="template-header">
        <div class="top-bar">
            <div class="side__nav-search">
                <input id="search" type="search" placeholder="Search">
                <div class="side__nav-search-icon">
                    <i class="fa fa-search"></i>
                </div>
            </div>

            <nav class="top-bar__nav-container">
                <a href="#" class="top-bar__toggle">≡</a>
                <div class="top-nav-bar__group ">
                    <div class="top-nav-bar__nav nav-bar--blue top-nav-bar__nav--hidden">
                        <ul class="top-nav-bar__links top-nav-bar__links--hidden-smaller-than-tablet">
                            <li class="top-nav-bar__item">
                                <a href="https://www.imandra.ai/" class="top-nav-bar__link">Home</a>
                            </li>
                            <li class="top-nav-bar__item">
                                <a href="https://try.imandra.ai/" class="top-nav-bar__link">Try</a>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--engine">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Engine</a>
                                <ul class="dropdown-content dropdown-content--engine">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--core.svg" alt="Imandra Core" title="Imandra Core Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/core">Imandra Core</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--demos.svg" alt="Demo Gallery" title="Imandra Demo Gallery Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/demos">Demo Gallery</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--docs.svg" alt="Docs" title="Docs Icon">
                                        <a class="dropdown__link" href="https://docs.imandra.ai/">Docs</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--research.svg" alt="Research" title="Research Icon">
                                        <a class="dropdown__link dropdown__link--last" href="https://www.imandra.ai/research">Research</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--industries">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Industries</a>
                                <ul class="dropdown-content dropdown-content--industries">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--financial.svg" alt="Financial Markets" title="Financial Markets Icon">
                                        <a class="dropdown__link " href="https://www.imandra.ai/imarkets">Financial Markets</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--autonomy.svg" alt="Autonomous Systems" title="Autonomous Systems Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/autonomy">Autonomous Systems</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--ml.svg" alt="Machine Learning" title="Machine Learning Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/ml">Machine Learning</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--government.svg" alt="Machine Learning" title="Machine Learning Icon">
                                        <a class="dropdown__link dropdown__link--last" href="https://www.imandra.ai/government">Government and defense</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--media">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Media</a>
                                <ul class="dropdown-content dropdown-content--media">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--media.svg" alt="Media" title="Media Icon">
                                        <a class="dropdown__link " href="https://www.imandra.ai/media">Media</a></li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--blog.svg" alt="Blog" title="Blog Icon">
                                        <a class="dropdown__link dropdown__link--last " href="https://medium.com/imandra">Blog</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--company">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Company</a>
                                <ul class="dropdown-content dropdown-content--company">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--about.svg" alt="About" title="About Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/about">About</a></li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--menu--careers.svg" alt=" Careers" title="Careers Icon">
                                        <a class="dropdown__link dropdown__link--last dropdown__link--bottom" href="https://www.imandra.ai/careers">Careers</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>

        <div class="template-header__image-container template-header__image-container--jupyter">
            <div class="template-header__image" href ="/imandra-docs">
                <img class="site-specific-image" src="/imandra-docs/static/img/site_specific_image_v_2.svg">
            </div>
        </div>

    </div>



    <script>
        document.getElementById('toggler--left').addEventListener('click', function () {
            document.querySelector('.side__right-menu-toggler .side__toggle').classList.remove(
                'side__toggle--active');
            document.querySelector('.side__left-menu-toggler .side__toggle').classList.toggle(
                'side__toggle--active');
            document.getElementsByClassName('side__nav-container')[0].classList.toggle(
                'side__nav-container--hidden');
            document.getElementsByClassName('top-nav-bar__nav')[0].classList.add('top-nav-bar__nav--hidden');
        });

        document.getElementById('toggler--right').addEventListener('click', function () {
            document.querySelector('.side__left-menu-toggler .side__toggle').classList.remove(
                'side__toggle--active');
            document.querySelector('.side__right-menu-toggler .side__toggle').classList.toggle(
                'side__toggle--active');

            document.getElementsByClassName('side__nav-container')[0].classList.add(
                'side__nav-container--hidden');
            document.getElementsByClassName('top-nav-bar__nav')[0].classList.toggle(
                'top-nav-bar__nav--hidden');
        });
    </script>
</header>
                <article class="article__container article__container--notebooks">
                    <div class="main-content main-content--jupyter">
                        
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Region-Decomposition:-Stock-exchange-trade-pricing">Region Decomposition: Stock exchange trade pricing<a class="anchor-link" href="#Region-Decomposition:-Stock-exchange-trade-pricing">&#182;</a></h1><p>Financial exchanges and other venues like <em>'dark pools'</em> and MTFs operate notoriously complex trading systems. In this notebook, we'll use Imandra's Region Decomposition feature to enumerate all of the 'edge-cases' of a component of the  SIX Swiss trading logic (as described <a href="https://www.six-group.com/dam/download/sites/education/preparatory-documentation/trading-module/trading-on-ssx-module-1-trading-en.pdf">here</a>).</p>
<p>In particular, we will use Imandra to:</p>
<ul>
<li>Model a fragment of the logic (the one dealing with fill price determination)</li>
<li>Decompose the state-space of the logic to enumerate all of its regions (or 'edge cases')</li>
<li>Transform the results to English-like prose</li>
<li>'Slice' the state-space with additional logic constraints</li>
<li>Generate concrete instances for each of the regions</li>
</ul>
<p><em>Region Decomposition</em> is a novel technique for analysis of algorithms' state-spaces and is available via Imandra's <em>"Reasoning as a Service"</em> platform. It is inspired by <a href="https://en.wikipedia.org/wiki/Cylindrical_algebraic_decomposition"><em>Cylindrical Algebraic Decomposition (CAD)</em></a> but is <em>lifted</em> to general algorithms written in OCaml or ReasonML (Imandra supports both, but this notebook uses OCaml). Imandra leverages many recent breakthroughs in formal verification to make this happen. This functionality is already relied upon in production by leading financial institutions, so please reach out to us if you would like to incorporate this into your products or development workflow. For more information, please see the <a href="https://docs.imandra.ai">documentation page</a>.</p>
<p><img src="https://storage.googleapis.com/imandra-notebook-assets/exchange_pricing_header.png" alt="Header"></p>
<h2 id="Modelling-trading-venues">Modelling trading venues<a class="anchor-link" href="#Modelling-trading-venues">&#182;</a></h2><p>At Imandra, we've pioneered a formal approach to modelling financial venues as <em>infinite state machines</em>. No doubt you've heard of <em>finite state machines</em> (or FSMs) - these are commonly used to describe logic of a streetlight or some other engineering artefact with a <em>finite</em> number of states. The problem with venues that operate in the real world is that they may be in a virtually <em>infinite</em> number of states (think of all the possible sequences of incoming  messages, operator settings, outside market dynamics, etc.).</p>
<p>Full description of this methodology is outside the scope of this notebook, but it's useful to keep in mind as you read through the following example. We'll also use 'simplified' types (e.g. representing time as integers and prices as reals) - interested readers should check out our public GitHub repositories and publications for full type definitions.</p>
<h2 id="Order-type-definitions">Order type definitions<a class="anchor-link" href="#Order-type-definitions">&#182;</a></h2><p>Our first step is to define type for orders:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-2" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">type</span> <span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span> <span class="o">|</span> <span class="nc">Limit</span> <span class="o">|</span> <span class="nc">Quote</span>

<span class="k">type</span> <span class="n">order</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">order_id</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span>
  <span class="n">order_type</span> <span class="o">:</span> <span class="n">order_type</span><span class="o">;</span>
  <span class="n">order_qty</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span>
  <span class="n">order_price</span> <span class="o">:</span> <span class="n">real</span><span class="o">;</span>
  <span class="n">order_time</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type order_type = Market | Limit | Quote
type order = {
  order_id : int;
  order_type : order_type;
  order_qty : int;
  order_price : real;
  order_time : int;
}
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>There are instances when we would not be able to determine a fill price (e.g. when the book is empty). To account for this, we'll make <code>fill_price</code> type support both cases.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-4" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="c">(* There are instances when the fill price may not be calculated at all. *)</span>
<span class="k">type</span> <span class="n">fill_price</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">Known</span> <span class="k">of</span> <span class="n">real</span>
  <span class="o">|</span> <span class="nc">Unknown</span>

<span class="c">(* An order book contains lists of buy and sell orders. *)</span>
<span class="k">type</span> <span class="n">order_book</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">buys</span> <span class="o">:</span> <span class="n">order</span> <span class="kt">list</span><span class="o">;</span>
  <span class="n">sells</span> <span class="o">:</span> <span class="n">order</span> <span class="kt">list</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type fill_price = Known of real | Unknown
type order_book = { buys : order list; sells : order list; }
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Auxiliary-functions">Auxiliary functions<a class="anchor-link" href="#Auxiliary-functions">&#182;</a></h2><p>We'll  define some helper functions which we'll use later on. The trading guide specifies that price of a fill may be influenced by the best and second best orders in the book (symmetrically buys and sells).</p>
<p><img src="https://storage.googleapis.com/imandra-notebook-assets/exchange_pricing_venue.png" alt="Order book"></p>
<p><em>Please note: the notion of 'best' orders in the code below is with respect to an order ranking criteria which is omitted in this notebook for brevity. We assume that the orders are already sorted with respect to this criteria. So, the 'best' buy order is the first order in the list. Sorting of order books is an interesting topic in itself - in 2015 we won (1st place out of more than 620 companies) the UBS Future of Finance FinTech Challenge where we demonstrated that the ranking criteria used in UBS ATS (as it was described in the SEC filing) was not transitive, leading to potentially significant violation of regulatory directives and "best-ex" rules. For more information, please read our <a href="https://www.imandra.ai/case-study-2015-sec-fine-against-ubs-ats">whitepaper</a>.</em></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-6" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="c">(* Determine whether order 1 or 2 is older. *)</span>
<span class="k">let</span> <span class="n">older_price</span> <span class="n">o1</span> <span class="n">o2</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">o1</span><span class="o">.</span><span class="n">order_time</span> <span class="o">&gt;</span> <span class="n">o2</span><span class="o">.</span><span class="n">order_time</span>
  <span class="k">then</span> <span class="n">o2</span><span class="o">.</span><span class="n">order_price</span> <span class="k">else</span> <span class="n">o1</span><span class="o">.</span><span class="n">order_price</span>

<span class="c">(* Return the best buy order of the book. *)</span>
<span class="k">let</span> <span class="n">best_buy</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">ob</span><span class="o">.</span><span class="n">buys</span> <span class="k">with</span>
  <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">x</span> <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="nc">None</span>

<span class="c">(* Similarly, return the best sell order of the book. *)</span>
<span class="k">let</span> <span class="n">best_sell</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">ob</span><span class="o">.</span><span class="n">sells</span> <span class="k">with</span>
  <span class="o">|</span> <span class="n">x</span><span class="o">::_</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">x</span> <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="nc">None</span>

<span class="c">(* Second-best buy order of the book *)</span>
<span class="k">let</span> <span class="n">next_buy</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">ob</span><span class="o">.</span><span class="n">buys</span> <span class="k">with</span>
    <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="nc">None</span> <span class="o">|</span> <span class="o">[</span><span class="n">o1</span><span class="o">]</span> <span class="o">-&gt;</span> <span class="nc">None</span>
    <span class="o">|</span> <span class="n">o1</span> <span class="o">::</span> <span class="n">o2</span> <span class="o">::</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">o2</span>

<span class="c">(* Second-best sell order *)</span>
<span class="k">let</span> <span class="n">next_sell</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">ob</span><span class="o">.</span><span class="n">sells</span> <span class="k">with</span>
  <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="nc">None</span> <span class="o">|</span> <span class="o">[</span><span class="n">o1</span><span class="o">]</span> <span class="o">-&gt;</span> <span class="nc">None</span>
  <span class="o">|</span> <span class="n">o1</span> <span class="o">::</span> <span class="n">o2</span> <span class="o">::</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">o2</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val older_price : order -&gt; order -&gt; real = &lt;fun&gt;
val best_buy : order_book -&gt; order option = &lt;fun&gt;
val best_sell : order_book -&gt; order option = &lt;fun&gt;
val next_buy : order_book -&gt; order option = &lt;fun&gt;
val next_sell : order_book -&gt; order option = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Pricing-logic">Pricing logic<a class="anchor-link" href="#Pricing-logic">&#182;</a></h2><p>Now that we have defined all of the necessary types and auxiliary functions, it's time to define the actual price-determining logic - <code>match_price</code> function that accepts two parameters:</p>
<ul>
<li><code>ob</code> - order book as defined above</li>
<li><code>ref_price</code> - reference price of the exchange. This refers to the last <em>stable</em> fill price that the exchange traded on. The exact definition is more nuanced, but for our purpose - just think of it a form of an 'anchor' that's used to determine fill prices when an order book doesn't contain enough information.</li>
</ul>
<p>Here's the main function for our exercise:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-8" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="n">match_price</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">(</span><span class="n">ref_price</span> <span class="o">:</span> <span class="n">real</span><span class="o">)</span> <span class="o">=</span>
  <span class="c">(* Select the best buy and sell order of the order book (if they exist) *)</span>
  <span class="k">let</span> <span class="n">bb</span> <span class="o">=</span> <span class="n">best_buy</span> <span class="n">ob</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">bs</span> <span class="o">=</span> <span class="n">best_sell</span> <span class="n">ob</span> <span class="k">in</span>
  <span class="k">match</span> <span class="n">bb</span><span class="o">,</span> <span class="n">bs</span> <span class="k">with</span>

  <span class="c">(* Now we&#39;ll match on values of `bb` and `bs`. We&#39;re using OCaml&#39;s option types -</span>
<span class="c">  explicitly having a value of `None` when no `bb` or `bs` order exists. *)</span>
  <span class="nc">Some</span> <span class="n">bb</span><span class="o">,</span> <span class="nc">Some</span> <span class="n">bs</span> <span class="o">-&gt;</span>
  <span class="k">begin</span>
    <span class="k">match</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_type</span><span class="o">,</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_type</span> <span class="k">with</span>
    <span class="c">(* When we&#39;re matching Limit/Limit or Quote/Quote orders, then</span>
<span class="c">        the outcome is simply limit price of the older order. *)</span>
    <span class="o">|</span> <span class="o">(</span><span class="nc">Limit</span><span class="o">,</span> <span class="nc">Limit</span><span class="o">)</span> <span class="o">|</span> <span class="o">(</span><span class="nc">Quote</span><span class="o">,</span> <span class="nc">Quote</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="o">(</span><span class="n">older_price</span> <span class="n">bb</span> <span class="n">bs</span><span class="o">)</span>

    <span class="c">(* Logic gets more nuanced, however, when *)</span>
    <span class="o">|</span> <span class="o">(</span><span class="nc">Market</span><span class="o">,</span> <span class="nc">Market</span><span class="o">)</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">&lt;&gt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span> <span class="nc">Unknown</span>
      <span class="k">else</span>
      <span class="c">(* need to look at other orders in the order book *)</span>
        <span class="k">let</span> <span class="n">bBid</span> <span class="o">=</span> <span class="k">match</span> <span class="o">(</span><span class="n">next_buy</span> <span class="n">ob</span><span class="o">)</span> <span class="k">with</span>
        <span class="nc">Some</span> <span class="n">bestBuy</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">bestBuy</span><span class="o">.</span><span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span> <span class="k">then</span> <span class="nc">None</span>
          <span class="k">else</span> <span class="nc">Some</span> <span class="n">bestBuy</span><span class="o">.</span><span class="n">order_price</span>
        <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">None</span> <span class="k">in</span>

        <span class="k">let</span> <span class="n">bAsk</span> <span class="o">=</span> <span class="k">match</span> <span class="o">(</span><span class="n">next_sell</span> <span class="n">ob</span><span class="o">)</span> <span class="k">with</span>
        <span class="nc">Some</span> <span class="n">bestSell</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">bestSell</span><span class="o">.</span><span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span> <span class="k">then</span> <span class="nc">None</span>
          <span class="k">else</span> <span class="nc">Some</span> <span class="n">bestSell</span><span class="o">.</span><span class="n">order_price</span>
        <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">None</span> <span class="k">in</span>

      <span class="k">begin</span>
        <span class="k">match</span> <span class="n">bBid</span><span class="o">,</span> <span class="n">bAsk</span> <span class="k">with</span>
        <span class="o">|</span> <span class="o">(</span><span class="nc">None</span><span class="o">,</span> <span class="nc">None</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">ref_price</span>
        <span class="o">|</span> <span class="o">(</span><span class="nc">None</span><span class="o">,</span> <span class="nc">Some</span> <span class="n">ask</span><span class="o">)</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">ask</span> <span class="o">&lt;.</span> <span class="n">ref_price</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">ask</span>
          <span class="k">else</span> <span class="nc">Known</span> <span class="n">ref_price</span>
        <span class="o">|</span> <span class="o">(</span><span class="nc">Some</span> <span class="n">bid</span><span class="o">,</span> <span class="nc">None</span><span class="o">)</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">bid</span> <span class="o">&gt;.</span> <span class="n">ref_price</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">bid</span>
          <span class="k">else</span> <span class="nc">Known</span> <span class="n">ref_price</span>
        <span class="o">|</span> <span class="o">(</span><span class="nc">Some</span> <span class="n">bid</span><span class="o">,</span> <span class="nc">Some</span> <span class="n">ask</span><span class="o">)</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">bid</span> <span class="o">&gt;.</span> <span class="n">ref_price</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">bid</span>
          <span class="k">else</span>
            <span class="k">if</span> <span class="n">ask</span> <span class="o">&lt;.</span> <span class="n">ref_price</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">ask</span>
            <span class="k">else</span> <span class="nc">Known</span> <span class="n">ref_price</span>
      <span class="k">end</span>

    <span class="o">|</span> <span class="o">(</span><span class="nc">Market</span><span class="o">,</span> <span class="nc">Limit</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>
    <span class="o">|</span> <span class="o">(</span><span class="nc">Limit</span><span class="o">,</span> <span class="nc">Market</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>

    <span class="o">|</span> <span class="o">(</span><span class="nc">Quote</span><span class="o">,</span>  <span class="nc">Limit</span><span class="o">)</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_time</span> <span class="o">&gt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_time</span> <span class="k">then</span>
        <span class="c">(* incoming quote *)</span>
        <span class="k">begin</span>
          <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">&lt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>
          <span class="k">else</span> <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span>
          <span class="k">match</span> <span class="o">(</span><span class="n">next_sell</span> <span class="n">ob</span><span class="o">)</span> <span class="k">with</span>
          <span class="o">|</span> <span class="nc">None</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>
          <span class="o">|</span> <span class="nc">Some</span> <span class="n">ord</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">ord</span><span class="o">.</span><span class="n">order_price</span>
          <span class="k">else</span> <span class="nc">Unknown</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="c">(* existing quote&#39;s price is used *)</span>
        <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>

    <span class="o">|</span> <span class="o">(</span><span class="nc">Quote</span><span class="o">,</span> <span class="nc">Market</span><span class="o">)</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_time</span> <span class="o">&gt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_time</span> <span class="k">then</span>
        <span class="c">(* incoming quote *)</span>
        <span class="k">begin</span>
          <span class="k">let</span> <span class="n">nextSellLimit</span> <span class="o">=</span> <span class="n">next_sell</span> <span class="n">ob</span> <span class="k">in</span>
          <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">&lt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>
          <span class="k">else</span> <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span>
          <span class="k">match</span> <span class="n">nextSellLimit</span> <span class="k">with</span>
          <span class="o">|</span> <span class="nc">None</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>
          <span class="o">|</span> <span class="nc">Some</span> <span class="n">ord</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">ord</span><span class="o">.</span><span class="n">order_price</span>
          <span class="k">else</span> <span class="nc">Unknown</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="c">(* The quote&#39;s price is used *)</span>
        <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>

    <span class="o">|</span> <span class="o">(</span><span class="nc">Limit</span><span class="o">,</span> <span class="nc">Quote</span><span class="o">)</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_time</span> <span class="o">&gt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_time</span> <span class="k">then</span>
        <span class="k">begin</span>
          <span class="c">(* incoming quote *)</span>
          <span class="k">if</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">&lt;</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span>
            <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>
          <span class="k">else</span>
            <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span>
              <span class="k">match</span> <span class="o">(</span><span class="n">next_buy</span> <span class="n">ob</span><span class="o">)</span> <span class="k">with</span>
              <span class="o">|</span> <span class="nc">None</span> <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>
              <span class="o">|</span> <span class="nc">Some</span> <span class="n">ord</span>  <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">ord</span><span class="o">.</span><span class="n">order_price</span>
            <span class="k">else</span>
              <span class="nc">Unknown</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="c">(* existing quote&#39;s price is used *)</span>
        <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>

    <span class="o">|</span> <span class="o">(</span><span class="nc">Market</span><span class="o">,</span> <span class="nc">Quote</span><span class="o">)</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_time</span> <span class="o">&gt;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_time</span> <span class="k">then</span>
        <span class="k">begin</span>
          <span class="c">(* incoming quote *)</span>
          <span class="k">if</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">&lt;</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span> <span class="nc">Known</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_price</span>
          <span class="k">else</span> <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">order_qty</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_qty</span> <span class="k">then</span>
          <span class="o">(</span><span class="k">match</span> <span class="o">(</span><span class="n">next_buy</span> <span class="n">ob</span><span class="o">)</span> <span class="k">with</span>
          <span class="o">|</span> <span class="nc">None</span>      <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>
          <span class="o">|</span> <span class="nc">Some</span> <span class="n">ord</span>  <span class="o">-&gt;</span> <span class="nc">Known</span> <span class="n">ord</span><span class="o">.</span><span class="n">order_price</span>
          <span class="o">)</span>
          <span class="k">else</span> <span class="nc">Unknown</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="c">(* The quote&#39;s price is used *)</span>
        <span class="nc">Known</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_price</span>
      <span class="k">end</span>
    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="nc">Unknown</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val match_price : order_book -&gt; real -&gt; fill_price = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now that we've defined <code>match_price</code>, let's try it out. We'll start by declaring 4 instances of different orders for us to experiment with later:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-10" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="n">order1</span> <span class="o">=</span> <span class="o">{</span>
 <span class="n">order_id</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
 <span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span><span class="o">;</span>
 <span class="n">order_qty</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
 <span class="n">order_price</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">;</span>
 <span class="n">order_time</span> <span class="o">=</span> <span class="mi">123</span><span class="o">;</span>
<span class="o">}</span>

<span class="k">let</span> <span class="n">order2</span> <span class="o">=</span> <span class="o">{</span>
 <span class="n">order_id</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
 <span class="n">order_type</span> <span class="o">=</span> <span class="nc">Quote</span><span class="o">;</span>
 <span class="n">order_qty</span> <span class="o">=</span> <span class="mi">250</span><span class="o">;</span>
 <span class="n">order_price</span> <span class="o">=</span> <span class="mi">12</span><span class="o">.</span><span class="mi">56</span><span class="o">;</span>
 <span class="n">order_time</span> <span class="o">=</span> <span class="mi">125</span><span class="o">;</span>
<span class="o">}</span>

<span class="k">let</span> <span class="n">order3</span> <span class="o">=</span> <span class="o">{</span>
 <span class="n">order_id</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
 <span class="n">order_type</span> <span class="o">=</span> <span class="nc">Limit</span><span class="o">;</span>
 <span class="n">order_qty</span> <span class="o">=</span> <span class="mi">250</span><span class="o">;</span>
 <span class="n">order_price</span> <span class="o">=</span> <span class="mi">40</span><span class="o">.</span><span class="mi">0</span><span class="o">;</span>
 <span class="n">order_time</span> <span class="o">=</span> <span class="mi">125</span><span class="o">;</span>
<span class="o">}</span>

<span class="k">let</span> <span class="n">order4</span> <span class="o">=</span> <span class="o">{</span>
 <span class="n">order_id</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
 <span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span><span class="o">;</span>
 <span class="n">order_qty</span> <span class="o">=</span> <span class="mi">250</span><span class="o">;</span>
 <span class="n">order_price</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">;</span>
 <span class="n">order_time</span> <span class="o">=</span> <span class="mi">125</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val order1 : order =
  {order_id = 1; order_type = Market; order_qty = 1000; order_price = 0;
   order_time = 123}
val order2 : order =
  {order_id = 2; order_type = Quote; order_qty = 250; order_price = 314/25;
   order_time = 125}
val order3 : order =
  {order_id = 3; order_type = Limit; order_qty = 250; order_price = 40;
   order_time = 125}
val order4 : order =
  {order_id = 4; order_type = Market; order_qty = 250; order_price = 0;
   order_time = 125}
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We'll now evaluate <code>match_price</code> with these new orders. Notice that we'll define <code>order_book</code> value inline when we call the function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-12" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">match_price</span> <span class="o">{</span><span class="n">buys</span><span class="o">=[</span><span class="n">order1</span><span class="o">];</span> <span class="n">sells</span><span class="o">=[</span><span class="n">order2</span><span class="o">]}</span> <span class="mi">123</span><span class="o">.</span><span class="mi">45</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : fill_price = Known 314/25
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-13" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">match_price</span> <span class="o">{</span><span class="n">buys</span><span class="o">=[</span><span class="n">order1</span><span class="o">];</span> <span class="n">sells</span><span class="o">=[</span><span class="n">order2</span><span class="o">;</span><span class="n">order3</span><span class="o">]}</span> <span class="mi">123</span><span class="o">.</span><span class="mi">45</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : fill_price = Known 314/25
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-14" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">match_price</span> <span class="o">{</span><span class="n">buys</span><span class="o">=[</span><span class="n">order1</span><span class="o">];</span> <span class="n">sells</span><span class="o">=[</span><span class="n">order2</span><span class="o">;</span><span class="n">order3</span><span class="o">]}</span> <span class="mi">123</span><span class="o">.</span><span class="mi">45</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : fill_price = Known 314/25
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-15" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">match_price</span> <span class="o">{</span><span class="n">buys</span><span class="o">=[</span><span class="n">order3</span><span class="o">];</span> <span class="n">sells</span><span class="o">=[</span><span class="n">order1</span><span class="o">;</span><span class="n">order2</span><span class="o">]}</span> <span class="mi">34</span><span class="o">.</span><span class="mi">44</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : fill_price = Known 40
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Region-Decomposition-of-match_price"><em>Region Decomposition</em> of <code>match_price</code><a class="anchor-link" href="#Region-Decomposition-of-match_price">&#182;</a></h2><p>We've tried a few examples and it already feels that there are many ways <code>match_price</code> can behave. From the type definitions, we know that there are virtually infinitely many possible inputs into <code>match_price.</code> So how can we enumerate these distinct 'edge cases'?</p>
<p>This is what <em>Region Decomposition</em> is designed to do.</p>
<p><img src="https://storage.googleapis.com/imandra-notebook-assets/exchange_pricing_decomp.png" alt="Region Decomposition"></p>
<p>To <em>decompose</em> the state-space of <code>match_price</code>, we'll use <code>Modular_decomp.top</code> command. Notice that while our types and the actual code was entered in Imandra's <code>logic</code> mode, we'll now switch to <code>program</code> mode. The results of decomposition will be reflected into <code>program</code> mode so we may use the full power of OCaml language to utilise the results.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-17" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="o">#</span><span class="n">program</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">d</span> <span class="o">=</span> <span class="nn">Modular_decomp</span><span class="p">.</span><span class="n">top</span> <span class="o">~</span><span class="n">prune</span><span class="o">:</span><span class="bp">true</span> <span class="s2">&quot;match_price&quot;</span><span class="o">;;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val d : Modular_decomposition.t =
  {Imandra_interactive.Modular_decomp.MD.md_session = 1i;
   md_f =
    {Imandra_surface.Uid.name = &#34;match_price&#34;; id = &lt;abstr&gt;;
     special_tag = &lt;abstr&gt;; namespace = &lt;abstr&gt;;
     chash = Some ckDXzMFR6ZZheLOSW5Agarw3251S7e/z/5Xp6GNuqLw;
     depth = (4i, 4i)};
   md_args = [(ob : order_book); (ref_price : real)]; md_regions = &lt;abstr&gt;}
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="imandra-alternatives" id="alt-8ca047cf-1547-43c3-9fcb-5dc8ad19f9c1"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>Voronoi (44 of 44)</a></li><li class="" data-toggle="tab"><a>Table</a></li></ul><div class="tab-content"><div class="tab-pane active"><div id="decompose-41e9b953-7101-4e32-b118-e3a28f28e95e" class="decompose"><textarea class="display-none">{
  &quot;regions&quot;: [
    {
      &quot;constraints&quot;: [ &quot;ob.buys = []&quot; ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [ &quot;ob.buys = []&quot; ],
        &quot;invariant&quot;: &quot;F = Unknown&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;9&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [ &quot;ob.buys &lt;&gt; []&quot;, &quot;ob.sells = []&quot; ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [ &quot;ob.sells = []&quot;, &quot;ob.buys &lt;&gt; []&quot; ],
        &quot;invariant&quot;: &quot;F = Unknown&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;8.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_type is Limit&quot;,
        &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
        &quot;(List.hd ob.sells).order_type is Limit&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
          &quot;(List.hd ob.sells).order_type is Limit&quot;,
          &quot;(List.hd ob.buys).order_type is Limit&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;7.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.sells).order_type is Quote&quot;,
        &quot;(List.hd ob.buys).order_type is Limit&quot;,
        &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
          &quot;(List.hd ob.sells).order_type is Quote&quot;,
          &quot;(List.hd ob.buys).order_type is Limit&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;6.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_type is Quote&quot;,
        &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Quote&quot;,
            &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
            &quot;(List.hd ob.sells).order_type is Quote&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
              &quot;(List.hd ob.sells).order_type is Quote&quot;,
              &quot;(List.hd ob.buys).order_type is Quote&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Quote&quot;,
            &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
            &quot;(List.hd ob.sells).order_type is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
              &quot;(List.hd ob.sells).order_type is Limit&quot;,
              &quot;(List.hd ob.buys).order_type is Quote&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.1&quot;,
          &quot;weight&quot;: 1
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 2
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
            &quot;(List.hd ob.buys).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_type is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_type is Limit&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Limit&quot;,
                      &quot;(List.hd ob.buys).order_type is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_type is Limit&quot;,
                    &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Limit&quot;,
                      &quot;(List.hd ob.buys).order_type is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
            &quot;(List.hd ob.buys).order_type is Limit&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Limit&quot;,
                &quot;(List.hd ob.sells).order_type is Limit&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Limit&quot;,
                  &quot;(List.hd ob.buys).order_type is Limit&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Limit&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_type is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_type is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 6
    },
    {
      &quot;constraints&quot;: [ &quot;(List.hd ob.sells).order_type is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_type is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.sells).order_type is Market&quot;,
              &quot;(List.hd ob.buys).order_type is Limit&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;3.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_type is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;3.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_type is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;3.1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_type is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;3.1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 4
    },
    {
      &quot;constraints&quot;: [ &quot;(List.hd ob.buys).order_type is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.sells).order_type is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.sells).order_type is Limit&quot;,
              &quot;(List.hd ob.buys).order_type is Market&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2.3&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_qty &lt;&gt; (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.sells).order_type is Market&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.buys).order_qty &lt;&gt; (List.hd ob.sells).order_qty&quot;,
              &quot;(List.hd ob.sells).order_type is Market&quot;,
              &quot;(List.hd ob.buys).order_type is Market&quot;
            ],
            &quot;invariant&quot;: &quot;F = Unknown&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2.2.1&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.sells).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_type is Market&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;2.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;2.1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;2.1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 5
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_type is Limit&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_type is Limit&quot;,
                    &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) = []&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Limit&quot;,
                      &quot;(List.hd ob.buys).order_type is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_type is Limit&quot;,
                    &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) &lt;&gt; []&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Limit&quot;,
                      &quot;(List.hd ob.buys).order_type is Quote&quot;
                    ],
                    &quot;invariant&quot;:
                      &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Limit&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.buys) = []&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_type is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.buys) &lt;&gt; []&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_type is Limit&quot;
                    ],
                    &quot;invariant&quot;:
                      &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 4
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
            &quot;(List.hd ob.buys).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.tl ob.sells) = []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.sells) = []&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_type is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.tl ob.sells) &lt;&gt; []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.sells) &lt;&gt; []&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_type is Quote&quot;
                ],
                &quot;invariant&quot;:
                  &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.buys).order_type is Market&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;,
                &quot;(List.tl ob.buys) &lt;&gt; []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.buys) &lt;&gt; []&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_type is Market&quot;
                ],
                &quot;invariant&quot;:
                  &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.3.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.tl ob.buys) = []&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.buys) = []&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_type is Market&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.2.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) = []&quot;, &quot;(List.tl ob.buys) = []&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.5.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                      &quot;(List.tl ob.buys) = []&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.4.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                        &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.tl ob.sells) = []&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;,
                        &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.2.3.1&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                        &quot;(List.tl ob.buys) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.2.2.1&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                            &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 4
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.tl ob.sells) = []&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.3&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 3
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.tl ob.sells) = []&quot;,
                              &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.3&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                              &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                          ],
                          &quot;region&quot;: null,
                          &quot;groups&quot;: [
                            {
                              &quot;constraints&quot;: [
                                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                &quot;(List.hd ob.buys).order_type is Market&quot;,
                                &quot;(List.hd ob.sells).order_type is Market&quot;,
                                &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                                &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                              ],
                              &quot;region&quot;: {
                                &quot;constraints&quot;: [
                                  &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                                  &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                                  &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                  &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                                  &quot;(List.hd ob.buys).order_type is Market&quot;
                                ],
                                &quot;invariant&quot;:
                                  &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                              },
                              &quot;groups&quot;: [],
                              &quot;label&quot;: &quot;1.1.1.1.1.1.2&quot;,
                              &quot;weight&quot;: 1
                            },
                            {
                              &quot;constraints&quot;: [
                                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                &quot;(List.hd ob.buys).order_type is Market&quot;,
                                &quot;(List.hd ob.sells).order_type is Market&quot;,
                                &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                                &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;
                              ],
                              &quot;region&quot;: {
                                &quot;constraints&quot;: [
                                  &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                                  &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                                  &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                  &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                                  &quot;(List.hd ob.buys).order_type is Market&quot;
                                ],
                                &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                              },
                              &quot;groups&quot;: [],
                              &quot;label&quot;: &quot;1.1.1.1.1.1.1&quot;,
                              &quot;weight&quot;: 1
                            }
                          ],
                          &quot;label&quot;: &quot;&quot;,
                          &quot;weight&quot;: 2
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 4
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 7
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 15
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 17
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 23
    }
  ]
}</textarea><div class="decompose-foamtree"></div><div class="decompose-details"><div class="decompose-details-header">Regions details</div><div class="decompose-details-no-selection"><p>No group selected.</p><ul><li>Concrete regions are numbered</li><li>Unnumbered regions are groups whose children share a particular constraint</li><li>Click on a region to view its details</li><li>Double click on a region to zoom in on it</li><li>Shift+double click to zoom out</li><li>Hit escape to reset back to the top</li></ul></div><div class="decompose-details-selection hidden"><div><span class="decompose-details-label">Direct sub-regions: </span><span class="decompose-details-direct-sub-regions-text">-</span></div><div><span class="decompose-details-label">Contained regions: </span><span class="decompose-details-contained-regions-text">-</span></div><div class="decompose-details-section-header">Constraints</div><div class="decompose-details-constraints"><pre class="decompose-details-constraint">&lt;constraint&gt;</pre></div><div class="decompose-details-invariant"><div class="decompose-details-section-header">Invariant</div><pre class="decompose-details-invariant-text">&lt;invariant&gt;</pre></div></div></div><script>
(function () {
  require(['nbextensions/nbimandra/regions'], function (regions) {
    var target = '#decompose-41e9b953-7101-4e32-b118-e3a28f28e95e';
    regions.hydrate(target);
  });
})();
</script></div></div><div class="tab-pane"><div><div>decomp of (match_price ob, ref_price<div class="imandra-table" id="table-5e40f644-f9a3-40f8-85bf-17433e47456a"><table><thead><tr><th>Reg_id</th><th>Constraints</th><th>Invariant</th></tr></thead><tr><td>43</td><td><ul><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>42</td><td><ul><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>41</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>40</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>39</td><td><ul><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>38</td><td><ul><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>37</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty)</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Unknown</pre></td></tr><tr><td>36</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>35</td><td><ul><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>34</td><td><ul><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>33</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>32</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>31</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>30</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty)</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Unknown</pre></td></tr><tr><td>29</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>28</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>27</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>26</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>25</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty)</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Unknown</pre></td></tr><tr><td>24</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>23</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Unknown</pre></td></tr><tr><td>22</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>21</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>20</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>19</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>18</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>17</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>16</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>15</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>14</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>13</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>12</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>11</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>10</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>9</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>8</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>7</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>6</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>5</td><td><ul><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>4</td><td><ul><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>3</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty)</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Unknown</pre></td></tr><tr><td>2</td><td><ul><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>1</td><td><ul><li><pre>not (ob.sells &lt;&gt; [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li></ul></td><td><pre>Unknown</pre></td></tr><tr><td>0</td><td><ul><li><pre>not (ob.buys &lt;&gt; [])</pre></li></ul></td><td><pre>Unknown</pre></td></tr></table></div></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-8ca047cf-1547-43c3-9fcb-5dc8ad19f9c1';
  alternatives.hydrate(target);
});
</script></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Analysis-of-the-results">Analysis of the results<a class="anchor-link" href="#Analysis-of-the-results">&#182;</a></h2><p>The regions Imandra produces cover the entire behavior of <code>match_price</code> function. In Jupyter Notebooks we've created hierarchical Voronoi diagrams for their easier exploration. In this widget, all of the leafs are distinct regions (e.g. <code>R[2]</code>), while edges are constraints that are shared with regions below. So, <code>(1)</code> denotes a group of regions all sharing the constraint <code>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</code>. If you click on the top-left edge, the right pane will display information about this region, namely that there are 3 Direct sub-regions and 23 Contained Regions.</p>
<h2 id="Refinement-and-pretty-printing">Refinement and pretty-printing<a class="anchor-link" href="#Refinement-and-pretty-printing">&#182;</a></h2><p>The results displayed are terse - the default printer returns all of the low-level information that Imandra generates. This is intended - you may wish to process all or some of this data.</p>
<p>To make processing this data easy, we have created Imandra-tools - a library with transformers for easy manipulation and printing of this data.</p>
<p>Let's try to render the results in something closer to English. For example, a reference to the first buy order within the logic would be described as <code>List.hd ob.buys</code>, or in the correct underlying type notation as <code>Funcall (Var "List.hd", [ FieldOf (_, "buys", Var "ob")])</code>. We would much rather see 'First buy order' rather than <code>List.hd ...</code>.</p>
<p>The following code will use Imandra-tools to condense the region constraints and make them more "readable":</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-19" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="o">#</span><span class="n">program</span><span class="o">;;</span>

<span class="k">open</span> <span class="nc">Imandra_tools</span><span class="o">;;</span>

<span class="k">module</span> <span class="nc">PPrinter</span> <span class="o">=</span> <span class="nn">Region_pp</span><span class="p">.</span><span class="nc">PPrinter</span><span class="o">;;</span>

<span class="k">module</span> <span class="nc">Refiner</span> <span class="o">=</span> <span class="k">struct</span>
 <span class="k">open</span> <span class="nc">PPrinter</span>

 <span class="c">(* This function will be used to traverse the regions&#39; data (constraints and invariants) and convert them to humanly readable text *)</span>
 <span class="k">let</span> <span class="n">walk</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">node</span><span class="o">)</span> <span class="o">:</span> <span class="n">node</span> <span class="o">=</span> <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
  <span class="o">|</span> <span class="nc">Funcall</span> <span class="o">(</span><span class="nc">Var</span> <span class="s2">&quot;List.hd&quot;</span><span class="o">,</span> <span class="o">[</span><span class="nc">FieldOf</span> <span class="o">(_,</span> <span class="s2">&quot;buys&quot;</span><span class="o">,</span> <span class="o">_)])</span> <span class="o">-&gt;</span> <span class="nc">Var</span> <span class="s2">&quot;First buy order&quot;</span>
  <span class="o">|</span> <span class="nc">Funcall</span> <span class="o">(</span><span class="nc">Var</span> <span class="s2">&quot;List.hd&quot;</span><span class="o">,</span> <span class="o">[</span><span class="nc">FieldOf</span> <span class="o">(_,</span> <span class="s2">&quot;sells&quot;</span><span class="o">,</span> <span class="o">_)])</span> <span class="o">-&gt;</span> <span class="nc">Var</span> <span class="s2">&quot;First sell order&quot;</span>
  <span class="o">|</span> <span class="nc">Funcall</span> <span class="o">(</span><span class="nc">Var</span> <span class="s2">&quot;List.hd&quot;</span><span class="o">,</span> <span class="o">[</span><span class="nc">Funcall</span> <span class="o">(</span><span class="nc">Var</span> <span class="s2">&quot;List.tl&quot;</span><span class="o">,</span> <span class="o">[</span><span class="nc">FieldOf</span> <span class="o">(_,</span> <span class="s2">&quot;buys&quot;</span><span class="o">,</span> <span class="o">_)])])</span> <span class="o">-&gt;</span> <span class="nc">Var</span> <span class="s2">&quot;Second buy order&quot;</span>
  <span class="o">|</span> <span class="nc">Funcall</span> <span class="o">(</span><span class="nc">Var</span> <span class="s2">&quot;List.hd&quot;</span><span class="o">,</span> <span class="o">[</span><span class="nc">Funcall</span> <span class="o">(</span><span class="nc">Var</span> <span class="s2">&quot;List.tl&quot;</span><span class="o">,</span> <span class="o">[</span><span class="nc">FieldOf</span> <span class="o">(_,</span> <span class="s2">&quot;sells&quot;</span><span class="o">,</span> <span class="o">_)])])</span> <span class="o">-&gt;</span> <span class="nc">Var</span> <span class="s2">&quot;Second sell order&quot;</span>
  <span class="o">|</span> <span class="nc">Is</span> <span class="o">(</span><span class="n">t</span><span class="o">,</span> <span class="n">ty</span><span class="o">,</span> <span class="nc">FieldOf</span> <span class="o">(_,</span> <span class="s2">&quot;order_type&quot;</span><span class="o">,</span> <span class="n">x</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="nc">Is</span> <span class="o">(</span><span class="n">t</span><span class="o">,</span> <span class="n">ty</span><span class="o">,</span> <span class="n">x</span><span class="o">)</span>
  <span class="o">|</span> <span class="nc">FieldOf</span> <span class="o">(</span><span class="nc">Assoc</span><span class="o">,</span> <span class="o">((</span><span class="s2">&quot;order_id&quot;</span> <span class="o">|</span> <span class="s2">&quot;order_qty&quot;</span> <span class="o">|</span> <span class="s2">&quot;order_price&quot;</span> <span class="o">|</span> <span class="s2">&quot;order_time&quot;</span><span class="o">)</span> <span class="k">as</span> <span class="n">field</span><span class="o">),</span> <span class="n">x</span><span class="o">)</span>
    <span class="o">-&gt;</span> <span class="nc">FieldOf</span><span class="o">(</span><span class="nc">Human</span><span class="o">,</span> <span class="n">field</span><span class="o">,</span> <span class="n">x</span><span class="o">)</span>
  <span class="o">|</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span>

 <span class="k">let</span> <span class="n">refine</span> <span class="n">node</span> <span class="o">=</span>
  <span class="nn">XF</span><span class="p">.</span><span class="n">walk_fix</span> <span class="n">walk</span> <span class="n">node</span>
   <span class="o">|&gt;</span> <span class="nn">CCList</span><span class="p">.</span><span class="n">return</span>
<span class="k">end</span>

<span class="k">let</span> <span class="n">pp_cs</span> <span class="o">?</span><span class="n">inv</span> <span class="n">cs</span> <span class="o">=</span>
 <span class="n">cs</span>
 <span class="o">|&gt;</span> <span class="nn">PPrinter</span><span class="p">.</span><span class="n">pp</span> <span class="o">~</span><span class="n">refine</span><span class="o">:</span><span class="nn">Refiner</span><span class="p">.</span><span class="n">refine</span> <span class="o">?</span><span class="n">inv</span>
 <span class="o">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="nn">CCFormat</span><span class="p">.</span><span class="n">to_string</span> <span class="o">(</span><span class="nn">PPrinter</span><span class="p">.</span><span class="nn">Printer</span><span class="p">.</span><span class="n">print</span> <span class="bp">()</span><span class="o">))</span>

<span class="k">let</span> <span class="n">regions_doc</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="nn">Modular_decomposition</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="o">=</span>
 <span class="nn">Jupyter_imandra</span><span class="p">.</span><span class="nn">Decompose_render</span><span class="p">.</span><span class="n">regions_doc</span> <span class="o">~</span><span class="n">pp_cs</span> <span class="n">d</span><span class="o">;;</span>

<span class="o">#</span><span class="n">install_doc</span> <span class="n">regions_doc</span><span class="o">;;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>module PPrinter = Imandra_tools.Region_pp.PPrinter
module Refiner :
  sig
    val walk : PPrinter.node -&gt; PPrinter.node
    val refine :
      Imandra_tools.Region_pp.PPrinter.node -&gt;
      Imandra_tools.Region_pp.PPrinter.node list
  end
val pp_cs : ?inv:bool -&gt; Term.term list -&gt; string list = &lt;fun&gt;
val regions_doc : Modular_decomposition.t -&gt; Document.t = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-20" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">d</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Top_result.modular_decomposition = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div id="decompose-09b0f698-edc2-4e16-bba7-8766ffb8a056" class="decompose"><textarea class="display-none">{
  &quot;regions&quot;: [
    {
      &quot;constraints&quot;: [ &quot;ob.buys = []&quot; ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [ &quot;ob.buys = []&quot; ],
        &quot;invariant&quot;: &quot;F = Unknown&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;9&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [ &quot;ob.buys &lt;&gt; []&quot;, &quot;ob.sells = []&quot; ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [ &quot;ob.sells = []&quot;, &quot;ob.buys &lt;&gt; []&quot; ],
        &quot;invariant&quot;: &quot;F = Unknown&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;8.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order is Limit&quot;, &quot;First sell order is Limit&quot;,
        &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
          &quot;First sell order is Limit&quot;, &quot;First buy order is Limit&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;7.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;,
        &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
          &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;6.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order is Quote&quot;,
        &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Quote&quot;,
            &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
            &quot;First sell order is Quote&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
              &quot;First sell order is Quote&quot;, &quot;First buy order is Quote&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Quote&quot;,
            &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
            &quot;First sell order is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
              &quot;First sell order is Limit&quot;, &quot;First buy order is Quote&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.1&quot;,
          &quot;weight&quot;: 1
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 2
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order's order_time &gt; First sell order's order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
            &quot;First buy order is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Quote&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First sell order is Quote&quot;, &quot;First buy order is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                    &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Limit&quot;, &quot;First buy order is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                    &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Limit&quot;, &quot;First buy order is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
            &quot;First buy order is Limit&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Limit&quot;, &quot;First sell order is Limit&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First sell order is Limit&quot;, &quot;First buy order is Limit&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                    &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                    &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;4.1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 6
    },
    {
      &quot;constraints&quot;: [ &quot;First sell order is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First sell order is Market&quot;, &quot;First buy order is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First sell order is Market&quot;, &quot;First buy order is Limit&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;3.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
                  &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;3.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;3.1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;3.1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 4
    },
    {
      &quot;constraints&quot;: [ &quot;First buy order is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;, &quot;First sell order is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First sell order is Limit&quot;, &quot;First buy order is Market&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2.3&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;,
            &quot;First buy order's order_qty &lt;&gt; First sell order's order_qty&quot;,
            &quot;First sell order is Market&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First buy order's order_qty &lt;&gt; First sell order's order_qty&quot;,
              &quot;First sell order is Market&quot;, &quot;First buy order is Market&quot;
            ],
            &quot;invariant&quot;: &quot;F = Unknown&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2.2.1&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
                  &quot;First sell order is Quote&quot;, &quot;First buy order is Market&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;2.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Quote&quot;,
                      &quot;First buy order is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Unknown&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;2.1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Quote&quot;,
                      &quot;First buy order is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;2.1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 3
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 5
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order's order_qty = First sell order's order_qty&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                    &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) = []&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Limit&quot;, &quot;First buy order is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                    &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) &lt;&gt; []&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Limit&quot;, &quot;First buy order is Quote&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known Second sell order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.buys) = []&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                    &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.buys) &lt;&gt; []&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known Second buy order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 4
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
            &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;(List.tl ob.sells) = []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.sells) = []&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;(List.tl ob.sells) &lt;&gt; []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.sells) &lt;&gt; []&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known Second sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
            &quot;First buy order is Market&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order is Market&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;(List.tl ob.buys) &lt;&gt; []&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.buys) &lt;&gt; []&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First sell order is Quote&quot;, &quot;First buy order is Market&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known Second buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.3.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order is Market&quot;, &quot;(List.tl ob.buys) = []&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.buys) = []&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First sell order is Quote&quot;, &quot;First buy order is Market&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.2.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;Second buy order is Market&quot;,
                    &quot;Second sell order is Market&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;Second sell order is Market&quot;,
                      &quot;Second buy order is Market&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.5.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;, &quot;(List.tl ob.sells) = []&quot;,
                    &quot;Second buy order is Market&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) = []&quot;,
                      &quot;Second buy order is Market&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.4.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;, &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;,
                        &quot;Second sell order is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second sell order is Market&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.tl ob.sells) = []&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;Second sell order isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;Second buy order is Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;Second buy order is Market&quot;,
                            &quot;ref_price &gt; Second sell order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;ref_price &gt; Second sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;,
                              &quot;Second buy order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second sell order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;Second buy order is Market&quot;,
                            &quot;Second sell order's order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;Second sell order's order_price &gt;= ref_price&quot;,
                              &quot;Second sell order isn't Market&quot;,
                              &quot;Second buy order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;(List.tl ob.buys) = []&quot;,
                            &quot;ref_price &gt; Second sell order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;ref_price &gt; Second sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;,
                              &quot;(List.tl ob.buys) = []&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second sell order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;(List.tl ob.buys) = []&quot;,
                            &quot;Second sell order's order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;Second sell order's order_price &gt;= ref_price&quot;,
                              &quot;Second sell order isn't Market&quot;,
                              &quot;(List.tl ob.buys) = []&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 4
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;Second buy order isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;ref_price &gt;= Second buy order's order_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;ref_price &gt;= Second buy order's order_price&quot;,
                            &quot;Second sell order is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;Second sell order is Market&quot;,
                              &quot;ref_price &gt;= Second buy order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;ref_price &gt;= Second buy order's order_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.tl ob.sells) = []&quot;,
                              &quot;ref_price &gt;= Second buy order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second sell order isn't Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;ref_price &gt; Second sell order's order_price&quot;,
                            &quot;ref_price &gt;= Second buy order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;ref_price &gt; Second sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;,
                              &quot;ref_price &gt;= Second buy order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second sell order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2.2.1&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;Second buy order's order_price &lt;= ref_price &lt;=\nSecond sell order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;Second buy order's order_price &lt;= ref_price &lt;=\nSecond sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second buy order's order_price &gt; ref_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second buy order's order_price &gt; ref_price&quot;,
                            &quot;Second sell order isn't Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;Second sell order isn't Market&quot;,
                              &quot;Second buy order's order_price &gt; ref_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second buy order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.3&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second buy order's order_price &gt; ref_price&quot;,
                            &quot;Second sell order is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;Second sell order is Market&quot;,
                              &quot;Second buy order's order_price &gt; ref_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second buy order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second buy order's order_price &gt; ref_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.tl ob.sells) = []&quot;,
                              &quot;Second buy order's order_price &gt; ref_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second buy order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 3
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 7
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 15
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 17
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 23
    }
  ]
}</textarea><div class="decompose-foamtree"></div><div class="decompose-details"><div class="decompose-details-header">Regions details</div><div class="decompose-details-no-selection"><p>No group selected.</p><ul><li>Concrete regions are numbered</li><li>Unnumbered regions are groups whose children share a particular constraint</li><li>Click on a region to view its details</li><li>Double click on a region to zoom in on it</li><li>Shift+double click to zoom out</li><li>Hit escape to reset back to the top</li></ul></div><div class="decompose-details-selection hidden"><div><span class="decompose-details-label">Direct sub-regions: </span><span class="decompose-details-direct-sub-regions-text">-</span></div><div><span class="decompose-details-label">Contained regions: </span><span class="decompose-details-contained-regions-text">-</span></div><div class="decompose-details-section-header">Constraints</div><div class="decompose-details-constraints"><pre class="decompose-details-constraint">&lt;constraint&gt;</pre></div><div class="decompose-details-invariant"><div class="decompose-details-section-header">Invariant</div><pre class="decompose-details-invariant-text">&lt;invariant&gt;</pre></div></div></div><script>
(function () {
  require(['nbextensions/nbimandra/regions'], function (regions) {
    var target = '#decompose-09b0f698-edc2-4e16-bba7-8766ffb8a056';
    regions.hydrate(target);
  });
})();
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now we see the same regions, but constraints and invariants refined and translated into English-like prose. Notice that references to the OCaml function <code>List.hd</code> have been replaced by <code>First Buy Order</code>, just as we've wanted.</p>
<h2 id="Adding-constraints-(side-conditions)">Adding constraints (side conditions)<a class="anchor-link" href="#Adding-constraints-(side-conditions)">&#182;</a></h2><p>The regions Imandra has thus far produced describe the full state-space of <code>match_price.</code> But what if we would like to focus on its specific subset? Can we, somehow, 'slice' the state-space? Absolutely, you can do this by adding a 'side-condition', a function that takes the same arguments as <code>match_price</code> and returns a boolean value. Imandra will constrain the state-space of <code>match_price</code> such that the side condition is <code>true</code>. This is quite a powerful mechanism which we'll illustrate with two examples: one case where we simply constrain the <em>inputs</em> into <code>match_price</code> and another where we constrain the <em>output</em> of <code>match_price</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-22" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="c">(* Side condition function must be defined in logic mode just like the original `match_price` function. *)</span>
<span class="o">#</span><span class="n">logic</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">side_condition</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">(</span><span class="n">ref_price</span> <span class="o">:</span> <span class="n">real</span><span class="o">)</span>  <span class="o">=</span>
 <span class="k">match</span> <span class="n">best_buy</span><span class="o">(</span><span class="n">ob</span><span class="o">),</span> <span class="n">best_sell</span><span class="o">(</span><span class="n">ob</span><span class="o">)</span> <span class="k">with</span>
 <span class="o">|</span> <span class="nc">Some</span> <span class="n">bb</span><span class="o">,</span> <span class="nc">Some</span> <span class="n">bs</span> <span class="o">-&gt;</span>
     <span class="n">bb</span><span class="o">.</span><span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span> <span class="o">&amp;&amp;</span> <span class="n">bs</span><span class="o">.</span><span class="n">order_type</span> <span class="o">=</span> <span class="nc">Market</span>
 <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">false</span>
<span class="o">;;</span>

<span class="c">(* Decomposition is a `program-mode` feature allowing us to use any OCaml/ReasonML code to manipulate the results. *)</span>
<span class="o">#</span><span class="n">program</span><span class="o">;;</span>

<span class="nn">Modular_decomp</span><span class="p">.</span><span class="n">top</span> <span class="o">~</span><span class="n">assuming</span><span class="o">:</span><span class="s2">&quot;side_condition&quot;</span> <span class="s2">&quot;match_price&quot;</span><span class="o">;;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val side_condition : order_book -&gt; real -&gt; bool = &lt;fun&gt;
- : Top_result.modular_decomposition = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="imandra-alternatives" id="alt-71f30151-a98c-4e5a-9850-ed6c65c58632"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>Voronoi (16 of 16)</a></li><li class="" data-toggle="tab"><a>Table</a></li></ul><div class="tab-content"><div class="tab-pane active"><div id="decompose-3c937a55-bb43-422c-92e0-248c7f50e231" class="decompose"><textarea class="display-none">{
  &quot;regions&quot;: [
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_type is Market&quot;,
        &quot;(List.hd ob.sells).order_type is Market&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_qty &lt;&gt; (List.hd ob.sells).order_qty&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.buys).order_type is Market&quot;,
              &quot;(List.hd ob.sells).order_type is Market&quot;,
              &quot;(List.hd ob.buys).order_qty &lt;&gt; (List.hd ob.sells).order_qty&quot;
            ],
            &quot;invariant&quot;: &quot;F = Unknown&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.sells) = []&quot;, &quot;(List.tl ob.buys) = []&quot;,
                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known ref_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.5.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                &quot;(List.tl ob.buys) = []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                  &quot;(List.tl ob.buys) = []&quot;,
                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known ref_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.4.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                    &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) = []&quot;,
                      &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.3.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                      &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.3.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                    &quot;(List.tl ob.buys) = []&quot;,
                    &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                      &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                      &quot;(List.tl ob.buys) = []&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                    ],
                    &quot;invariant&quot;:
                      &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.2.3.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                      &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                      &quot;(List.tl ob.buys) = []&quot;,
                      &quot;(List.hd ob.buys).order_type is Market&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.2.2.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                        &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.2.1.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.2.1.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 4
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                        &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.tl ob.sells) = []&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.3&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 3
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                    &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                        &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.tl ob.sells) = []&quot;,
                          &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                          &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                            &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                              &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                              &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 4
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 7
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 15
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 16
    }
  ]
}</textarea><div class="decompose-foamtree"></div><div class="decompose-details"><div class="decompose-details-header">Regions details</div><div class="decompose-details-no-selection"><p>No group selected.</p><ul><li>Concrete regions are numbered</li><li>Unnumbered regions are groups whose children share a particular constraint</li><li>Click on a region to view its details</li><li>Double click on a region to zoom in on it</li><li>Shift+double click to zoom out</li><li>Hit escape to reset back to the top</li></ul></div><div class="decompose-details-selection hidden"><div><span class="decompose-details-label">Direct sub-regions: </span><span class="decompose-details-direct-sub-regions-text">-</span></div><div><span class="decompose-details-label">Contained regions: </span><span class="decompose-details-contained-regions-text">-</span></div><div class="decompose-details-section-header">Constraints</div><div class="decompose-details-constraints"><pre class="decompose-details-constraint">&lt;constraint&gt;</pre></div><div class="decompose-details-invariant"><div class="decompose-details-section-header">Invariant</div><pre class="decompose-details-invariant-text">&lt;invariant&gt;</pre></div></div></div><script>
(function () {
  require(['nbextensions/nbimandra/regions'], function (regions) {
    var target = '#decompose-3c937a55-bb43-422c-92e0-248c7f50e231';
    regions.hydrate(target);
  });
})();
</script></div></div><div class="tab-pane"><div><div>decomp of (match_price ob, ref_price<div class="imandra-table" id="table-1363e93f-aa07-4ea4-862b-560d246376bb"><table><thead><tr><th>Reg_id</th><th>Constraints</th><th>Invariant</th></tr></thead><tr><td>15</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>14</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>13</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>12</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>11</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>10</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>9</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>8</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>7</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>6</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>5</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>4</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>3</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>2</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>1</td><td><ul><li><pre>not (ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>0</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li></ul></td><td><pre>Unknown</pre></td></tr></table></div></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-71f30151-a98c-4e5a-9850-ed6c65c58632';
  alternatives.hydrate(target);
});
</script></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div id="decompose-102adc45-d947-422e-a581-73bfb84e8427" class="decompose"><textarea class="display-none">{
  &quot;regions&quot;: [
    {
      &quot;constraints&quot;: [
        &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
            &quot;First buy order's order_qty &lt;&gt; First sell order's order_qty&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
              &quot;First buy order's order_qty &lt;&gt; First sell order's order_qty&quot;
            ],
            &quot;invariant&quot;: &quot;F = Unknown&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
            &quot;First buy order's order_qty = First sell order's order_qty&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;Second buy order is Market&quot;, &quot;Second sell order is Market&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;Second sell order is Market&quot;,
                  &quot;Second buy order is Market&quot;, &quot;First buy order is Market&quot;,
                  &quot;First sell order is Market&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known ref_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.5.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;(List.tl ob.sells) = []&quot;, &quot;Second buy order is Market&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.tl ob.sells) = []&quot;, &quot;Second buy order is Market&quot;,
                  &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known ref_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.4.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;(List.tl ob.buys) = []&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;(List.tl ob.buys) = []&quot;, &quot;Second sell order is Market&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;Second sell order is Market&quot;,
                      &quot;(List.tl ob.buys) = []&quot;, &quot;First buy order is Market&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.3.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.tl ob.sells) = []&quot;, &quot;(List.tl ob.buys) = []&quot;,
                      &quot;First buy order is Market&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.3.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;Second sell order isn't Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;Second sell order isn't Market&quot;,
                    &quot;Second buy order is Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;Second buy order is Market&quot;,
                        &quot;ref_price &gt; Second sell order's order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;ref_price &gt; Second sell order's order_price&quot;,
                          &quot;Second sell order isn't Market&quot;,
                          &quot;Second buy order is Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known Second sell order's order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.2.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;Second buy order is Market&quot;,
                        &quot;Second sell order's order_price &gt;= ref_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second sell order's order_price &gt;= ref_price&quot;,
                          &quot;Second sell order isn't Market&quot;,
                          &quot;Second buy order is Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.2.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;Second sell order isn't Market&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;,
                        &quot;ref_price &gt; Second sell order's order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;ref_price &gt; Second sell order's order_price&quot;,
                          &quot;Second sell order isn't Market&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known Second sell order's order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.2.1.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;,
                        &quot;Second sell order's order_price &gt;= ref_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second sell order's order_price &gt;= ref_price&quot;,
                          &quot;Second sell order isn't Market&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.2.1.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 4
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;,
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;Second buy order isn't Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;Second buy order isn't Market&quot;,
                    &quot;ref_price &gt;= Second buy order's order_price&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;ref_price &gt;= Second buy order's order_price&quot;,
                        &quot;Second sell order is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second sell order is Market&quot;,
                          &quot;ref_price &gt;= Second buy order's order_price&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;ref_price &gt;= Second buy order's order_price&quot;,
                        &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.tl ob.sells) = []&quot;,
                          &quot;ref_price &gt;= Second buy order's order_price&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;Second buy order isn't Market&quot;,
                    &quot;Second sell order isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;ref_price &gt; Second sell order's order_price&quot;,
                        &quot;ref_price &gt;= Second buy order's order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;ref_price &gt; Second sell order's order_price&quot;,
                          &quot;Second sell order isn't Market&quot;,
                          &quot;ref_price &gt;= Second buy order's order_price&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known Second sell order's order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.2.2.1&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;Second buy order's order_price &lt;= ref_price &lt;=\nSecond sell order's order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second buy order's order_price &lt;= ref_price &lt;=\nSecond sell order's order_price&quot;,
                          &quot;Second sell order isn't Market&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.2.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;Second buy order isn't Market&quot;,
                    &quot;Second buy order's order_price &gt; ref_price&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second buy order's order_price &gt; ref_price&quot;,
                        &quot;Second sell order isn't Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second sell order isn't Market&quot;,
                          &quot;Second buy order's order_price &gt; ref_price&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known Second buy order's order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second buy order's order_price &gt; ref_price&quot;,
                        &quot;Second sell order is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;Second sell order is Market&quot;,
                          &quot;Second buy order's order_price &gt; ref_price&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known Second buy order's order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second buy order's order_price &gt; ref_price&quot;,
                        &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.tl ob.sells) = []&quot;,
                          &quot;Second buy order's order_price &gt; ref_price&quot;,
                          &quot;Second buy order isn't Market&quot;,
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known Second buy order's order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 3
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 7
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 15
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 16
    }
  ]
}</textarea><div class="decompose-foamtree"></div><div class="decompose-details"><div class="decompose-details-header">Regions details</div><div class="decompose-details-no-selection"><p>No group selected.</p><ul><li>Concrete regions are numbered</li><li>Unnumbered regions are groups whose children share a particular constraint</li><li>Click on a region to view its details</li><li>Double click on a region to zoom in on it</li><li>Shift+double click to zoom out</li><li>Hit escape to reset back to the top</li></ul></div><div class="decompose-details-selection hidden"><div><span class="decompose-details-label">Direct sub-regions: </span><span class="decompose-details-direct-sub-regions-text">-</span></div><div><span class="decompose-details-label">Contained regions: </span><span class="decompose-details-contained-regions-text">-</span></div><div class="decompose-details-section-header">Constraints</div><div class="decompose-details-constraints"><pre class="decompose-details-constraint">&lt;constraint&gt;</pre></div><div class="decompose-details-invariant"><div class="decompose-details-section-header">Invariant</div><pre class="decompose-details-invariant-text">&lt;invariant&gt;</pre></div></div></div><script>
(function () {
  require(['nbextensions/nbimandra/regions'], function (regions) {
    var target = '#decompose-102adc45-d947-422e-a581-73bfb84e8427';
    regions.hydrate(target);
  });
})();
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>All of the newly generated regions now contain the constraints that there's at least a single order on both sides of the book and that both of those orders are <code>Market</code>.</p>
<p>Let us now constrain the behaviour to only that which produces a <code>Known _</code> type of fill price. Notice that now we will constrain the output of <code>match_price</code>. <em>(OCaml-specific note: we use <code>_</code> as a symbolic placeholder to indicate that we're not fixing it to be something specific)</em></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-24" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="c">(* Again, we need to switch back to logic mode so the engine translates the definition into axiomatic representation. *)</span>
<span class="o">#</span><span class="n">logic</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">side_condition2</span> <span class="o">(</span><span class="n">ob</span> <span class="o">:</span> <span class="n">order_book</span><span class="o">)</span> <span class="o">(</span><span class="n">ref_price</span> <span class="o">:</span> <span class="n">real</span><span class="o">)</span> <span class="o">=</span>
 <span class="k">match</span> <span class="n">match_price</span> <span class="n">ob</span> <span class="n">ref_price</span> <span class="k">with</span>
 <span class="o">|</span> <span class="nc">Known</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">true</span>
 <span class="o">|</span> <span class="nc">Unknown</span> <span class="o">-&gt;</span> <span class="bp">false</span>
<span class="o">;;</span>

<span class="o">#</span><span class="n">program</span><span class="o">;;</span>
<span class="nn">Modular_decomp</span><span class="p">.</span><span class="n">top</span> <span class="o">~</span><span class="n">assuming</span><span class="o">:</span><span class="s2">&quot;side_condition2&quot;</span> <span class="s2">&quot;match_price&quot;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val side_condition2 : order_book -&gt; real -&gt; bool = &lt;fun&gt;
- : Top_result.modular_decomposition = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="imandra-alternatives" id="alt-32f28884-9233-45ee-97c2-6a68b8a90b45"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>Voronoi (37 of 37)</a></li><li class="" data-toggle="tab"><a>Table</a></li></ul><div class="tab-content"><div class="tab-pane active"><div id="decompose-b117a0fe-15ed-4d07-b12e-ba0c7811953c" class="decompose"><textarea class="display-none">{
  &quot;regions&quot;: [
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_type is Limit&quot;,
        &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
        &quot;(List.hd ob.sells).order_type is Limit&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
          &quot;(List.hd ob.buys).order_type is Limit&quot;,
          &quot;(List.hd ob.sells).order_type is Limit&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;7.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.sells).order_type is Quote&quot;,
        &quot;(List.hd ob.buys).order_type is Limit&quot;,
        &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;(List.hd ob.buys).order_type is Limit&quot;,
          &quot;(List.hd ob.sells).order_type is Quote&quot;,
          &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;6.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_type is Quote&quot;,
        &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Quote&quot;,
            &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
            &quot;(List.hd ob.sells).order_type is Quote&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
              &quot;(List.hd ob.buys).order_type is Quote&quot;,
              &quot;(List.hd ob.sells).order_type is Quote&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Quote&quot;,
            &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;,
            &quot;(List.hd ob.sells).order_type is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.buys).order_type is Quote&quot;,
              &quot;(List.hd ob.sells).order_type is Limit&quot;,
              &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.1&quot;,
          &quot;weight&quot;: 1
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 2
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
            &quot;(List.hd ob.buys).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.buys).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                &quot;(List.hd ob.sells).order_type is Limit&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_type is Limit&quot;,
                  &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
            &quot;(List.hd ob.buys).order_type is Limit&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Limit&quot;,
                &quot;(List.hd ob.sells).order_type is Limit&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.hd ob.buys).order_type is Limit&quot;,
                  &quot;(List.hd ob.sells).order_type is Limit&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Limit&quot;,
                &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Limit&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 4
    },
    {
      &quot;constraints&quot;: [ &quot;(List.hd ob.sells).order_type is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_type is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.buys).order_type is Limit&quot;,
              &quot;(List.hd ob.sells).order_type is Market&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;3.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;3.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_qty &gt; (List.hd ob.buys).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;3.1.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 3
    },
    {
      &quot;constraints&quot;: [ &quot;(List.hd ob.buys).order_type is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.sells).order_type is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;(List.hd ob.buys).order_type is Market&quot;,
              &quot;(List.hd ob.sells).order_type is Limit&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_type is Market&quot;,
            &quot;(List.hd ob.sells).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_time &gt;= (List.hd ob.buys).order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;2.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;,
                &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_qty &gt; (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;2.1.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 3
    },
    {
      &quot;constraints&quot;: [
        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.hd ob.sells).order_type is Limit&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_type is Limit&quot;,
                    &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_type is Quote&quot;,
                      &quot;(List.hd ob.sells).order_type is Limit&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.tl ob.sells) = []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Quote&quot;,
                    &quot;(List.hd ob.sells).order_type is Limit&quot;,
                    &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_type is Quote&quot;,
                      &quot;(List.hd ob.sells).order_type is Limit&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                    ],
                    &quot;invariant&quot;:
                      &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Limit&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_type is Limit&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.tl ob.buys) = []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                    &quot;(List.hd ob.buys).order_type is Limit&quot;,
                    &quot;(List.hd ob.sells).order_type is Quote&quot;,
                    &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_type is Limit&quot;,
                      &quot;(List.hd ob.sells).order_type is Quote&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                      &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                    ],
                    &quot;invariant&quot;:
                      &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 4
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.sells).order_type is Market&quot;,
            &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
            &quot;(List.hd ob.buys).order_type is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.tl ob.sells) = []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.tl ob.sells) = []&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.buys).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.buys).order_type is Quote&quot;,
                &quot;(List.tl ob.sells) &lt;&gt; []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Quote&quot;,
                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                ],
                &quot;invariant&quot;:
                  &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        },
        {
          &quot;constraints&quot;: [
            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
            &quot;(List.hd ob.buys).order_type is Market&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;,
                &quot;(List.tl ob.buys) &lt;&gt; []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                ],
                &quot;invariant&quot;:
                  &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.3.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.tl ob.buys) = []&quot;,
                &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                &quot;(List.hd ob.sells).order_type is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                  &quot;(List.hd ob.sells).order_type is Quote&quot;,
                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                  &quot;(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time&quot;,
                  &quot;(List.tl ob.buys) = []&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known (List.hd ob.sells).order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.2.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                &quot;(List.hd ob.buys).order_type is Market&quot;,
                &quot;(List.hd ob.sells).order_type is Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_type is Market&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.5.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;(List.hd ob.buys).order_type is Market&quot;,
                      &quot;(List.hd ob.sells).order_type is Market&quot;,
                      &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                      &quot;(List.tl ob.buys) = []&quot;,
                      &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.4.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                        &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                          &quot;(List.tl ob.sells) = []&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;,
                        &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                        ],
                        &quot;invariant&quot;:
                          &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.2.3.1&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                        &quot;(List.tl ob.buys) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;(List.hd ob.buys).order_type is Market&quot;,
                          &quot;(List.hd ob.sells).order_type is Market&quot;,
                          &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                          &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.2.2.1&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                            &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                              &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type is Market&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 4
                },
                {
                  &quot;constraints&quot;: [
                    &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                    &quot;(List.hd ob.buys).order_type is Market&quot;,
                    &quot;(List.hd ob.sells).order_type is Market&quot;,
                    &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.tl ob.sells) = []&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.3&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_price &gt; ref_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known (List.hd (List.tl ob.buys)).order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 3
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                        &quot;(List.hd ob.buys).order_type is Market&quot;,
                        &quot;(List.hd ob.sells).order_type is Market&quot;,
                        &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                        &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.tl ob.sells) = []&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.3&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;(List.hd ob.buys).order_type is Market&quot;,
                              &quot;(List.hd ob.sells).order_type is Market&quot;,
                              &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                              &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                              &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                              &quot;(List.hd (List.tl ob.sells)).order_type is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                            &quot;(List.hd ob.buys).order_type is Market&quot;,
                            &quot;(List.hd ob.sells).order_type is Market&quot;,
                            &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                            &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                            &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                          ],
                          &quot;region&quot;: null,
                          &quot;groups&quot;: [
                            {
                              &quot;constraints&quot;: [
                                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                &quot;(List.hd ob.buys).order_type is Market&quot;,
                                &quot;(List.hd ob.sells).order_type is Market&quot;,
                                &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                                &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;
                              ],
                              &quot;region&quot;: {
                                &quot;constraints&quot;: [
                                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                  &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                  &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                  &quot;ref_price &gt; (List.hd (List.tl ob.sells)).order_price&quot;,
                                  &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                                ],
                                &quot;invariant&quot;:
                                  &quot;F = Known (List.hd (List.tl ob.sells)).order_price&quot;
                              },
                              &quot;groups&quot;: [],
                              &quot;label&quot;: &quot;1.1.1.1.1.1.2&quot;,
                              &quot;weight&quot;: 1
                            },
                            {
                              &quot;constraints&quot;: [
                                &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                &quot;(List.hd ob.buys).order_type is Market&quot;,
                                &quot;(List.hd ob.sells).order_type is Market&quot;,
                                &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;,
                                &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;
                              ],
                              &quot;region&quot;: {
                                &quot;constraints&quot;: [
                                  &quot;(List.hd ob.buys).order_type is Market&quot;,
                                  &quot;(List.hd ob.sells).order_type is Market&quot;,
                                  &quot;(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty&quot;,
                                  &quot;ref_price &gt;= (List.hd (List.tl ob.buys)).order_price&quot;,
                                  &quot;(List.hd (List.tl ob.buys)).order_type isn't Market&quot;,
                                  &quot;(List.hd (List.tl ob.sells)).order_price &gt;= ref_price&quot;,
                                  &quot;(List.hd (List.tl ob.sells)).order_type isn't Market&quot;
                                ],
                                &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                              },
                              &quot;groups&quot;: [],
                              &quot;label&quot;: &quot;1.1.1.1.1.1.1&quot;,
                              &quot;weight&quot;: 1
                            }
                          ],
                          &quot;label&quot;: &quot;&quot;,
                          &quot;weight&quot;: 2
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 4
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 7
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 15
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 17
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 23
    }
  ]
}</textarea><div class="decompose-foamtree"></div><div class="decompose-details"><div class="decompose-details-header">Regions details</div><div class="decompose-details-no-selection"><p>No group selected.</p><ul><li>Concrete regions are numbered</li><li>Unnumbered regions are groups whose children share a particular constraint</li><li>Click on a region to view its details</li><li>Double click on a region to zoom in on it</li><li>Shift+double click to zoom out</li><li>Hit escape to reset back to the top</li></ul></div><div class="decompose-details-selection hidden"><div><span class="decompose-details-label">Direct sub-regions: </span><span class="decompose-details-direct-sub-regions-text">-</span></div><div><span class="decompose-details-label">Contained regions: </span><span class="decompose-details-contained-regions-text">-</span></div><div class="decompose-details-section-header">Constraints</div><div class="decompose-details-constraints"><pre class="decompose-details-constraint">&lt;constraint&gt;</pre></div><div class="decompose-details-invariant"><div class="decompose-details-section-header">Invariant</div><pre class="decompose-details-invariant-text">&lt;invariant&gt;</pre></div></div></div><script>
(function () {
  require(['nbextensions/nbimandra/regions'], function (regions) {
    var target = '#decompose-b117a0fe-15ed-4d07-b12e-ba0c7811953c';
    regions.hydrate(target);
  });
})();
</script></div></div><div class="tab-pane"><div><div>decomp of (match_price ob, ref_price<div class="imandra-table" id="table-b2806804-d285-4642-b5a0-cf3790942278"><table><thead><tr><th>Reg_id</th><th>Constraints</th><th>Invariant</th></tr></thead><tr><td>36</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>35</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>34</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>33</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>(List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>32</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>31</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>30</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>29</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>28</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>27</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>26</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>25</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>24</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>23</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>22</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_price &gt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>21</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_price &gt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.buys)).order_type = Market)</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>20</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>19</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_price &lt;. ref_price)</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>18</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_price &lt;. ref_price</pre></li><li><pre>not ((List.hd (List.tl ob.sells)).order_type = Market)</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>17</td><td><ul><li><pre>(List.hd ob.buys).order_type = Market</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd (List.tl ob.buys)).order_type = Market</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li><li><pre>(List.hd (List.tl ob.sells)).order_type = Market</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known ref_price</pre></td></tr><tr><td>16</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>15</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>14</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>13</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>12</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>11</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>not (List.tl ob.sells = [])</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.sells)).order_price</pre></td></tr><tr><td>10</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>List.tl ob.sells = []</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (ob.sells = [])</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>9</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>not ((List.hd ob.sells).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_qty &lt; (List.hd ob.sells).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>8</td><td><ul><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>7</td><td><ul><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.buys).order_type = Quote</pre></li><li><pre>not ((List.hd ob.buys).order_type = Limit)</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>6</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>5</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>not (List.tl ob.buys = [])</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li></ul></td><td><pre>Known (List.hd (List.tl ob.buys)).order_price</pre></td></tr><tr><td>4</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>(List.hd ob.buys).order_qty = (List.hd ob.sells).order_qty</pre></li><li><pre>not ((List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty)</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li><li><pre>List.tl ob.buys = []</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>not (ob.buys = [])</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr><tr><td>3</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Quote</pre></li><li><pre>not ((List.hd ob.sells).order_type = Market)</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>(List.hd ob.sells).order_qty &lt; (List.hd ob.buys).order_qty</pre></li><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>2</td><td><ul><li><pre>not ((List.hd ob.buys).order_type = Market)</pre></li><li><pre>not ((List.hd ob.buys).order_type = Quote)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Market</pre></li><li><pre>not ((List.hd ob.sells).order_type = Limit)</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>1</td><td><ul><li><pre>not ((List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time)</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.buys).order_price</pre></td></tr><tr><td>0</td><td><ul><li><pre>(List.hd ob.buys).order_time &gt; (List.hd ob.sells).order_time</pre></li><li><pre>(List.hd ob.buys).order_type = Limit</pre></li><li><pre>ob.buys &lt;&gt; []</pre></li><li><pre>(List.hd ob.sells).order_type = Limit</pre></li><li><pre>ob.sells &lt;&gt; []</pre></li></ul></td><td><pre>Known (List.hd ob.sells).order_price</pre></td></tr></table></div></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-32f28884-9233-45ee-97c2-6a68b8a90b45';
  alternatives.hydrate(target);
});
</script></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div id="decompose-498c75c2-9316-45f1-aa33-a0950f4460bc" class="decompose"><textarea class="display-none">{
  &quot;regions&quot;: [
    {
      &quot;constraints&quot;: [
        &quot;First buy order is Limit&quot;, &quot;First sell order is Limit&quot;,
        &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
          &quot;First buy order is Limit&quot;, &quot;First sell order is Limit&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;7.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;First sell order is Quote&quot;, &quot;First buy order is Limit&quot;,
        &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
      ],
      &quot;region&quot;: {
        &quot;constraints&quot;: [
          &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
          &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
        ],
        &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
      },
      &quot;groups&quot;: [],
      &quot;label&quot;: &quot;6.1.1&quot;,
      &quot;weight&quot;: 1
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order is Quote&quot;,
        &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Quote&quot;,
            &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
            &quot;First sell order is Quote&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
              &quot;First buy order is Quote&quot;, &quot;First sell order is Quote&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Quote&quot;,
            &quot;First sell order's order_time &gt;= First buy order's order_time&quot;,
            &quot;First sell order is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
              &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;5.1&quot;,
          &quot;weight&quot;: 1
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 2
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order's order_time &gt; First sell order's order_time&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
            &quot;First buy order is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Quote&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First buy order is Quote&quot;, &quot;First sell order is Quote&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                  &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
            &quot;First buy order is Limit&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Limit&quot;, &quot;First sell order is Limit&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;First buy order is Limit&quot;, &quot;First sell order is Limit&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Limit&quot;,
                &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                  &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;4.1.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 4
    },
    {
      &quot;constraints&quot;: [ &quot;First sell order is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First sell order is Market&quot;, &quot;First buy order is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First buy order is Limit&quot;, &quot;First sell order is Market&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;3.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Quote&quot;, &quot;First sell order is Market&quot;,
                  &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;3.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Quote&quot;, &quot;First sell order is Market&quot;,
                  &quot;First sell order's order_qty &gt; First buy order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;3.1.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 3
    },
    {
      &quot;constraints&quot;: [ &quot;First buy order is Market&quot; ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;, &quot;First sell order is Limit&quot;
          ],
          &quot;region&quot;: {
            &quot;constraints&quot;: [
              &quot;First buy order is Market&quot;, &quot;First sell order is Limit&quot;
            ],
            &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
          },
          &quot;groups&quot;: [],
          &quot;label&quot;: &quot;2.2&quot;,
          &quot;weight&quot;: 1
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                  &quot;First sell order's order_time &gt;= First buy order's order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;2.1.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                  &quot;First buy order's order_qty &gt; First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;2.1.1.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 3
    },
    {
      &quot;constraints&quot;: [
        &quot;First buy order's order_qty = First sell order's order_qty&quot;
      ],
      &quot;region&quot;: null,
      &quot;groups&quot;: [
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                    &quot;(List.tl ob.sells) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order is Quote&quot;,
                      &quot;First sell order is Limit&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;(List.tl ob.sells) = []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Quote&quot;, &quot;First sell order is Limit&quot;,
                    &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order is Quote&quot;,
                      &quot;First sell order is Limit&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known Second sell order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                    &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order is Limit&quot;,
                      &quot;First sell order is Quote&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;(List.tl ob.buys) = []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.2&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                    &quot;First buy order is Limit&quot;, &quot;First sell order is Quote&quot;,
                    &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order is Limit&quot;,
                      &quot;First sell order is Quote&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                      &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known Second buy order's order_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1&quot;,
                  &quot;weight&quot;: 1
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 2
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 4
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
            &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
            &quot;First buy order's order_time &gt; First sell order's order_time&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;(List.tl ob.sells) = []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Quote&quot;, &quot;First sell order is Market&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;(List.tl ob.sells) = []&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.2&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First sell order is Market&quot;, &quot;First buy order is Quote&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;(List.tl ob.sells) &lt;&gt; []&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Quote&quot;, &quot;First sell order is Market&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;(List.tl ob.sells) &lt;&gt; []&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known Second sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.2.1&quot;,
              &quot;weight&quot;: 1
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 2
        },
        {
          &quot;constraints&quot;: [
            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
            &quot;First buy order is Market&quot;
          ],
          &quot;region&quot;: null,
          &quot;groups&quot;: [
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order is Market&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;(List.tl ob.buys) &lt;&gt; []&quot;, &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;(List.tl ob.buys) &lt;&gt; []&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known Second buy order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.3.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order is Market&quot;, &quot;(List.tl ob.buys) = []&quot;,
                &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                &quot;First sell order is Quote&quot;
              ],
              &quot;region&quot;: {
                &quot;constraints&quot;: [
                  &quot;First buy order is Market&quot;, &quot;First sell order is Quote&quot;,
                  &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                  &quot;First buy order's order_time &gt; First sell order's order_time&quot;,
                  &quot;(List.tl ob.buys) = []&quot;
                ],
                &quot;invariant&quot;: &quot;F = Known First sell order's order_price&quot;
              },
              &quot;groups&quot;: [],
              &quot;label&quot;: &quot;1.1.2.1.1&quot;,
              &quot;weight&quot;: 1
            },
            {
              &quot;constraints&quot;: [
                &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                &quot;First buy order is Market&quot;, &quot;First sell order is Market&quot;
              ],
              &quot;region&quot;: null,
              &quot;groups&quot;: [
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;Second buy order is Market&quot;,
                    &quot;Second sell order is Market&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order is Market&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;Second buy order is Market&quot;,
                      &quot;Second sell order is Market&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.5.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;, &quot;(List.tl ob.sells) = []&quot;,
                    &quot;Second buy order is Market&quot;
                  ],
                  &quot;region&quot;: {
                    &quot;constraints&quot;: [
                      &quot;First buy order is Market&quot;,
                      &quot;First sell order is Market&quot;,
                      &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                      &quot;Second buy order is Market&quot;, &quot;(List.tl ob.sells) = []&quot;
                    ],
                    &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                  },
                  &quot;groups&quot;: [],
                  &quot;label&quot;: &quot;1.1.1.4.1&quot;,
                  &quot;weight&quot;: 1
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;, &quot;(List.tl ob.buys) = []&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;,
                        &quot;Second sell order is Market&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                          &quot;(List.tl ob.buys) = []&quot;,
                          &quot;Second sell order is Market&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.2&quot;,
                      &quot;weight&quot;: 1
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                      ],
                      &quot;region&quot;: {
                        &quot;constraints&quot;: [
                          &quot;First buy order is Market&quot;,
                          &quot;First sell order is Market&quot;,
                          &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                          &quot;(List.tl ob.buys) = []&quot;, &quot;(List.tl ob.sells) = []&quot;
                        ],
                        &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                      },
                      &quot;groups&quot;: [],
                      &quot;label&quot;: &quot;1.1.1.3.1&quot;,
                      &quot;weight&quot;: 1
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 2
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;Second sell order isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;Second buy order is Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;Second buy order is Market&quot;,
                            &quot;ref_price &gt; Second sell order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;Second buy order is Market&quot;,
                              &quot;ref_price &gt; Second sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second sell order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;Second buy order is Market&quot;,
                            &quot;Second sell order's order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;Second buy order is Market&quot;,
                              &quot;Second sell order's order_price &gt;= ref_price&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second sell order isn't Market&quot;,
                        &quot;(List.tl ob.buys) = []&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;(List.tl ob.buys) = []&quot;,
                            &quot;ref_price &gt; Second sell order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;(List.tl ob.buys) = []&quot;,
                              &quot;ref_price &gt; Second sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second sell order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;(List.tl ob.buys) = []&quot;,
                            &quot;Second sell order's order_price &gt;= ref_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;(List.tl ob.buys) = []&quot;,
                              &quot;Second sell order's order_price &gt;= ref_price&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.2.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 4
                },
                {
                  &quot;constraints&quot;: [
                    &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                    &quot;First buy order is Market&quot;,
                    &quot;First sell order is Market&quot;,
                    &quot;Second buy order isn't Market&quot;
                  ],
                  &quot;region&quot;: null,
                  &quot;groups&quot;: [
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;ref_price &gt;= Second buy order's order_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;ref_price &gt;= Second buy order's order_price&quot;,
                            &quot;Second sell order is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;ref_price &gt;= Second buy order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;Second sell order is Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;ref_price &gt;= Second buy order's order_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;ref_price &gt;= Second buy order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;(List.tl ob.sells) = []&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second sell order isn't Market&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;ref_price &gt; Second sell order's order_price&quot;,
                            &quot;ref_price &gt;= Second buy order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;ref_price &gt;= Second buy order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;ref_price &gt; Second sell order's order_price&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second sell order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2.2.1&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second sell order isn't Market&quot;,
                            &quot;Second buy order's order_price &lt;= ref_price &lt;=\nSecond sell order's order_price&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;Second buy order's order_price &lt;= ref_price &lt;=\nSecond sell order's order_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;: &quot;F = Known ref_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.2.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 2
                    },
                    {
                      &quot;constraints&quot;: [
                        &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                        &quot;First buy order is Market&quot;,
                        &quot;First sell order is Market&quot;,
                        &quot;Second buy order isn't Market&quot;,
                        &quot;Second buy order's order_price &gt; ref_price&quot;
                      ],
                      &quot;region&quot;: null,
                      &quot;groups&quot;: [
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second buy order's order_price &gt; ref_price&quot;,
                            &quot;Second sell order isn't Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;Second buy order's order_price &gt; ref_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;Second sell order isn't Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second buy order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.3&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second buy order's order_price &gt; ref_price&quot;,
                            &quot;Second sell order is Market&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;Second buy order's order_price &gt; ref_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;Second sell order is Market&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second buy order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.2&quot;,
                          &quot;weight&quot;: 1
                        },
                        {
                          &quot;constraints&quot;: [
                            &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                            &quot;First buy order is Market&quot;,
                            &quot;First sell order is Market&quot;,
                            &quot;Second buy order isn't Market&quot;,
                            &quot;Second buy order's order_price &gt; ref_price&quot;,
                            &quot;(List.tl ob.sells) = []&quot;
                          ],
                          &quot;region&quot;: {
                            &quot;constraints&quot;: [
                              &quot;First buy order is Market&quot;,
                              &quot;First sell order is Market&quot;,
                              &quot;First buy order's order_qty = First sell order's order_qty&quot;,
                              &quot;Second buy order's order_price &gt; ref_price&quot;,
                              &quot;Second buy order isn't Market&quot;,
                              &quot;(List.tl ob.sells) = []&quot;
                            ],
                            &quot;invariant&quot;:
                              &quot;F = Known Second buy order's order_price&quot;
                          },
                          &quot;groups&quot;: [],
                          &quot;label&quot;: &quot;1.1.1.1.1.1&quot;,
                          &quot;weight&quot;: 1
                        }
                      ],
                      &quot;label&quot;: &quot;&quot;,
                      &quot;weight&quot;: 3
                    }
                  ],
                  &quot;label&quot;: &quot;&quot;,
                  &quot;weight&quot;: 7
                }
              ],
              &quot;label&quot;: &quot;&quot;,
              &quot;weight&quot;: 15
            }
          ],
          &quot;label&quot;: &quot;&quot;,
          &quot;weight&quot;: 17
        }
      ],
      &quot;label&quot;: &quot;&quot;,
      &quot;weight&quot;: 23
    }
  ]
}</textarea><div class="decompose-foamtree"></div><div class="decompose-details"><div class="decompose-details-header">Regions details</div><div class="decompose-details-no-selection"><p>No group selected.</p><ul><li>Concrete regions are numbered</li><li>Unnumbered regions are groups whose children share a particular constraint</li><li>Click on a region to view its details</li><li>Double click on a region to zoom in on it</li><li>Shift+double click to zoom out</li><li>Hit escape to reset back to the top</li></ul></div><div class="decompose-details-selection hidden"><div><span class="decompose-details-label">Direct sub-regions: </span><span class="decompose-details-direct-sub-regions-text">-</span></div><div><span class="decompose-details-label">Contained regions: </span><span class="decompose-details-contained-regions-text">-</span></div><div class="decompose-details-section-header">Constraints</div><div class="decompose-details-constraints"><pre class="decompose-details-constraint">&lt;constraint&gt;</pre></div><div class="decompose-details-invariant"><div class="decompose-details-section-header">Invariant</div><pre class="decompose-details-invariant-text">&lt;invariant&gt;</pre></div></div></div><script>
(function () {
  require(['nbextensions/nbimandra/regions'], function (regions) {
    var target = '#decompose-498c75c2-9316-45f1-aa33-a0950f4460bc';
    regions.hydrate(target);
  });
})();
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Generating-instances">Generating instances<a class="anchor-link" href="#Generating-instances">&#182;</a></h2><p>In our last step, we'll ask Imandra to synthesize concrete examples for each of the regions it generates. We'll generate just one for each region, but the interface is generic so you can request as many as you'd like. Moreover, since these values are valid OCaml (or ReasonML), you can directly compute with them or convert into whatever format you'd like (e.g. as FIX messages).</p>
<p>The first step will create a new module for us which we'll use in the second step to query for sample points.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-26" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="c">(* Generate a model extractor module for `match_price` *)</span>

<span class="nn">Extract</span><span class="p">.</span><span class="n">eval</span> <span class="o">~</span><span class="n">signature</span><span class="o">:(</span><span class="nn">Event</span><span class="p">.</span><span class="nn">DB</span><span class="p">.</span><span class="n">fun_id_of_str</span> <span class="s2">&quot;match_price&quot;</span><span class="o">)</span> <span class="bp">()</span><span class="o">;;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>module Mex :
  sig
    val get_option : (Term.term -&gt; &#39;a_0) -&gt; Term.term -&gt; &#39;a_0 option
    val get_nativeint : Term.term -&gt; nativeint
    val get_Peano_nat_t : Term.term -&gt; Peano_nat.t
    val get_unit : Term.term -&gt; unit
    val get_result :
      (Term.term -&gt; &#39;a_0) -&gt;
      (Term.term -&gt; &#39;a_1) -&gt; Term.term -&gt; (&#39;a_0, &#39;a_1) result
    val get_Result_t :
      (Term.term -&gt; &#39;a_0) -&gt;
      (Term.term -&gt; &#39;a_1) -&gt; Term.term -&gt; (&#39;a_0, &#39;a_1) result
    val get_either :
      (Term.term -&gt; &#39;a_0) -&gt;
      (Term.term -&gt; &#39;a_1) -&gt; Term.term -&gt; (&#39;a_0, &#39;a_1) either
    val get_List_t : (Term.term -&gt; &#39;a_0) -&gt; Term.term -&gt; &#39;a_0 list
    val get_Int_t : Term.term -&gt; int
    val get_Bool_t : Term.term -&gt; bool
    val get_Option_t : (Term.term -&gt; &#39;a_0) -&gt; Term.term -&gt; &#39;a_0 option
    val get_Real_t : Term.term -&gt; real
    val get_Map_t :
      (Term.term -&gt; &#39;a_0) -&gt;
      (Term.term -&gt; &#39;a_1) -&gt; Term.term -&gt; (&#39;a_0, &#39;a_1) Map.t
    val get_Multiset_t : (Term.term -&gt; &#39;a_0) -&gt; Term.term -&gt; &#39;a_0 Multiset.t
    val get_Set_t : (Term.term -&gt; &#39;a_0) -&gt; Term.term -&gt; &#39;a_0 Set.t
    val get_String_t : Term.term -&gt; string
    val get_Float_t : Term.term -&gt; float
    val get_Reflect_Uid_t : Term.term -&gt; Reflect.Uid.t
    val get_Reflect_Type_t : Term.term -&gt; Reflect.Type.t
    val get_Reflect_Var_t : Term.term -&gt; Reflect.Var.t
    val get_Reflect_Term_const : Term.term -&gt; Reflect.Term.const
    val get_Reflect_Term_binding :
      (Term.term -&gt; &#39;a_0) -&gt; Term.term -&gt; &#39;a_0 Reflect.Term.binding
    val get_Reflect_Term_t : Term.term -&gt; Reflect.Term.t
    val get_order_type : Term.term -&gt; order_type
    val get_order : Term.term -&gt; order
    val get_fill_price : Term.term -&gt; fill_price
    val get_order_book : Term.term -&gt; order_book
    type extract_type = { ob : order_book; ref_price : real; }
    val of_model : ?signature:string -&gt; Top_result.term_model -&gt; extract_type
  end
- : unit = ()
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Region%20Decomposition%20-%20Exchange%20Pricing.ipynb%23try-cell-27" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="c">(* Let&#39;s now extract test cases from each region *)</span>

<span class="nn">Modular_decomposition</span><span class="p">.</span><span class="n">to_region_list</span> <span class="n">d</span>
<span class="o">|&gt;</span> <span class="nn">CCList</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="o">_)</span> <span class="o">-&gt;</span> <span class="nn">Modular_decomp</span><span class="p">.</span><span class="n">get_region</span> <span class="n">d</span> <span class="n">i</span> <span class="o">|&gt;</span> <span class="nn">Modular_decomp</span><span class="p">.</span><span class="n">get_model</span> <span class="o">|&gt;</span> <span class="nn">Mex</span><span class="p">.</span><span class="n">of_model</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Mex.extract_type list =
[{Mex.ob =
   {buys =
     [{order_id = 1; order_type = Limit; order_qty = 2; order_price = 0;
       order_time = 0}];
    sells =
     [{order_id = 3; order_type = Limit; order_qty = 4; order_price = 1;
       order_time = 38}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Limit; order_qty = 3; order_price = 0;
       order_time = 1}];
    sells =
     [{order_id = 4; order_type = Limit; order_qty = 5; order_price = 1;
       order_time = 0}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 3; order_type = Limit; order_qty = 4; order_price = 1;
       order_time = 5}];
    sells =
     [{order_id = 0; order_type = Market; order_qty = 1; order_price = 0;
       order_time = 2}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 3; order_type = Limit; order_qty = 0; order_price = 1;
       order_time = 21239}];
    sells =
     [{order_id = 2; order_type = Quote; order_qty = -1; order_price = 0;
       order_time = 21238}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Limit; order_qty = 0; order_price = 1;
       order_time = 7719}];
    sells =
     [{order_id = 1; order_type = Quote; order_qty = 0; order_price = 0;
       order_time = 7718}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Limit; order_qty = 0; order_price = 1;
       order_time = 7719};
      {order_id = 6; order_type = Market; order_qty = 7; order_price = 2;
       order_time = 8}];
    sells =
     [{order_id = 1; order_type = Quote; order_qty = 0; order_price = 0;
       order_time = 7718}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 3; order_type = Limit; order_qty = 0; order_price = 1;
       order_time = 23676}];
    sells =
     [{order_id = 2; order_type = Quote; order_qty = 1; order_price = 0;
       order_time = 23675}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 1; order_type = Limit; order_qty = 2; order_price = 0;
       order_time = 0}];
    sells =
     [{order_id = 3; order_type = Quote; order_qty = 4; order_price = 1;
       order_time = 38}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 1; order_type = Quote; order_qty = 2; order_price = 0;
       order_time = 0}];
    sells =
     [{order_id = 3; order_type = Quote; order_qty = 4; order_price = 1;
       order_time = 38}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Quote; order_qty = 3; order_price = 0;
       order_time = 1}];
    sells =
     [{order_id = 4; order_type = Quote; order_qty = 5; order_price = 1;
       order_time = 0}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 3; order_type = Quote; order_qty = 0; order_price = 1;
       order_time = 23676}];
    sells =
     [{order_id = 2; order_type = Limit; order_qty = 1; order_price = 0;
       order_time = 23675}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Quote; order_qty = 0; order_price = 1;
       order_time = 7719}];
    sells =
     [{order_id = 1; order_type = Limit; order_qty = 0; order_price = 0;
       order_time = 7718}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Quote; order_qty = 0; order_price = 1;
       order_time = 7719}];
    sells =
     [{order_id = 1; order_type = Limit; order_qty = 0; order_price = 0;
       order_time = 7718};
      {order_id = 6; order_type = Market; order_qty = 7; order_price = 2;
       order_time = 8}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 3; order_type = Quote; order_qty = 0; order_price = 1;
       order_time = 21239}];
    sells =
     [{order_id = 2; order_type = Limit; order_qty = -1; order_price = 0;
       order_time = 21238}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 1; order_type = Quote; order_qty = 2; order_price = 0;
       order_time = 0}];
    sells =
     [{order_id = 3; order_type = Limit; order_qty = 4; order_price = 1;
       order_time = 38}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 3; order_type = Quote; order_qty = 0; order_price = 1;
       order_time = 23676}];
    sells =
     [{order_id = 2; order_type = Market; order_qty = 1; order_price = 0;
       order_time = 23675}]};
  ref_price = 0};
 {Mex.ob =
   {buys =
     [{order_id = 2; order_type = Quote; order_qty = 0; order_price = 1;
       order_time = 7719}];
    sells =
     [{order_id = 1; order_type = Market; order_qty = 0; order_price = ...;
       order_time = ...};
      ...]};
  ref_price = ...};
 ...]
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If you have any questions, please don't hestitate to reach out to us via <a href="mailto:contact@imandra.ai">email</a> or on our <a href="https://discord.gg/rf78N7h">Discord server</a>.</p>
</div>
</div>
</div>
                    </div>
                </article>
            </main>
            <footer class="footer">
                <a class="copyrights"href="http://imandra.ai">&#9400; 2018 - 2020 Imandra Inc. All rights reserved.</a>
            </footer>
        </div>
    



    <script>
    (function () {
            var lastId;
            var sideMenu = $("#side-nav-menu");
            var topMenu = $("#top-menu");
            var topMenuHeight = topMenu.outerHeight() + 15;

            // All list items
            var menuItems = sideMenu.find('a.side__nav-link--within-page');

            // Anchors corresponding to menu items
            var scrollItems = menuItems.map(function () {
              var item = $(this).attr("href");
              var thisItem = item.substring(item.lastIndexOf("#") + 1, item.length);
              var linkedItem = $('#' + CSS.escape(thisItem));
              if (linkedItem.length) { return linkedItem; }
            });

            // Bind to scroll
            $(window).scroll(function () {
                // Get container scroll position
                var fromTop = $(this).scrollTop() + topMenuHeight;;
                // Get id of current scroll item
                var cur = scrollItems.map(function () {
                    if ($(this).offset().top < fromTop)
                        return this;
                });
                cur = cur[cur.length - 1];
                // Get the id of the current element
                var id = cur && cur.length ? cur[0].id : "";
                if (id && lastId !== id) {
                    lastId = id;
                    // Set/remove active class
                    menuItems.each(function (idx, item) {
                    var $item = $(item);
                    $item.removeClass("side__nav-link--within-page--active");

                    if (item.href.endsWith('#' + lastId)) {
                        $item.addClass("side__nav-link--within-page--active");
                    };
                    });
                }
            });
        })()
    </script>
    <script type="text/javascript"> docsearch({
      apiKey: 'ff3a61a82b58783e62ebfbf51e50b0bc',
      indexName: 'imandra',
      inputSelector: '#search',
      debug: false // Set debug to true if you want to inspect the dropdown
    });
    </script>

    </body>
</html>
