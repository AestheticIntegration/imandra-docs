<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>Imandra Documentation - Proving Program Termination with Imandra</title>
<meta property="og:url" content="https://docs.imandra.ai/imandra-docs/notebooks/proving-program-termination/">
<meta property="og:type" content="website">
<meta property="og:title" content="Imandra Documentation - Proving Program Termination with Imandra">
<meta property="og:description" content="In this notebook, we'll walk through how Imandra can be used to analyse program termination. Along the way, we'll learn about soundness, conservative extensions, the Halting Problem, ordinals and well-founded orderings, path-guarded call-graphs, measure conjectures and more.">
<meta property="og:image" content="https://storage.googleapis.com/imandra-assets/images/og_image_default_i78.jpg">


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116937440-6"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-116937440-6');
</script>
<script type="text/javascript"> var sc_project=11767520; var sc_invisible=1; var sc_security="fa7e88d1"; </script>
<script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter">
<a title="Web Analytics" href="http://statcounter.com/" target="_blank">
<img class="statcounter" src="//c.statcounter.com/11767520/0/fa7e88d1/1/" alt="Web Analytics"></a>
</div></noscript>


<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather" type="text/css" />

<link rel="stylesheet" href="/imandra-docs/static/style/style.min.910c246e.css" type="text/css">
<link rel="stylesheet" href="/imandra-docs/static/custom/custom.43522872.css" type="text/css">
<link rel="stylesheet" href="/imandra-docs/static/nbextensions/nbimandra/styles.c7ed3d1a.css" type="text/css">
<link rel="stylesheet" href="/imandra-docs/static/docs-styles.fc825a73.css" type="text/css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/imandra-docs/static/nbimandra-rjs-bundle.2469bcb7.js"></script>

<style type="text/css">
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
    
<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div class="header-nav">
    <a href="/imandra-docs/">&lt; Back</a>
  </div>
  <div class="bg-container">
    <div class="bg-container__bg"></div>
    <div class="container">
      <header class="header">
        <a href="/imandra-docs/">
          <img src="/imandra-docs/static/img/site_specific_image_v_2.svg">
        </a>
      </header>
      <div class="content content--with-cells">
  
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Proving-Program-Termination">Proving Program Termination<a class="anchor-link" href="#Proving-Program-Termination">&#182;</a></h1><p>In this notebook, we'll walk through how Imandra can be used to analyse program termination. Along the way, we'll learn about soundness, conservative extensions, the Halting Problem, ordinals (up to $\epsilon_0$!) and well-founded orderings, path-guarded call-graphs, measure conjectures and more.</p>
<p>Before we dive into discussing (relatively deep!) aspects of mathematical logic, let's begin with a simple example. What happens when we try to define a non-terminating recursive function in Imandra?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-2" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val f : &#39;a -&gt; Z.t = &lt;fun&gt;
File &#34;jupyter cell 1&#34;, line 1, characters 0-21:
<span class="ansi-red-intense-fg ansi-bold">Error</span>: Validate: no measure provided, and Imandra cannot guess any.
Are you sure this function is actually terminating?
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, Imandra rejects this definition of <code>f</code> given above. Contrast this with a definition of a function like <code>map</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-4" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">map</span> <span class="n">f</span> <span class="n">xs</span> <span class="o">=</span> <span class="k">match</span> <span class="n">xs</span> <span class="k">with</span>
 <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
 <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">x</span> <span class="o">::</span> <span class="n">map</span> <span class="n">f</span> <span class="n">xs</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val map : (&#39;a -&gt; &#39;b) -&gt; &#39;a list -&gt; &#39;b list = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-9efae985-bc18-47bf-b6ba-c7c082371174"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-837fa953-6abe-4307-8a55-169f8f9b560e"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `map f_0 (List.tl xs)` from `map f_0 xs`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-ae5c289a-a722-4c2b-aa3e-c34e8dec2e42"><table><tr><td><b>original</b></td><td>map f_0 xs</td></tr><tr><td><b>sub</b></td><td>map f_0 (List.tl xs)</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count xs)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (List.tl xs))</td></tr><tr><td><b>path</b></td><td>[not (xs = [])]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-7b4d53fc-9243-4d9c-8a8a-6347c02f7131"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-e60e2d4a-4829-43aa-9d96-c99477cd5ac5"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-f0dd6aa8-41b3-4302-b8e8-3118b7824b0f"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.020s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-06fb92b0-33e6-459c-8580-d7a907c56042"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-b8bd7021-d92b-4848-b8a6-ff1cdeef5f8f"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-75d2ae59-a32b-4067-b21e-fb001fcea48b"><table><tr><td><b>num checks</b></td><td>7</td></tr><tr><td><b>arith assert lower</b></td><td>7</td></tr><tr><td><b>arith pivots</b></td><td>5</td></tr><tr><td><b>rlimit count</b></td><td>1908</td></tr><tr><td><b>mk clause</b></td><td>3</td></tr><tr><td><b>datatype occurs check</b></td><td>43</td></tr><tr><td><b>mk bool var</b></td><td>54</td></tr><tr><td><b>arith assert upper</b></td><td>5</td></tr><tr><td><b>datatype splits</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>7</td></tr><tr><td><b>arith add rows</b></td><td>15</td></tr><tr><td><b>propagations</b></td><td>2</td></tr><tr><td><b>conflicts</b></td><td>7</td></tr><tr><td><b>arith fixed eqs</b></td><td>5</td></tr><tr><td><b>datatype accessor ax</b></td><td>5</td></tr><tr><td><b>arith conflicts</b></td><td>1</td></tr><tr><td><b>datatype constructor ax</b></td><td>8</td></tr><tr><td><b>num allocs</b></td><td>1302075769</td></tr><tr><td><b>final checks</b></td><td>6</td></tr><tr><td><b>added eqs</b></td><td>34</td></tr><tr><td><b>del clause</b></td><td>1</td></tr><tr><td><b>arith eq adapter</b></td><td>4</td></tr><tr><td><b>memory</b></td><td>6.010000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-06fb92b0-33e6-459c-8580-d7a907c56042';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-a014df92-b35f-40f0-80cc-bcb4108bb40b"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.020s]
  not (xs = []) &amp;&amp; Ordinal.count xs &gt;= 0 &amp;&amp; Ordinal.count (List.tl xs) &gt;= 0
  ==&gt; List.tl xs = []
      || Ordinal.Int (Ordinal.count (List.tl xs)) Ordinal.&lt;&lt;
         Ordinal.Int (Ordinal.count xs)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-1f7f824f-43d3-4443-bdd9-5f15c94b4099"><table><tr><td><b>into</b></td><td><pre>(not
 ((not (xs = []) &amp;&amp; Ordinal.count xs &gt;= 0) &amp;&amp; Ordinal.count (List.tl xs) &gt;= 0)
 || List.tl xs = [])
|| Ordinal.Int (Ordinal.count (List.tl xs)) Ordinal.&lt;&lt;
   Ordinal.Int (Ordinal.count xs)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-0b906117-5660-40ff-9e34-1b0c08319767"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (|count_`ty_1 list`_2336|
                                   (|get.…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-5981a804-ff53-4e36-8ad2-3120c865d43e"><table><tr><td><b>expr</b></td><td><pre>(|count_`ty_1 list`_2336| (|get.::.1_2323| xs_2331))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-38863246-7a89-40c5-9e93-f31d29373b52"><table><tr><td><b>expr</b></td><td><pre>(|count_`ty_1 list`_2336| xs_2331)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (ite (&gt;= (|count_`ty_1 list`_2336| (|get.::.1_2323| xs_2331)) 0)
                (|count_…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-a014df92-b35f-40f0-80cc-bcb4108bb40b';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-e60e2d4a-4829-43aa-9d96-c99477cd5ac5';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-7b4d53fc-9243-4d9c-8a8a-6347c02f7131';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-837fa953-6abe-4307-8a55-169f8f9b560e';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-9efae985-bc18-47bf-b6ba-c7c082371174';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Imandra accepts our function <code>map</code> and proves it terminating. Under the hood, Imandra uses <a href="https://en.wikipedia.org/wiki/Ordinal_number">ordinals</a> in its termination analyses, beautiful mathematical objects representing equivalence classes of well-orderings. We'll discuss these more below!</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Omega-exp-omega-labeled.svg/650px-Omega-exp-omega-labeled.svg.png" alt="ordinals" style="width: 300px;"/></p>
<p>Before we do so, let's return to that function <code>f</code> that Imandra rejected.</p>
<h2 id="Inconsistent-non-terminating-functions">Inconsistent non-terminating functions<a class="anchor-link" href="#Inconsistent-non-terminating-functions">&#182;</a></h2><p>Imagine if Imandra allowed every possible recursive function to be admitted into its logic, even those that didn't terminate. If that were the case, we could easily define the following function:</p>
<p><code>let rec f x = f x + 1</code> (note the binding strength of <code>f</code>, i.e., this is equivalent to <code>let rec f x = (f x) + 1</code>)</p>
<p>With this function admitted, we could then use its defining equation <code>f x = f x + 1</code> to derive a contradiction, e.g., by subtracting <code>f x</code> from both sides to derive <code>0 = 1</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">f</span> <span class="n">x</span>       <span class="o">=</span> <span class="n">f</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">f</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f</span> <span class="n">x</span>  
<span class="mi">0</span>         <span class="o">=</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This inconsistency arises because, actually, such a function <code>f</code> cannot "exist"!</p>
<p>You may be wondering: Why does consistency matter?</p>
<h2 id="Soundness,-Consistency-and-Conservative-Extensions">Soundness, Consistency and Conservative Extensions<a class="anchor-link" href="#Soundness,-Consistency-and-Conservative-Extensions">&#182;</a></h2><p>Imandra is both a programming language and a logic. A crucial property of a logic is <em>soundness</em>. For a logic to be <em>sound</em>, every theorem provable in the logic must be <em>true</em>. An <em>unsound</em> theorem prover would be of little use!</p>
<p>As we're developing programs and reasoning about them in Imandra, we're extending Imandra's logical world by defining types, functions, modules, and proving theorems. At any given time, this collection of all definitions and theorems is referred to as Imandra's <em>current theory</em>. It's important to ensure this current theory <code>T</code> is <em>consistent</em>, i.e., that there exists no statement <code>P</code> such that both <code>P</code> and <code>(not P)</code> are provable from <code>T</code>. If we weren't sure if <code>T</code> were consistent, then we would never know if a "theorem" was provable because it was true, or simply because <code>T</code> proves <code>false</code> (and <code>false</code> implies everything!).</p>
<p>Imandra's <em>definitional principle</em> is designed to ensure this consistency, by enforcing certain restrictions on our definitions. In the parlance of mathematical logic, Imandra's definitional principle ensures that every definitional extension of Imandra's current theory is a <a href="https://en.wikipedia.org/wiki/Conservative_extension">conservative extension</a>.</p>
<p>There are two main rules Imandra enforces for ensuring consistency:</p>
<ul>
<li>Every defined type must be well-founded.</li>
<li>Every defined function must be total (i.e., terminating on all possible inputs).</li>
</ul>
<p>In this notebook, we'll focus on the latter: proving program termination!</p>
<h2 id="Termination-ensures-existence">Termination ensures existence<a class="anchor-link" href="#Termination-ensures-existence">&#182;</a></h2><p>Thankfully, a deep theorem of mathematical logic tells us that admitting terminating (also known as <em>total</em>) functions cannot lead us to inconsistency.</p>
<p>To admit a new function into Imandra's logic, Imandra must be able to prove that it always terminates. For most common patterns of recursion, Imandra is able to prove termination automatically. For others, users may need to give Imandra help in the form of <em>hints</em> and <em>measures</em>.</p>
<h2 id="Let's-get-our-hands-dirty">Let's get our hands dirty<a class="anchor-link" href="#Let's-get-our-hands-dirty">&#182;</a></h2><p>Let's define a few functions and see what this is like. First, let's observe that non-recursive functions are always admissible (provided we're not dealing with <em>redefinition</em>):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-8" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="n">k</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">=</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span> <span class="k">then</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="k">else</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val k : int -&gt; int -&gt; Z.t -&gt; Z.t = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now define some simple recursive functions, and observe how Imandra responds.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-10" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum_lst</span> <span class="o">=</span> <span class="k">function</span>
 <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
 <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum_lst</span> <span class="n">xs</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val sum_lst : Z.t list -&gt; Z.t = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-148a6c3d-f7a1-4fe3-8963-a6da61a7ab12"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-4692c49d-056f-4673-8ad1-54d93b6db65f"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `sum_lst (List.tl _x)` from `sum_lst _x`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-50189ee1-86b1-4bfd-810c-4726c10e61a2"><table><tr><td><b>original</b></td><td>sum_lst _x</td></tr><tr><td><b>sub</b></td><td>sum_lst (List.tl _x)</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count _x)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (List.tl _x))</td></tr><tr><td><b>path</b></td><td>[not (_x = [])]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-f26d6861-e7fb-4f07-9210-6be3b5e03194"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-845b985f-c125-4776-acb8-bad21a93a08f"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-c9bbb600-e765-4203-bfdf-25ff2f826aaa"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.022s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-bdaff8bb-e191-4011-9702-1f4e393ede06"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-90546603-3530-4659-a98f-40e7075f25c9"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-516979ca-28a3-4f49-9e7a-4cce0504245d"><table><tr><td><b>num checks</b></td><td>8</td></tr><tr><td><b>arith assert lower</b></td><td>18</td></tr><tr><td><b>arith pivots</b></td><td>10</td></tr><tr><td><b>rlimit count</b></td><td>4195</td></tr><tr><td><b>mk clause</b></td><td>19</td></tr><tr><td><b>datatype occurs check</b></td><td>43</td></tr><tr><td><b>mk bool var</b></td><td>80</td></tr><tr><td><b>arith assert upper</b></td><td>14</td></tr><tr><td><b>datatype splits</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>14</td></tr><tr><td><b>arith add rows</b></td><td>19</td></tr><tr><td><b>propagations</b></td><td>14</td></tr><tr><td><b>conflicts</b></td><td>8</td></tr><tr><td><b>arith fixed eqs</b></td><td>8</td></tr><tr><td><b>datatype accessor ax</b></td><td>5</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>datatype constructor ax</b></td><td>7</td></tr><tr><td><b>num allocs</b></td><td>1350673110</td></tr><tr><td><b>final checks</b></td><td>6</td></tr><tr><td><b>added eqs</b></td><td>49</td></tr><tr><td><b>del clause</b></td><td>8</td></tr><tr><td><b>arith eq adapter</b></td><td>12</td></tr><tr><td><b>memory</b></td><td>6.220000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-bdaff8bb-e191-4011-9702-1f4e393ede06';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-7b9fb5ef-fcdb-4e28-af0b-2e2e0e16c0ce"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.022s]
  not (_x = []) &amp;&amp; Ordinal.count _x &gt;= 0 &amp;&amp; Ordinal.count (List.tl _x) &gt;= 0
  ==&gt; List.tl _x = []
      || Ordinal.Int (Ordinal.count (List.tl _x)) Ordinal.&lt;&lt;
         Ordinal.Int (Ordinal.count _x)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-ab7901a8-0dcc-46bb-94d5-c380def548b8"><table><tr><td><b>into</b></td><td><pre>(not
 ((not (_x = []) &amp;&amp; Ordinal.count _x &gt;= 0) &amp;&amp; Ordinal.count (List.tl _x) &gt;= 0)
 || List.tl _x = [])
|| Ordinal.Int (Ordinal.count (List.tl _x)) Ordinal.&lt;&lt;
   Ordinal.Int (Ordinal.count _x)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-aefac0f0-145f-4728-9140-4125dca77949"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (|count_`int list`_2359|
                                   (|get.:…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ea9bcbba-7737-4a82-bb29-f3cb1c1f6aef"><table><tr><td><b>expr</b></td><td><pre>(|count_`int list`_2359| (|get.::.1_2353| _x_2354))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-35e7c8c2-4b08-4aea-af98-d62ef1e79a1a"><table><tr><td><b>expr</b></td><td><pre>(|count_`int list`_2359| _x_2354)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (&gt;= (ite (&gt;= (|get.::.0_2352| _x_2354) 0)
                    (|get.::.0_2352| _x_2354)
 …</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-7b9fb5ef-fcdb-4e28-af0b-2e2e0e16c0ce';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-845b985f-c125-4776-acb8-bad21a93a08f';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f26d6861-e7fb-4f07-9210-6be3b5e03194';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-4692c49d-056f-4673-8ad1-54d93b6db65f';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-148a6c3d-f7a1-4fe3-8963-a6da61a7ab12';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-11" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">sum_lst</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t = 6
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-12" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">x</span> <span class="o">=</span> 
 <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">0</span>
 <span class="k">else</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum</span><span class="o">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val sum : int -&gt; Z.t = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-0668dd8d-646c-40e7-b735-55a76b77dad0"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-f89a05b2-c0e5-4f8a-9d22-2c6ce1192e25"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `sum (x - 1)` from `sum x`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-37975a49-c675-4519-b610-7b3c0941d821"><table><tr><td><b>original</b></td><td>sum x</td></tr><tr><td><b>sub</b></td><td>sum (x - 1)</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (if x &gt;= 0 then x else 0)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (if (x - 1) &gt;= 0 then x - 1 else 0)</td></tr><tr><td><b>path</b></td><td>[not (x &lt;= 0)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-94f63e1a-5254-4849-b9a0-e7997ea90592"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-e947391c-4736-4976-bbff-baedc66b2eb6"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-28061383-fb5d-47ed-aeff-40cd21e83dc4"><table><tr><td><b>ground_instances</b></td><td>1</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.012s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-9be0adba-eefb-4ca7-b814-08d0322be593"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-c461091d-da25-4f96-ba9d-c9fd50f84c07"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-0306e20e-9aff-4824-9739-09284dba262f"><table><tr><td><b>num checks</b></td><td>3</td></tr><tr><td><b>arith assert lower</b></td><td>8</td></tr><tr><td><b>arith pivots</b></td><td>2</td></tr><tr><td><b>rlimit count</b></td><td>5170</td></tr><tr><td><b>mk clause</b></td><td>4</td></tr><tr><td><b>datatype occurs check</b></td><td>2</td></tr><tr><td><b>mk bool var</b></td><td>20</td></tr><tr><td><b>arith assert upper</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>2</td></tr><tr><td><b>arith add rows</b></td><td>3</td></tr><tr><td><b>propagations</b></td><td>2</td></tr><tr><td><b>conflicts</b></td><td>2</td></tr><tr><td><b>arith fixed eqs</b></td><td>2</td></tr><tr><td><b>datatype accessor ax</b></td><td>2</td></tr><tr><td><b>arith conflicts</b></td><td>1</td></tr><tr><td><b>num allocs</b></td><td>1397591618</td></tr><tr><td><b>final checks</b></td><td>1</td></tr><tr><td><b>added eqs</b></td><td>6</td></tr><tr><td><b>del clause</b></td><td>4</td></tr><tr><td><b>arith eq adapter</b></td><td>2</td></tr><tr><td><b>memory</b></td><td>6.190000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-9be0adba-eefb-4ca7-b814-08d0322be593';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-15522220-3475-4ee7-af0d-3d75cef6d516"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.012s]
  not (x &lt;= 0)
  &amp;&amp; (if x &gt;= 0 then x else 0) &gt;= 0
     &amp;&amp; (if (x - 1) &gt;= 0 then x - 1 else 0) &gt;= 0
  ==&gt; (x - 1) &lt;= 0
      || Ordinal.Int (if (x - 1) &gt;= 0 then x - 1 else 0) Ordinal.&lt;&lt;
         Ordinal.Int (if x &gt;= 0 then x else 0)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-ac45646e-e018-41ff-9dbb-268898478dca"><table><tr><td><b>into</b></td><td><pre>(not
 ((not (x &lt;= 0) &amp;&amp; (if x &gt;= 0 then x else 0) &gt;= 0)
  &amp;&amp; (if x &gt;= 1 then -1 + x else 0) &gt;= 0)
 || x &lt;= 1)
|| Ordinal.Int (if x &gt;= 1 then -1 + x else 0) Ordinal.&lt;&lt;
   Ordinal.Int (if x &gt;= 0 then x else 0)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-bed3482a-4d63-4475-9775-e5475ac9588b"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (ite (&gt;= x_2365 1) (+ (- 1) x_2365) 0))
                (Ordinal.In…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (not (= x_2365 (ite (&gt;= x_2365 0) x_2365 0))))
      (a!2 (+ x_2365 (* (- 1) (ite (&gt;= x_2…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-15522220-3475-4ee7-af0d-3d75cef6d516';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-e947391c-4736-4976-bbff-baedc66b2eb6';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-94f63e1a-5254-4849-b9a0-e7997ea90592';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f89a05b2-c0e5-4f8a-9d22-2c6ce1192e25';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-0668dd8d-646c-40e7-b735-55a76b77dad0';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-13" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">sum</span> <span class="mi">5</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t = 15
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-14" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">sum</span> <span class="mi">100</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t = 5050
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Out of curiosity, let's see what would happen if we made a mistake in our definition of <code>sum</code> above, by, e.g., using <code>x = 0</code> as our test instead of <code>x &lt;= 0</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-16" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum_oops</span> <span class="n">x</span> <span class="o">=</span> 
 <span class="k">if</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">0</span>
 <span class="k">else</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum_oops</span> <span class="o">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val sum_oops : Z.t -&gt; Z.t = &lt;fun&gt;
File &#34;jupyter cell 9&#34;, line 1, characters 0-63:
<span class="ansi-red-intense-fg ansi-bold">Error</span>: rejected definition for function sum_oops,
Imandra could not prove termination. 
hint: problematic sub-call from `sum_oops x` to `sum_oops (x - 1)`
is not decreasing (measured subset: (x))
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note how Imandra rejects the definition, and tells us this is because it could not prove termination, in particular regarding the problematic recursive call <code>sum_oops (x-1)</code>. Indeed, <code>sum_oops</code> does not terminate when <code>x</code> is negative!</p>
<h1 id="Structural-Recursions">Structural Recursions<a class="anchor-link" href="#Structural-Recursions">&#182;</a></h1><p>Structural recursions are easy for Imandra. For example, let's define a datatype of trees and a few functions on them. Imandra will fly on these termination proofs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-18" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">type</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">tree</span> <span class="o">=</span> <span class="nc">Leaf</span> <span class="k">of</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">|</span> <span class="nc">Node</span> <span class="k">of</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">tree</span> <span class="o">*</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">tree</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type &#39;a tree = Leaf of &#39;a | Node of &#39;a tree * &#39;a tree
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-19" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">size</span> <span class="o">=</span> <span class="k">function</span>
 <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">_</span>     <span class="o">-&gt;</span> <span class="mi">1</span>
 <span class="o">|</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">size</span> <span class="n">a</span> <span class="o">+</span> <span class="n">size</span> <span class="n">b</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val size : &#39;a tree -&gt; Z.t = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-8e1a1bdb-ac2b-48d3-8694-7e0f2c757aa5"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-871586d1-d2c1-484c-ad10-2f9a01605cc1"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `size (Destruct(Node, 0, _x))` from `size _x`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-7feb7add-4f8f-4a61-9d89-e897cd75143b"><table><tr><td><b>original</b></td><td>size _x</td></tr><tr><td><b>sub</b></td><td>size (Destruct(Node, 0, _x))</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count _x)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (Destruct(Node, 0, _x)))</td></tr><tr><td><b>path</b></td><td>[not Is_a(Leaf, _x)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-95e2e5fa-6636-4af6-a675-ad5f09308771"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-b311b2e4-9209-4d63-a6e3-eb8912289577"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-07c04709-d3bc-4901-ae11-c846b621e708"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.031s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-756b2bc9-c3df-4fd4-b931-9335942bbe8f"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-78b24a67-4b9c-4904-b86c-fdca25de1efc"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-08bf7d10-1f21-4740-ac32-c11c1706ddbc"><table><tr><td><b>num checks</b></td><td>8</td></tr><tr><td><b>arith assert lower</b></td><td>12</td></tr><tr><td><b>arith pivots</b></td><td>9</td></tr><tr><td><b>rlimit count</b></td><td>11147</td></tr><tr><td><b>mk clause</b></td><td>11</td></tr><tr><td><b>datatype occurs check</b></td><td>52</td></tr><tr><td><b>mk bool var</b></td><td>85</td></tr><tr><td><b>arith assert upper</b></td><td>12</td></tr><tr><td><b>datatype splits</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>16</td></tr><tr><td><b>arith add rows</b></td><td>15</td></tr><tr><td><b>propagations</b></td><td>8</td></tr><tr><td><b>conflicts</b></td><td>6</td></tr><tr><td><b>arith fixed eqs</b></td><td>5</td></tr><tr><td><b>datatype accessor ax</b></td><td>13</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>datatype constructor ax</b></td><td>11</td></tr><tr><td><b>num allocs</b></td><td>1545805743</td></tr><tr><td><b>final checks</b></td><td>4</td></tr><tr><td><b>added eqs</b></td><td>55</td></tr><tr><td><b>del clause</b></td><td>4</td></tr><tr><td><b>arith eq adapter</b></td><td>8</td></tr><tr><td><b>memory</b></td><td>6.290000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-756b2bc9-c3df-4fd4-b931-9335942bbe8f';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-f6e8587c-133b-4757-8ec4-4592c9d8efeb"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.031s]
  not Is_a(Leaf, _x)
  &amp;&amp; Ordinal.count _x &gt;= 0 &amp;&amp; Ordinal.count (Destruct(Node, 0, _x)) &gt;= 0
  ==&gt; Is_a(Leaf, Destruct(Node, 0, _x)) &amp;&amp; Is_a(Leaf, Destruct(Node, 0, _x))
      || Ordinal.Int (Ordinal.count (Destruct(Node, 0, _x))) Ordinal.&lt;&lt;
         Ordinal.Int (Ordinal.count _x)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-df50655c-a9ef-4f22-be1b-1aa83c95adba"><table><tr><td><b>into</b></td><td><pre>(not
 ((not Is_a(Leaf, _x) &amp;&amp; Ordinal.count _x &gt;= 0)
  &amp;&amp; Ordinal.count (Destruct(Node, 0, _x)) &gt;= 0)
 || Is_a(Leaf, Destruct(Node, 0, _x)))
|| Ordinal.Int (Ordinal.count (Destruct(Node, 0, _x))) Ordinal.&lt;&lt;
   Ordinal.Int (Ordinal.count _x)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-29511b8e-8ea3-4bc7-a1c2-57610902454d"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (|count_`ty_0 tree`_2411|
                                   (get.N…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-23c033ee-6243-4cca-995a-bdd9fec0004b"><table><tr><td><b>expr</b></td><td><pre>(|count_`ty_0 tree`_2411| (get.Node.0_2398 _x_2404))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6ed75a3f-5f76-4937-b0e0-1a0a98722ecb"><table><tr><td><b>expr</b></td><td><pre>(|count_`ty_0 tree`_2411| _x_2404)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (ite (&gt;= (|count_`ty_0 tree`_2411| (get.Node.1_2399 _x_2404)) 0)
                (|count_…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f6e8587c-133b-4757-8ec4-4592c9d8efeb';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-b311b2e4-9209-4d63-a6e3-eb8912289577';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-95e2e5fa-6636-4af6-a675-ad5f09308771';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-871586d1-d2c1-484c-ad10-2f9a01605cc1';
  fold.hydrate(target);
});
</script></div><p></p><div class="imandra-fold panel panel-default" id="fold-695784b5-1445-4124-89db-8243af4550cc"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `size (Destruct(Node, 1, _x))` from `size _x`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-08027f7c-fcc5-40ec-bea6-8c4eb1fad9aa"><table><tr><td><b>original</b></td><td>size _x</td></tr><tr><td><b>sub</b></td><td>size (Destruct(Node, 1, _x))</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count _x)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (Destruct(Node, 1, _x)))</td></tr><tr><td><b>path</b></td><td>[not Is_a(Leaf, _x)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-cb79c32c-703c-4fe4-98c0-64dbd95d33c6"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-df550529-dd13-4efa-8a6f-ed6a1aef5092"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-74c8ceda-946a-411a-a86b-a909c67d3a88"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.024s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-a5ffee96-0bd0-4606-85cf-40a6809bedfa"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-1cb4df1a-25ed-4f34-bb57-4ff8acc46bfe"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-0d0b5083-aa17-4655-9870-3e8b963cf6a0"><table><tr><td><b>num checks</b></td><td>8</td></tr><tr><td><b>arith assert lower</b></td><td>12</td></tr><tr><td><b>arith pivots</b></td><td>7</td></tr><tr><td><b>rlimit count</b></td><td>8829</td></tr><tr><td><b>mk clause</b></td><td>12</td></tr><tr><td><b>datatype occurs check</b></td><td>52</td></tr><tr><td><b>mk bool var</b></td><td>87</td></tr><tr><td><b>arith assert upper</b></td><td>15</td></tr><tr><td><b>datatype splits</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>18</td></tr><tr><td><b>arith add rows</b></td><td>17</td></tr><tr><td><b>propagations</b></td><td>10</td></tr><tr><td><b>conflicts</b></td><td>6</td></tr><tr><td><b>arith fixed eqs</b></td><td>9</td></tr><tr><td><b>datatype accessor ax</b></td><td>13</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>datatype constructor ax</b></td><td>11</td></tr><tr><td><b>num allocs</b></td><td>1471070310</td></tr><tr><td><b>final checks</b></td><td>4</td></tr><tr><td><b>added eqs</b></td><td>60</td></tr><tr><td><b>del clause</b></td><td>5</td></tr><tr><td><b>arith eq adapter</b></td><td>9</td></tr><tr><td><b>memory</b></td><td>8.720000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-a5ffee96-0bd0-4606-85cf-40a6809bedfa';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-418c8904-e627-468c-a2d7-9ca1e484a1fc"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.024s]
  not Is_a(Leaf, _x)
  &amp;&amp; Ordinal.count _x &gt;= 0 &amp;&amp; Ordinal.count (Destruct(Node, 1, _x)) &gt;= 0
  ==&gt; Is_a(Leaf, Destruct(Node, 1, _x)) &amp;&amp; Is_a(Leaf, Destruct(Node, 1, _x))
      || Ordinal.Int (Ordinal.count (Destruct(Node, 1, _x))) Ordinal.&lt;&lt;
         Ordinal.Int (Ordinal.count _x)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-8d8c4db3-dc06-47f2-88ca-f9a6bf25ee24"><table><tr><td><b>into</b></td><td><pre>(not
 ((not Is_a(Leaf, _x) &amp;&amp; Ordinal.count _x &gt;= 0)
  &amp;&amp; Ordinal.count (Destruct(Node, 1, _x)) &gt;= 0)
 || Is_a(Leaf, Destruct(Node, 1, _x)))
|| Ordinal.Int (Ordinal.count (Destruct(Node, 1, _x))) Ordinal.&lt;&lt;
   Ordinal.Int (Ordinal.count _x)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-939d9cd0-5e65-41c5-96eb-ea1267b3e14b"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (|count_`ty_0 tree`_2411|
                                   (get.N…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-9c0c9fff-9d59-48f3-bd8d-03d882661b0e"><table><tr><td><b>expr</b></td><td><pre>(|count_`ty_0 tree`_2411| (get.Node.1_2399 _x_2404))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-5d8c82e4-036f-4589-8dae-d5c524c510e8"><table><tr><td><b>expr</b></td><td><pre>(|count_`ty_0 tree`_2411| _x_2404)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (ite (&gt;= (|count_`ty_0 tree`_2411| (get.Node.0_2398 _x_2404)) 0)
                (|count_…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-418c8904-e627-468c-a2d7-9ca1e484a1fc';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-df550529-dd13-4efa-8a6f-ed6a1aef5092';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-cb79c32c-703c-4fe4-98c0-64dbd95d33c6';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-695784b5-1445-4124-89db-8243af4550cc';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-8e1a1bdb-ac2b-48d3-8694-7e0f2c757aa5';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For fun, let's ask Imandra to synthesize an <code>int tree</code> of <code>size</code> 5 for us:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-21" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">instance</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">tree</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">size</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : int tree -&gt; bool = &lt;fun&gt;
<span class="ansi-green-intense-fg ansi-bold">[✔]</span> Instance found.
module CX : sig val x : Z.t tree end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Instance (after 9 steps, 0.046s):
 let x =
   (Node
      ((Node ((Leaf (7)), (Leaf (8)))),
       (Node ((Leaf (10)), (Node ((Leaf (9)), (Leaf (11))))))))
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-vr imandra-vr-refuted"><i class="fa fa-times-circle-o"></i><span>Refuted</span></div><div><div class="imandra-alternatives" id="alt-2342c608-e1b4-464d-a097-df54774fb04f"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof-attempt</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-6348632f-5b3e-46e0-a983-08d112fb8f97"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;size x = 5&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_160 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_160 -&gt; expr_443 [label=&quot;=&quot;];
expr_443 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_164 -&gt; call_160 [label=&quot;calls&quot;];
call_354 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_354 -&gt; expr_771 [label=&quot;=&quot;];
expr_771 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))\lthen 1\lelse\l  size\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …)))))\l  + size\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_356 -&gt; call_354 [label=&quot;calls&quot;];
call_769 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_771 -&gt; call_769 [label=&quot;calls&quot;];
call_226 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_226 -&gt; expr_646 [label=&quot;=&quot;];
expr_646 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 0, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_230 -&gt; call_226 [label=&quot;calls&quot;];
call_441 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_443 -&gt; call_441 [label=&quot;calls&quot;];
call_885 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_887 -&gt; call_885 [label=&quot;calls&quot;];
call_10 [label=&quot;size x&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_10 -&gt; expr_59 [label=&quot;=&quot;];
expr_59 [label=&quot;if Is_a(Leaf, x) then 1\lelse size (Destruct(Node, 0, x)) + size (Destruct(Node, 1, x))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_10 [label=&quot;calls&quot;];
call_55 [label=&quot;size (Destruct(Node, 0, x))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_55 -&gt; expr_230 [label=&quot;=&quot;];
expr_230 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, x)) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 0, x)))\l  + size (Destruct(Node, 1, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_59 -&gt; call_55 [label=&quot;calls&quot;];
call_568 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_572 -&gt; call_568 [label=&quot;calls&quot;];
call_162 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_162 -&gt; expr_356 [label=&quot;=&quot;];
expr_356 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_164 -&gt; call_162 [label=&quot;calls&quot;];
call_642 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_646 -&gt; call_642 [label=&quot;calls&quot;];
call_228 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_228 -&gt; expr_572 [label=&quot;=&quot;];
expr_572 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 0, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_230 -&gt; call_228 [label=&quot;calls&quot;];
call_57 [label=&quot;size (Destruct(Node, 1, x))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_57 -&gt; expr_164 [label=&quot;=&quot;];
expr_164 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, x)) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 1, x)))\l  + size (Destruct(Node, 1, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_59 -&gt; call_57 [label=&quot;calls&quot;];
call_570 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_572 -&gt; call_570 [label=&quot;calls&quot;];
call_352 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_352 -&gt; expr_887 [label=&quot;=&quot;];
expr_887 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))\lthen 1\lelse\l  size\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …)))))\l  + size\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_356 -&gt; call_352 [label=&quot;calls&quot;];
call_767 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_771 -&gt; call_767 [label=&quot;calls&quot;];
call_644 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_646 -&gt; call_644 [label=&quot;calls&quot;];
call_439 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_443 -&gt; call_439 [label=&quot;calls&quot;];
call_883 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_887 -&gt; call_883 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-6348632f-5b3e-46e0-a983-08d112fb8f97';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-2bc7b1e9-cd0f-4d08-85d6-b7f7510a5190"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-5642235e-d8b3-4105-8699-d231413be5b7"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-6e13b203-b702-4b79-a88a-cd1113551021"><table><tr><td><b>ground_instances</b></td><td>9</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.046s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-50943dd8-0371-4238-81e0-61e9196eec22"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-06afffd5-7082-41e9-8ee2-b90a66ab6dff"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-1ed7ecbb-b388-4b36-a091-da5f8907e506"><table><tr><td><b>arith offset eqs</b></td><td>4</td></tr><tr><td><b>num checks</b></td><td>19</td></tr><tr><td><b>arith assert lower</b></td><td>76</td></tr><tr><td><b>arith pivots</b></td><td>39</td></tr><tr><td><b>rlimit count</b></td><td>6100</td></tr><tr><td><b>mk clause</b></td><td>133</td></tr><tr><td><b>datatype occurs check</b></td><td>307</td></tr><tr><td><b>mk bool var</b></td><td>608</td></tr><tr><td><b>arith assert upper</b></td><td>66</td></tr><tr><td><b>datatype splits</b></td><td>19</td></tr><tr><td><b>decisions</b></td><td>103</td></tr><tr><td><b>arith add rows</b></td><td>87</td></tr><tr><td><b>arith bound prop</b></td><td>4</td></tr><tr><td><b>propagations</b></td><td>258</td></tr><tr><td><b>conflicts</b></td><td>20</td></tr><tr><td><b>arith fixed eqs</b></td><td>11</td></tr><tr><td><b>datatype accessor ax</b></td><td>112</td></tr><tr><td><b>arith conflicts</b></td><td>5</td></tr><tr><td><b>arith assert diseq</b></td><td>11</td></tr><tr><td><b>datatype constructor ax</b></td><td>112</td></tr><tr><td><b>num allocs</b></td><td>1576633943</td></tr><tr><td><b>final checks</b></td><td>18</td></tr><tr><td><b>added eqs</b></td><td>591</td></tr><tr><td><b>del clause</b></td><td>77</td></tr><tr><td><b>arith eq adapter</b></td><td>88</td></tr><tr><td><b>memory</b></td><td>9.150000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-50943dd8-0371-4238-81e0-61e9196eec22';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-24061782-9017-436c-bf2a-e2300630b41a"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.046s] size :var_0: = 5</pre></li><li><div>unroll<div class="imandra-table" id="table-8397b9db-f83d-4122-a0c3-b8d4108050d3"><table><tr><td><b>expr</b></td><td><pre>(size_2423 x_2416)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ec66428d-b52a-4fbd-8072-89d154b5d6c6"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.1_2422 x_2416))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6597b71c-131a-4699-ac68-39d3e54c6ba0"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.0_2421 x_2416))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-d925d0cc-8d85-4553-9b38-4274496c313c"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.1_2422 (get.Node.1_2422 x_2416)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-d3479c92-6ef0-46f7-b43a-0b409dc89faa"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.0_2421 (get.Node.1_2422 x_2416)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-35e8761b-d426-408c-9866-cf687cec8796"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.1_2422 (get.Node.0_2421 x_2416)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-08aff354-9b2a-4213-92d9-9f21dd26c033"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.0_2421 (get.Node.0_2421 x_2416)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6caade92-1acb-45b3-8046-05fefb90c95b"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.1_2422 (get.Node.1_2422 (get.Node.1_2422 x_2416))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-e875ee3a-083a-440a-a4f6-d3a1cee452e5"><table><tr><td><b>expr</b></td><td><pre>(size_2423 (get.Node.0_2421 (get.Node.1_2422 (get.Node.1_2422 x_2416))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let x =
   (Node
      ((Node ((Leaf (7)), (Leaf (8)))),
       (Node ((Leaf (10)), (Node ((Leaf (9)), (Leaf (11))))))))
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-24061782-9017-436c-bf2a-e2300630b41a';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-e1b392df-dcd2-4e39-9e18-53574b97776a"><textarea style="display: none">digraph &quot;proof&quot; {
p_274 [label=&quot;Start (size :var_0: = 5 :time 0.046s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_274 -&gt; p_273 [label=&quot;&quot;];
p_273 [label=&quot;Unroll ([size x], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_273 -&gt; p_272 [label=&quot;&quot;];
p_272 [label=&quot;Unroll ([size (Destruct(Node, 1, x))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_272 -&gt; p_271 [label=&quot;&quot;];
p_271 [label=&quot;Unroll ([size (Destruct(Node, 0, x))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_271 -&gt; p_270 [label=&quot;&quot;];
p_270 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 1, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_270 -&gt; p_269 [label=&quot;&quot;];
p_269 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 1, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_269 -&gt; p_268 [label=&quot;&quot;];
p_268 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 0, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_268 -&gt; p_267 [label=&quot;&quot;];
p_267 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 0, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_267 -&gt; p_266 [label=&quot;&quot;];
p_266 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_266 -&gt; p_265 [label=&quot;&quot;];
p_265 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_265 -&gt; p_264 [label=&quot;&quot;];
p_264 [label=&quot;Sat (Some  let x =\l   (Node\l      ((Node ((Leaf (7)), (Leaf (8)))),\l       (Node ((Leaf (10)), (Node ((Leaf (9)), (Leaf (11))))))))\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-e1b392df-dcd2-4e39-9e18-53574b97776a';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-5642235e-d8b3-4105-8699-d231413be5b7';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-2bc7b1e9-cd0f-4d08-85d6-b7f7510a5190';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-2342c608-e1b4-464d-a097-df54774fb04f';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-22" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">size</span> <span class="nn">CX</span><span class="p">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t = 5
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cool! Let's now define a function to sum the leaves of an <code>int tree</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-24" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum_tree</span> <span class="o">=</span> <span class="k">function</span>
 <span class="o">|</span> <span class="nc">Leaf</span> <span class="n">n</span>     <span class="o">-&gt;</span> <span class="n">n</span>
 <span class="o">|</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">sum_tree</span> <span class="n">a</span> <span class="o">+</span> <span class="n">sum_tree</span> <span class="n">b</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val sum_tree : Z.t tree -&gt; Z.t = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-5b76fdac-b7b5-4d30-b49b-0fabd7755fa6"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-3d0b6687-1d78-44fb-b013-e91ff30cb85c"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `sum_tree (Destruct(Node, 0, _x))` from `sum_tree _x`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-6f2848a5-6942-479d-b3df-ca1b0b22c721"><table><tr><td><b>original</b></td><td>sum_tree _x</td></tr><tr><td><b>sub</b></td><td>sum_tree (Destruct(Node, 0, _x))</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count _x)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (Destruct(Node, 0, _x)))</td></tr><tr><td><b>path</b></td><td>[not Is_a(Leaf, _x)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-e83efacc-7287-401e-8f76-2192d1e2e681"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-d77c05fa-4f98-458a-8b5d-53335e8fa749"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-5d3220a7-496a-4a2e-806b-8203edf878e9"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.029s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-a3fc1983-635e-4447-9c44-59e1d014de30"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-525f5a47-ed83-49c9-bb76-b449f5e99e71"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-8dd40c84-155b-4ee7-89ed-b13122306e61"><table><tr><td><b>num checks</b></td><td>8</td></tr><tr><td><b>arith assert lower</b></td><td>12</td></tr><tr><td><b>arith pivots</b></td><td>7</td></tr><tr><td><b>rlimit count</b></td><td>11346</td></tr><tr><td><b>mk clause</b></td><td>20</td></tr><tr><td><b>datatype occurs check</b></td><td>52</td></tr><tr><td><b>mk bool var</b></td><td>102</td></tr><tr><td><b>arith assert upper</b></td><td>17</td></tr><tr><td><b>datatype splits</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>25</td></tr><tr><td><b>arith add rows</b></td><td>13</td></tr><tr><td><b>propagations</b></td><td>19</td></tr><tr><td><b>conflicts</b></td><td>7</td></tr><tr><td><b>arith fixed eqs</b></td><td>6</td></tr><tr><td><b>datatype accessor ax</b></td><td>13</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>arith assert diseq</b></td><td>1</td></tr><tr><td><b>datatype constructor ax</b></td><td>11</td></tr><tr><td><b>num allocs</b></td><td>1631964798</td></tr><tr><td><b>final checks</b></td><td>4</td></tr><tr><td><b>added eqs</b></td><td>58</td></tr><tr><td><b>del clause</b></td><td>5</td></tr><tr><td><b>arith eq adapter</b></td><td>11</td></tr><tr><td><b>memory</b></td><td>14.170000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-a3fc1983-635e-4447-9c44-59e1d014de30';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-c9f6ba84-69a9-4481-9139-3fe29ffc1a9d"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.029s]
  not Is_a(Leaf, _x)
  &amp;&amp; Ordinal.count _x &gt;= 0 &amp;&amp; Ordinal.count (Destruct(Node, 0, _x)) &gt;= 0
  ==&gt; Is_a(Leaf, Destruct(Node, 0, _x)) &amp;&amp; Is_a(Leaf, Destruct(Node, 0, _x))
      || Ordinal.Int (Ordinal.count (Destruct(Node, 0, _x))) Ordinal.&lt;&lt;
         Ordinal.Int (Ordinal.count _x)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-cfa9ee5c-44d0-4037-872e-dd3dcf3afc3e"><table><tr><td><b>into</b></td><td><pre>(not
 ((not Is_a(Leaf, _x) &amp;&amp; Ordinal.count _x &gt;= 0)
  &amp;&amp; Ordinal.count (Destruct(Node, 0, _x)) &gt;= 0)
 || Is_a(Leaf, Destruct(Node, 0, _x)))
|| Ordinal.Int (Ordinal.count (Destruct(Node, 0, _x))) Ordinal.&lt;&lt;
   Ordinal.Int (Ordinal.count _x)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-f0b92144-3077-4f45-ac11-8876fa2be935"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (|count_`int tree`_2465|
                                   (get.No…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-1b06cb16-a09d-44ec-9000-00d5d55b9e3a"><table><tr><td><b>expr</b></td><td><pre>(|count_`int tree`_2465| (get.Node.0_2421 _x_2454))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b5d79afc-1610-4271-8d88-93804e2aa59b"><table><tr><td><b>expr</b></td><td><pre>(|count_`int tree`_2465| _x_2454)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (ite (&gt;= (|count_`int tree`_2465| (get.Node.0_2421 _x_2454)) 0)
                (|count_`…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-c9f6ba84-69a9-4481-9139-3fe29ffc1a9d';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-d77c05fa-4f98-458a-8b5d-53335e8fa749';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-e83efacc-7287-401e-8f76-2192d1e2e681';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-3d0b6687-1d78-44fb-b013-e91ff30cb85c';
  fold.hydrate(target);
});
</script></div><p></p><div class="imandra-fold panel panel-default" id="fold-be999858-0d4d-4ba5-9d88-291afff10a00"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `sum_tree (Destruct(Node, 1, _x))` from `sum_tree _x`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-a05d2923-ab52-4a4c-b1e8-3819528d0bdf"><table><tr><td><b>original</b></td><td>sum_tree _x</td></tr><tr><td><b>sub</b></td><td>sum_tree (Destruct(Node, 1, _x))</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.Int (Ordinal.count _x)</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.Int (Ordinal.count (Destruct(Node, 1, _x)))</td></tr><tr><td><b>path</b></td><td>[not Is_a(Leaf, _x)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-83138a73-cf7c-4527-b91e-297733b8eb5b"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-f394a6b8-000f-4476-94f5-41f89611e8ae"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-6bf3c1cb-6c18-47d9-af97-1fd5ae05174a"><table><tr><td><b>ground_instances</b></td><td>3</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.022s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-29950c66-f34e-48ea-8016-5245f6e96947"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-6f925b6d-e6ae-4283-9689-d76afd4f39fb"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-f36c6c5f-2105-4b2a-b282-9271758ce337"><table><tr><td><b>num checks</b></td><td>8</td></tr><tr><td><b>arith assert lower</b></td><td>12</td></tr><tr><td><b>arith pivots</b></td><td>8</td></tr><tr><td><b>rlimit count</b></td><td>8767</td></tr><tr><td><b>mk clause</b></td><td>19</td></tr><tr><td><b>datatype occurs check</b></td><td>52</td></tr><tr><td><b>mk bool var</b></td><td>97</td></tr><tr><td><b>arith assert upper</b></td><td>12</td></tr><tr><td><b>datatype splits</b></td><td>3</td></tr><tr><td><b>decisions</b></td><td>22</td></tr><tr><td><b>arith add rows</b></td><td>17</td></tr><tr><td><b>propagations</b></td><td>12</td></tr><tr><td><b>conflicts</b></td><td>6</td></tr><tr><td><b>arith fixed eqs</b></td><td>6</td></tr><tr><td><b>datatype accessor ax</b></td><td>13</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>datatype constructor ax</b></td><td>11</td></tr><tr><td><b>num allocs</b></td><td>1604105383</td></tr><tr><td><b>final checks</b></td><td>4</td></tr><tr><td><b>added eqs</b></td><td>56</td></tr><tr><td><b>del clause</b></td><td>4</td></tr><tr><td><b>arith eq adapter</b></td><td>8</td></tr><tr><td><b>memory</b></td><td>11.670000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-29950c66-f34e-48ea-8016-5245f6e96947';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-b2dbd511-ca0f-48ab-971e-d51783551735"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.022s]
  not Is_a(Leaf, _x)
  &amp;&amp; Ordinal.count _x &gt;= 0 &amp;&amp; Ordinal.count (Destruct(Node, 1, _x)) &gt;= 0
  ==&gt; Is_a(Leaf, Destruct(Node, 1, _x)) &amp;&amp; Is_a(Leaf, Destruct(Node, 1, _x))
      || Ordinal.Int (Ordinal.count (Destruct(Node, 1, _x))) Ordinal.&lt;&lt;
         Ordinal.Int (Ordinal.count _x)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-16065897-b327-4957-95d0-7cf6f384056e"><table><tr><td><b>into</b></td><td><pre>(not
 ((not Is_a(Leaf, _x) &amp;&amp; Ordinal.count _x &gt;= 0)
  &amp;&amp; Ordinal.count (Destruct(Node, 1, _x)) &gt;= 0)
 || Is_a(Leaf, Destruct(Node, 1, _x)))
|| Ordinal.Int (Ordinal.count (Destruct(Node, 1, _x))) Ordinal.&lt;&lt;
   Ordinal.Int (Ordinal.count _x)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-9833640e-ac1c-4fdd-957b-e284657cf691"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.&lt;&lt;_131 (Ordinal.Int_122 (|count_`int tree`_2465|
                                   (get.No…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-41c400eb-bc04-48ee-967e-5853e02118bf"><table><tr><td><b>expr</b></td><td><pre>(|count_`int tree`_2465| (get.Node.1_2422 _x_2454))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-5760c025-fc9d-46f1-b6c5-798d94f92b1f"><table><tr><td><b>expr</b></td><td><pre>(|count_`int tree`_2465| _x_2454)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (ite (&gt;= (|count_`int tree`_2465| (get.Node.0_2421 _x_2454)) 0)
                (|count_`…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-b2dbd511-ca0f-48ab-971e-d51783551735';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-f394a6b8-000f-4476-94f5-41f89611e8ae';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-83138a73-cf7c-4527-b91e-297733b8eb5b';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-be999858-0d4d-4ba5-9d88-291afff10a00';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-5b76fdac-b7b5-4d30-b49b-0fabd7755fa6';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Out of curiosity, are there any trees whose <code>size</code> is greater than <code>5</code> and equal to <code>3</code> times their <code>sum</code>?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-26" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">instance</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">size</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="n">size</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">sum_tree</span> <span class="n">x</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t tree -&gt; bool = &lt;fun&gt;
<span class="ansi-green-intense-fg ansi-bold">[✔]</span> Instance found.
module CX : sig val x : Z.t tree end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Instance (after 26 steps, 0.117s):
 let x =
   (Node
      ((Node ((Leaf ((-7347))), (Leaf (4099)))),
       (Node
          ((Node ((Leaf ((-7523))), (Leaf (15358)))),
           (Node ((Leaf ((-9664))), (Leaf (5079))))))))
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-vr imandra-vr-refuted"><i class="fa fa-times-circle-o"></i><span>Refuted</span></div><div><div class="imandra-alternatives" id="alt-7ab39663-ccb3-44dd-b5f0-e3e7db391e0f"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof-attempt</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-8b128357-76cd-404f-bf75-891f30f6af58"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;size x \&gt;= 5 &amp;&amp; size x = 3 * sum_tree x&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_796 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_796 -&gt; expr_1955 [label=&quot;=&quot;];
expr_1955 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_798 -&gt; call_796 [label=&quot;calls&quot;];
call_1487 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1491 -&gt; call_1487 [label=&quot;calls&quot;];
call_1613 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1615 -&gt; call_1613 [label=&quot;calls&quot;];
call_568 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_568 -&gt; expr_1327 [label=&quot;=&quot;];
expr_1327 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_570 -&gt; call_568 [label=&quot;calls&quot;];
call_259 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_259 -&gt; expr_642 [label=&quot;=&quot;];
expr_642 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, x)))\lthen Destruct(Leaf, 0, Destruct(Node, 0, Destruct(Node, 1, x)))\lelse\l  sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, x))))\l  + sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_263 -&gt; call_259 [label=&quot;calls&quot;];
call_1826 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1830 -&gt; call_1826 [label=&quot;calls&quot;];
call_85 [label=&quot;sum_tree (Destruct(Node, 0, x))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_85 -&gt; expr_327 [label=&quot;=&quot;];
expr_327 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, x))\lthen Destruct(Leaf, 0, Destruct(Node, 0, x))\lelse\l  sum_tree (Destruct(Node, 0, Destruct(Node, 0, x)))\l  + sum_tree (Destruct(Node, 1, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_89 -&gt; call_85 [label=&quot;calls&quot;];
call_444 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_444 -&gt; expr_909 [label=&quot;=&quot;];
expr_909 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 0, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_446 -&gt; call_444 [label=&quot;calls&quot;];
call_907 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_909 -&gt; call_907 [label=&quot;calls&quot;];
call_794 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_794 -&gt; expr_2016 [label=&quot;=&quot;];
expr_2016 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_798 -&gt; call_794 [label=&quot;calls&quot;];
call_1506 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1508 -&gt; call_1506 [label=&quot;calls&quot;];
call_1611 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1615 -&gt; call_1611 [label=&quot;calls&quot;];
call_566 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_566 -&gt; expr_1508 [label=&quot;=&quot;];
expr_1508 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_570 -&gt; call_566 [label=&quot;calls&quot;];
call_2427 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2429 -&gt; call_2427 [label=&quot;calls&quot;];
call_937 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_937 -&gt; expr_1945 [label=&quot;=&quot;];
expr_1945 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))\lthen 1\lelse\l  size\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …)))))\l  + size\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_939 -&gt; call_937 [label=&quot;calls&quot;];
call_443 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_443 -&gt; expr_1151 [label=&quot;=&quot;];
expr_1151 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 0, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_446 -&gt; call_443 [label=&quot;calls&quot;];
call_700 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_909 -&gt; call_700 [label=&quot;calls&quot;];
call_790 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1320 -&gt; call_790 [label=&quot;calls&quot;];
call_1504 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1508 -&gt; call_1504 [label=&quot;calls&quot;];
call_2014 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2016 -&gt; call_2014 [label=&quot;calls&quot;];
call_2426 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2429 -&gt; call_2426 [label=&quot;calls&quot;];
call_1500 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1869 -&gt; call_1500 [label=&quot;calls&quot;];
call_936 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_936 -&gt; expr_2429 [label=&quot;=&quot;];
expr_2429 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))\lthen 1\lelse\l  size\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …)))))\l  + size\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_939 -&gt; call_936 [label=&quot;calls&quot;];
call_325 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_325 -&gt; expr_728 [label=&quot;=&quot;];
expr_728 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 0, x)))\lthen Destruct(Leaf, 0, Destruct(Node, 1, Destruct(Node, 0, x)))\lelse\l  sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, x))))\l  + sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_327 -&gt; call_325 [label=&quot;calls&quot;];
call_726 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_726 -&gt; expr_1869 [label=&quot;=&quot;];
expr_1869 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_728 -&gt; call_726 [label=&quot;calls&quot;];
call_1823 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1320 -&gt; call_1823 [label=&quot;calls&quot;];
call_172 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2016 -&gt; call_172 [label=&quot;calls&quot;];
call_1495 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1869 -&gt; call_1495 [label=&quot;calls&quot;];
call_1679 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1681 -&gt; call_1679 [label=&quot;calls&quot;];
call_640 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_640 -&gt; expr_1615 [label=&quot;=&quot;];
expr_1615 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_642 -&gt; call_640 [label=&quot;calls&quot;];
call_385 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_385 -&gt; expr_876 [label=&quot;=&quot;];
expr_876 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_387 -&gt; call_385 [label=&quot;calls&quot;];
call_323 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_323 -&gt; expr_798 [label=&quot;=&quot;];
expr_798 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 0, x)))\lthen Destruct(Leaf, 0, Destruct(Node, 0, Destruct(Node, 0, x)))\lelse\l  sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, x))))\l  + sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_327 -&gt; call_323 [label=&quot;calls&quot;];
call_724 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_724 -&gt; expr_1830 [label=&quot;=&quot;];
expr_1830 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_728 -&gt; call_724 [label=&quot;calls&quot;];
call_1325 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1327 -&gt; call_1325 [label=&quot;calls&quot;];
call_15 [label=&quot;size x&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_15 -&gt; expr_181 [label=&quot;=&quot;];
expr_181 [label=&quot;if Is_a(Leaf, x) then 1\lelse size (Destruct(Node, 0, x)) + size (Destruct(Node, 1, x))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_15 [label=&quot;calls&quot;];
call_179 [label=&quot;size (Destruct(Node, 1, x))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_179 -&gt; expr_387 [label=&quot;=&quot;];
expr_387 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, x)) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 1, x)))\l  + size (Destruct(Node, 1, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_181 -&gt; call_179 [label=&quot;calls&quot;];
call_1149 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1151 -&gt; call_1149 [label=&quot;calls&quot;];
call_1947 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1945 -&gt; call_1947 [label=&quot;calls&quot;];
call_1677 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1681 -&gt; call_1677 [label=&quot;calls&quot;];
call_874 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_874 -&gt; expr_1320 [label=&quot;=&quot;];
expr_1320 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))\lthen 1\lelse\l  size\l  (Destruct(Node, 0,\l            Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …)))))\l  + size\l    (Destruct(Node, 1,\l              Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_876 -&gt; call_874 [label=&quot;calls&quot;];
call_638 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_638 -&gt; expr_1681 [label=&quot;=&quot;];
expr_1681 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))\lthen\l  Destruct(Leaf, 0,\l           Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))\lelse\l  sum_tree\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …)))))\l  + sum_tree\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_642 -&gt; call_638 [label=&quot;calls&quot;];
call_384 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_384 -&gt; expr_939 [label=&quot;=&quot;];
expr_939 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, x))) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, x))))\l  + size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_387 -&gt; call_384 [label=&quot;calls&quot;];
call_1323 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1327 -&gt; call_1323 [label=&quot;calls&quot;];
call_178 [label=&quot;size (Destruct(Node, 0, x))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_178 -&gt; expr_446 [label=&quot;=&quot;];
expr_446 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, x)) then 1\lelse\l  size (Destruct(Node, 0, Destruct(Node, 0, x)))\l  + size (Destruct(Node, 1, Destruct(Node, 0, x)))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_181 -&gt; call_178 [label=&quot;calls&quot;];
call_1953 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1955 -&gt; call_1953 [label=&quot;calls&quot;];
call_1148 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1151 -&gt; call_1148 [label=&quot;calls&quot;];
call_1142 [label=&quot;size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1491 -&gt; call_1142 [label=&quot;calls&quot;];
call_1318 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1945 -&gt; call_1318 [label=&quot;calls&quot;];
call_873 [label=&quot;size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_873 -&gt; expr_1491 [label=&quot;=&quot;];
expr_1491 [label=&quot;if Is_a(Leaf, Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))\lthen 1\lelse\l  size\l  (Destruct(Node, 0,\l            Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …)))))\l  + size\l    (Destruct(Node, 1,\l              Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_876 -&gt; call_873 [label=&quot;calls&quot;];
call_261 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_261 -&gt; expr_570 [label=&quot;=&quot;];
expr_570 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, Destruct(Node, 1, x)))\lthen Destruct(Leaf, 0, Destruct(Node, 1, Destruct(Node, 1, x)))\lelse\l  sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, x))))\l  + sum_tree (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, x))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_263 -&gt; call_261 [label=&quot;calls&quot;];
call_1828 [label=&quot;sum_tree (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1830 -&gt; call_1828 [label=&quot;calls&quot;];
call_17 [label=&quot;sum_tree x&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_17 -&gt; expr_89 [label=&quot;=&quot;];
expr_89 [label=&quot;if Is_a(Leaf, x) then Destruct(Leaf, 0, x)\lelse sum_tree (Destruct(Node, 0, x)) + sum_tree (Destruct(Node, 1, x))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_17 [label=&quot;calls&quot;];
call_87 [label=&quot;sum_tree (Destruct(Node, 1, x))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_87 -&gt; expr_263 [label=&quot;=&quot;];
expr_263 [label=&quot;if Is_a(Leaf, Destruct(Node, 1, x))\lthen Destruct(Leaf, 0, Destruct(Node, 1, x))\lelse\l  sum_tree (Destruct(Node, 0, Destruct(Node, 1, x)))\l  + sum_tree (Destruct(Node, 1, Destruct(Node, 1, x)))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_89 -&gt; call_87 [label=&quot;calls&quot;];
call_1951 [label=&quot;sum_tree (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1955 -&gt; call_1951 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-8b128357-76cd-404f-bf75-891f30f6af58';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-b8ff80e6-9775-4ed7-91d3-c1810ed16bb0"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-d1c7befd-410d-4315-a6db-9be5afcef3d5"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-4b96665a-ae91-4cc8-aadb-ca374236a417"><table><tr><td><b>ground_instances</b></td><td>26</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.117s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-c1fdb49c-2084-4097-a170-2904dbd5749b"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-4f3cc201-a62c-4e54-9f47-ef7471719457"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-6970d639-b330-44a3-adc2-1ad82acfab23"><table><tr><td><b>arith offset eqs</b></td><td>13</td></tr><tr><td><b>num checks</b></td><td>53</td></tr><tr><td><b>arith assert lower</b></td><td>462</td></tr><tr><td><b>arith pivots</b></td><td>428</td></tr><tr><td><b>rlimit count</b></td><td>51513</td></tr><tr><td><b>mk clause</b></td><td>546</td></tr><tr><td><b>datatype occurs check</b></td><td>1452</td></tr><tr><td><b>mk bool var</b></td><td>2487</td></tr><tr><td><b>arith gcd tests</b></td><td>25</td></tr><tr><td><b>arith assert upper</b></td><td>339</td></tr><tr><td><b>datatype splits</b></td><td>88</td></tr><tr><td><b>decisions</b></td><td>949</td></tr><tr><td><b>arith add rows</b></td><td>1376</td></tr><tr><td><b>arith bound prop</b></td><td>4</td></tr><tr><td><b>propagations</b></td><td>1645</td></tr><tr><td><b>interface eqs</b></td><td>11</td></tr><tr><td><b>conflicts</b></td><td>45</td></tr><tr><td><b>arith fixed eqs</b></td><td>256</td></tr><tr><td><b>datatype accessor ax</b></td><td>450</td></tr><tr><td><b>minimized lits</b></td><td>4</td></tr><tr><td><b>arith conflicts</b></td><td>9</td></tr><tr><td><b>arith assert diseq</b></td><td>125</td></tr><tr><td><b>datatype constructor ax</b></td><td>450</td></tr><tr><td><b>num allocs</b></td><td>1726819746</td></tr><tr><td><b>final checks</b></td><td>59</td></tr><tr><td><b>added eqs</b></td><td>2911</td></tr><tr><td><b>del clause</b></td><td>398</td></tr><tr><td><b>arith ineq splits</b></td><td>3</td></tr><tr><td><b>arith eq adapter</b></td><td>385</td></tr><tr><td><b>memory</b></td><td>12.760000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-c1fdb49c-2084-4097-a170-2904dbd5749b';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-149b027a-67ec-40b0-b2a4-7c9c66f894cd"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.117s] size :var_0: &gt;= 5 &amp;&amp; size :var_0: = 3 * sum_tree :var_0:</pre></li><li><div>unroll<div class="imandra-table" id="table-197dd770-aa30-4a5a-8dde-511a506a0cea"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 x_2470)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-d262f0ec-ca8d-4a8d-a6b4-4138e5a8a1b9"><table><tr><td><b>expr</b></td><td><pre>(size_2477 x_2470)</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-3e968680-cf8c-4a8e-90d2-140a3bb2eaf6"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 x_2470))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-92d8fc82-4d13-4790-8d21-fc7723ad9b31"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 x_2470))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-156a39a2-0c34-42aa-bc23-1be10bc1f69a"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.1_2476 x_2470))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-5b17bf0d-3378-4359-a23b-ae3db34d0617"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.0_2475 x_2470))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-55cb9fa5-9d5b-4cf7-ab1a-5a5ab92791eb"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 (get.Node.1_2476 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-785ad7f5-1521-47a1-878d-a865df10f008"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 (get.Node.1_2476 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-e6f53054-3cb3-48db-9a16-7cf54386a592"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 (get.Node.0_2475 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-3d8debd6-868e-465f-9129-deb46332263b"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 (get.Node.0_2475 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-a1cc0587-d125-454b-a4b1-b0338a1363d9"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.1_2476 (get.Node.1_2476 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-0218ffd0-c1ef-4f69-b011-ca5f8b18589d"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.0_2475 (get.Node.1_2476 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-d179b736-962d-4a43-b252-9d2a00030c73"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.1_2476 (get.Node.0_2475 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-bc819d15-2a64-447b-b7e8-35bac85a57d6"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.0_2475 (get.Node.0_2475 x_2470)))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-7ee1b777-4344-43ea-a65d-af433a298e75"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 (get.Node.1_2476 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b4fca1f8-991f-448a-b2aa-a95c359fa6fe"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 (get.Node.1_2476 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6752aabd-ff7d-4dcf-a70c-d48364fe43a1"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 (get.Node.0_2475 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-a5a44ba5-b55a-41b2-abdc-49bacaf1f076"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 (get.Node.0_2475 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-bcf725b7-8fd8-47d8-9123-d6b931ae1809"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 (get.Node.1_2476 (get.Node.0_2475 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-0469c714-be50-43eb-8e40-e0692cbc615b"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 (get.Node.1_2476 (get.Node.0_2475 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-8463814b-6846-4ece-b56c-2298c1e16f75"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.1_2476 (get.Node.0_2475 (get.Node.0_2475 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-42428f39-cec7-4e51-b84b-d0aa34bdcc0e"><table><tr><td><b>expr</b></td><td><pre>(sum_tree_2448 (get.Node.0_2475 (get.Node.0_2475 (get.Node.0_2475 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-be165936-149a-4a2e-be11-482098ecc701"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.1_2476 (get.Node.1_2476 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-041b92d8-3a79-40ff-b307-f8dddc4ccc3d"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.0_2475 (get.Node.1_2476 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-99f8cccb-218a-4717-bf78-0e85ec301508"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.1_2476 (get.Node.0_2475 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-7dea756a-ac0b-4c0d-aa1c-003a7b09fca1"><table><tr><td><b>expr</b></td><td><pre>(size_2477 (get.Node.0_2475 (get.Node.0_2475 (get.Node.1_2476 x_2470))))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let x =
   (Node
      ((Node ((Leaf ((-7347))), (Leaf (4099)))),
       (Node
          ((Node ((Leaf ((-7523))), (Leaf (15358)))),
           (Node ((Leaf ((-9664))), (Leaf (5079))))))))
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-149b027a-67ec-40b0-b2a4-7c9c66f894cd';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-09586576-fda0-4dde-a012-f027a2c151c0"><textarea style="display: none">digraph &quot;proof&quot; {
p_314 [label=&quot;Start (size :var_0: \&gt;= 5 &amp;&amp; size :var_0: = 3 * sum_tree :var_0: :time 0.117s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_314 -&gt; p_313 [label=&quot;&quot;];
p_313 [label=&quot;Unroll ([sum_tree x], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_313 -&gt; p_312 [label=&quot;&quot;];
p_312 [label=&quot;Unroll ([size x], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_312 -&gt; p_311 [label=&quot;&quot;];
p_311 [label=&quot;Unroll ([sum_tree (Destruct(Node, 1, x))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_311 -&gt; p_310 [label=&quot;&quot;];
p_310 [label=&quot;Unroll ([sum_tree (Destruct(Node, 0, x))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_310 -&gt; p_309 [label=&quot;&quot;];
p_309 [label=&quot;Unroll ([size (Destruct(Node, 1, x))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_309 -&gt; p_308 [label=&quot;&quot;];
p_308 [label=&quot;Unroll ([size (Destruct(Node, 0, x))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_308 -&gt; p_307 [label=&quot;&quot;];
p_307 [label=&quot;Unroll ([sum_tree (Destruct(Node, 1, Destruct(Node, 1, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_307 -&gt; p_306 [label=&quot;&quot;];
p_306 [label=&quot;Unroll ([sum_tree (Destruct(Node, 0, Destruct(Node, 1, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_306 -&gt; p_305 [label=&quot;&quot;];
p_305 [label=&quot;Unroll ([sum_tree (Destruct(Node, 1, Destruct(Node, 0, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_305 -&gt; p_304 [label=&quot;&quot;];
p_304 [label=&quot;Unroll ([sum_tree (Destruct(Node, 0, Destruct(Node, 0, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_304 -&gt; p_303 [label=&quot;&quot;];
p_303 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 1, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_303 -&gt; p_302 [label=&quot;&quot;];
p_302 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 1, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_302 -&gt; p_301 [label=&quot;&quot;];
p_301 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 0, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_301 -&gt; p_300 [label=&quot;&quot;];
p_300 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 0, x)))], [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_300 -&gt; p_299 [label=&quot;&quot;];
p_299 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_299 -&gt; p_298 [label=&quot;&quot;];
p_298 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_298 -&gt; p_297 [label=&quot;&quot;];
p_297 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_297 -&gt; p_296 [label=&quot;&quot;];
p_296 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_296 -&gt; p_295 [label=&quot;&quot;];
p_295 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 0, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_295 -&gt; p_294 [label=&quot;&quot;];
p_294 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 0, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_294 -&gt; p_293 [label=&quot;&quot;];
p_293 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 0, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_293 -&gt; p_292 [label=&quot;&quot;];
p_292 [label=&quot;Unroll ([sum_tree\l         (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 0, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_292 -&gt; p_291 [label=&quot;&quot;];
p_291 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 1, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_291 -&gt; p_290 [label=&quot;&quot;];
p_290 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 1, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_290 -&gt; p_289 [label=&quot;&quot;];
p_289 [label=&quot;Unroll ([size (Destruct(Node, 1, Destruct(Node, 0, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_289 -&gt; p_288 [label=&quot;&quot;];
p_288 [label=&quot;Unroll ([size (Destruct(Node, 0, Destruct(Node, 0, Destruct(Node, 1, …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_288 -&gt; p_287 [label=&quot;&quot;];
p_287 [label=&quot;Sat (Some  let x =\l   (Node\l      ((Node ((Leaf ((-7347))), (Leaf (4099)))),\l       (Node\l          ((Node ((Leaf ((-7523))), (Leaf (15358)))),\l           (Node ((Leaf ((-9664))), (Leaf (5079))))))))\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-09586576-fda0-4dde-a012-f027a2c151c0';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-d1c7befd-410d-4315-a6db-9be5afcef3d5';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-b8ff80e6-9775-4ed7-91d3-c1810ed16bb0';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-7ab39663-ccb3-44dd-b5f0-e3e7db391e0f';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yes! Let's compute with that counterexample to see:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-28" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">size</span> <span class="nn">CX</span><span class="p">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t = 6
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-29" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="mi">3</span> <span class="o">*</span> <span class="n">sum_tree</span> <span class="nn">CX</span><span class="p">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Z.t = 6
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Ackermann-and-Admission-Hints">Ackermann and Admission Hints<a class="anchor-link" href="#Ackermann-and-Admission-Hints">&#182;</a></h1><p><img src="http://staff.ustc.edu.cn/~csli/graduate/algorithms/book6/451_a.gif"></p>
<p>The Ackermann function (actually, family of functions) is famous for many reasons. It grows extremely quickly, so quickly that it can be proved to not be <a href="https://en.wikipedia.org/wiki/Primitive_recursive_function">primitive recursive</a>!</p>
<p>Here's an example definition:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>let rec ack m n =
  if m &lt;= 0 then n + 1
  else if n &lt;= 0 then ack (m-1) 1
  else ack (m-1) (ack m (n-1))</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's worth it to study this function for a bit, to get a feel for why its recursion is tricky.</p>
<p>If we ask Imandra to admit it, we find out that it's tricky for Imandra, too!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-33" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">ack</span> <span class="n">m</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">else</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">ack</span> <span class="o">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="mi">1</span>
  <span class="k">else</span> <span class="n">ack</span> <span class="o">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">ack</span> <span class="n">m</span> <span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val ack : int -&gt; int -&gt; int = &lt;fun&gt;
File &#34;jupyter cell 18&#34;, line 1, characters 0-105:
<span class="ansi-red-intense-fg ansi-bold">Error</span>: rejected definition for function ack, Imandra could not prove termination. 
hint: problematic sub-call from `ack m n` to `ack m (n - 1)`
is not decreasing (measured subset: (m))
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre></pre></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Imandra tells us that it's unable to prove termination in the particular path that goes from <code>ack m n</code> to <code>ack m (n-1)</code>. Imandra further tells us that it tried to prove termination in this case using a <em>measured subset</em> of the arguments of <code>ack</code> containing only <code>m</code>.</p>
<p>Why does <code>ack</code> terminate, and how can we explain this to Imandra?</p>
<p>If we think about it for a little bit, we realise that <code>ack</code> terminates because its <em>pair</em> of arguments decreases <em>lexicographically</em> in its recursive calls. From the perspective of ordinals, the arguments of the recursive calls decrease along the ordinal $\omega^2$.</p>
<h2 id="Lexicographic-termination-(up-to-$\omega^\omega$)">Lexicographic termination (up to $\omega^\omega$)<a class="anchor-link" href="#Lexicographic-termination-(up-to-$\omega^\omega$)">&#182;</a></h2><p>Lexicographic termination is so common, there's a special way we can tell Imandra to use it.</p>
<p>This is done with the <code>@@adm</code> ("admission") attribute.</p>
<p>We can tell Imandra to prove <code>ack</code> terminating by using a lexicographic order on <code>(m,n)</code> in the following way:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-35" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">ack</span> <span class="n">m</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">else</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">ack</span> <span class="o">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="mi">1</span>
  <span class="k">else</span> <span class="n">ack</span> <span class="o">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">ack</span> <span class="n">m</span> <span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">))</span>
  <span class="o">[@@</span><span class="n">adm</span> <span class="n">m</span><span class="o">,</span><span class="n">n</span><span class="o">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val ack : int -&gt; int -&gt; int = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-6f09636a-4894-424c-ac44-f3e98551292b"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-46fdeb02-a7f9-4e5c-8680-f6b941245e2a"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `ack (m - 1) 1` from `ack m n`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-d7d9efc7-8868-4203-926c-baf778f65064"><table><tr><td><b>original</b></td><td>ack m n</td></tr><tr><td><b>sub</b></td><td>ack (m - 1) 1</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.of_list
((Ordinal.Int (if m &gt;= 0 then m else 0)) ::
 ((Ordinal.Int (if n &gt;= 0 then n else 0)) :: []))</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.of_list
((Ordinal.Int (if (m - 1) &gt;= 0 then m - 1 else 0)) ::
 ((Ordinal.Int (if 1 &gt;= 0 then 1 else 0)) :: []))</td></tr><tr><td><b>path</b></td><td>[n &lt;= 0 &amp;&amp; not (m &lt;= 0)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-90383970-f954-453c-a0c8-edf935435594"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-4f53111e-cd7f-46ee-a453-ffcafc45c5c7"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-fed1656b-1dd0-4197-87d9-b822a0ce9393"><table><tr><td><b>ground_instances</b></td><td>5</td></tr><tr><td><b>definitions</b></td><td>2</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.030s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-3ec3cfa3-1ba4-4578-99ca-fed73ba1e554"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-908083b8-1b76-42ac-8d68-11e937f271d5"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-29d90d9b-2353-4b47-9a90-efe5fbdf4af1"><table><tr><td><b>arith offset eqs</b></td><td>13</td></tr><tr><td><b>num checks</b></td><td>12</td></tr><tr><td><b>arith assert lower</b></td><td>17</td></tr><tr><td><b>arith pivots</b></td><td>7</td></tr><tr><td><b>rlimit count</b></td><td>73521</td></tr><tr><td><b>mk clause</b></td><td>67</td></tr><tr><td><b>datatype occurs check</b></td><td>139</td></tr><tr><td><b>mk bool var</b></td><td>198</td></tr><tr><td><b>arith assert upper</b></td><td>43</td></tr><tr><td><b>datatype splits</b></td><td>8</td></tr><tr><td><b>decisions</b></td><td>87</td></tr><tr><td><b>arith add rows</b></td><td>12</td></tr><tr><td><b>arith bound prop</b></td><td>1</td></tr><tr><td><b>propagations</b></td><td>94</td></tr><tr><td><b>conflicts</b></td><td>20</td></tr><tr><td><b>arith fixed eqs</b></td><td>8</td></tr><tr><td><b>datatype accessor ax</b></td><td>28</td></tr><tr><td><b>arith conflicts</b></td><td>2</td></tr><tr><td><b>arith assert diseq</b></td><td>2</td></tr><tr><td><b>datatype constructor ax</b></td><td>15</td></tr><tr><td><b>num allocs</b></td><td>1918336507</td></tr><tr><td><b>final checks</b></td><td>8</td></tr><tr><td><b>added eqs</b></td><td>187</td></tr><tr><td><b>del clause</b></td><td>38</td></tr><tr><td><b>arith eq adapter</b></td><td>30</td></tr><tr><td><b>memory</b></td><td>18.400000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-3ec3cfa3-1ba4-4578-99ca-fed73ba1e554';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-475e22b1-1302-41b3-8f2f-e33da86f1290"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.030s]
  n &lt;= 0
  &amp;&amp; not (m &lt;= 0)
     &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0
        &amp;&amp; (if n &gt;= 0 then n else 0) &gt;= 0
           &amp;&amp; (if (m - 1) &gt;= 0 then m - 1 else 0) &gt;= 0
              &amp;&amp; (if 1 &gt;= 0 then 1 else 0) &gt;= 0
  ==&gt; not (1 &lt;= 0 &amp;&amp; not ((m - 1) &lt;= 0))
      &amp;&amp; not (not (1 &lt;= 0) &amp;&amp; not ((m - 1) &lt;= 0))
         &amp;&amp; not (not (1 &lt;= 0) &amp;&amp; not ((m - 1) &lt;= 0))
      || (if (Ordinal.Int (if (m - 1) &gt;= 0 then m - 1 else 0)) :: … = …
          then … else …)
         Ordinal.&lt;&lt; …</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-75b1db7a-8900-4bf1-b5c0-a4d37205a200"><table><tr><td><b>into</b></td><td><pre>(not
 ((((n &lt;= 0 &amp;&amp; not (m &lt;= 0)) &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0)
   &amp;&amp; (if n &gt;= 0 then n else 0) &gt;= 0)
  &amp;&amp; (if m &gt;= 1 then -1 + m else 0) &gt;= 0)
 || m &lt;= 1)
|| Ordinal.plus (Ordinal.shift (Ordinal.Int …) (Ordinal.Int 1))
   (Ordinal.Int 1) Ordinal.&lt;&lt;
   Ordinal.plus (Ordinal.shift (Ordinal.Int …) (Ordinal.Int 1))
   (Ordinal.Int (if n &gt;= 0 then n else 0))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-316515b9-dbca-4701-a17d-16f272c57132"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.shift_156
  (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
  (Ordinal.Int_122 1))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>Ordinal.zero</pre></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-4aaa5d2e-8311-4770-96c3-65051636e549"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b7fa7a0b-c917-4c12-8f60-6996ee621963"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.shift_156
  (Ordinal.Int_122 (ite (&gt;= m_2578 1) (+ (- 1) m_2578) 0))
  (Ordinal.Int_122 1))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>Ordinal.zero</pre></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-bad26e1b-795f-40ca-a89d-c64d1bdd7aca"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 1) (+ (- 1) m_2578) 0))
…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-15ccdec1-5777-40dd-a1db-efa36526883c"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 1) (+ (- 1) m_2578) 0))
…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-475e22b1-1302-41b3-8f2f-e33da86f1290';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-4f53111e-cd7f-46ee-a453-ffcafc45c5c7';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-90383970-f954-453c-a0c8-edf935435594';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-46fdeb02-a7f9-4e5c-8680-f6b941245e2a';
  fold.hydrate(target);
});
</script></div><p></p><div class="imandra-fold panel panel-default" id="fold-fdb21af3-c5d3-41d8-b4eb-225afb577feb"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `ack (m - 1) (ack m (n - 1))` from `ack m n`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-8a468bb4-a3c6-4beb-8c31-fce11056d174"><table><tr><td><b>original</b></td><td>ack m n</td></tr><tr><td><b>sub</b></td><td>ack (m - 1) (ack m (n - 1))</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.of_list
((Ordinal.Int (if m &gt;= 0 then m else 0)) ::
 ((Ordinal.Int (if n &gt;= 0 then n else 0)) :: []))</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.of_list
((Ordinal.Int (if (m - 1) &gt;= 0 then m - 1 else 0)) ::
 ((Ordinal.Int (if ack m (n - 1) &gt;= 0 then ack m (n - 1) else 0)) :: []))</td></tr><tr><td><b>path</b></td><td>[not (n &lt;= 0) &amp;&amp; not (m &lt;= 0)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-d31bef32-184b-4f9f-a3a2-d03200382682"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-c61f078f-a498-4eb5-863d-9122fc474869"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-0a72d614-5d01-4c42-a84c-ce1e82f0e6c2"><table><tr><td><b>ground_instances</b></td><td>5</td></tr><tr><td><b>definitions</b></td><td>2</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.037s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-73c1686b-e670-46cf-b0a8-420746365bab"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-b2a1faf1-2edc-482f-874a-96e1c6c42d2f"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-f77b1794-55df-45ac-8618-1cb14ef55f66"><table><tr><td><b>num checks</b></td><td>12</td></tr><tr><td><b>arith assert lower</b></td><td>72</td></tr><tr><td><b>arith pivots</b></td><td>20</td></tr><tr><td><b>rlimit count</b></td><td>68099</td></tr><tr><td><b>mk clause</b></td><td>98</td></tr><tr><td><b>datatype occurs check</b></td><td>160</td></tr><tr><td><b>mk bool var</b></td><td>227</td></tr><tr><td><b>arith assert upper</b></td><td>24</td></tr><tr><td><b>datatype splits</b></td><td>8</td></tr><tr><td><b>decisions</b></td><td>162</td></tr><tr><td><b>arith add rows</b></td><td>21</td></tr><tr><td><b>arith bound prop</b></td><td>2</td></tr><tr><td><b>propagations</b></td><td>193</td></tr><tr><td><b>conflicts</b></td><td>20</td></tr><tr><td><b>arith fixed eqs</b></td><td>25</td></tr><tr><td><b>datatype accessor ax</b></td><td>32</td></tr><tr><td><b>arith conflicts</b></td><td>1</td></tr><tr><td><b>arith assert diseq</b></td><td>4</td></tr><tr><td><b>datatype constructor ax</b></td><td>18</td></tr><tr><td><b>num allocs</b></td><td>1852733309</td></tr><tr><td><b>final checks</b></td><td>8</td></tr><tr><td><b>added eqs</b></td><td>209</td></tr><tr><td><b>del clause</b></td><td>62</td></tr><tr><td><b>arith eq adapter</b></td><td>29</td></tr><tr><td><b>memory</b></td><td>18.430000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-73c1686b-e670-46cf-b0a8-420746365bab';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-f15e5802-7c32-4b08-9126-3d74da855e5e"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.037s]
  not (n &lt;= 0)
  &amp;&amp; not (m &lt;= 0)
     &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0
        &amp;&amp; (if n &gt;= 0 then n else 0) &gt;= 0
           &amp;&amp; (if (m - 1) &gt;= 0 then m - 1 else 0) &gt;= 0
              &amp;&amp; (if ack m (n - 1) &gt;= 0 then ack m (n - 1) else 0) &gt;= 0
  ==&gt; not (ack m (n - 1) &lt;= 0 &amp;&amp; not ((m - 1) &lt;= 0))
      &amp;&amp; not (not (ack m (n - 1) &lt;= 0) &amp;&amp; not ((m - 1) &lt;= 0))
         &amp;&amp; not (not (ack m (n - 1) &lt;= 0) &amp;&amp; not ((m - 1) &lt;= 0))
      || (if … then … else …) Ordinal.&lt;&lt; …</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-1fbe27de-944e-4610-b8b6-11fdbdada5ca"><table><tr><td><b>into</b></td><td><pre>(not
 (((((not (n &lt;= 0) &amp;&amp; not (m &lt;= 0)) &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0)
    &amp;&amp; (if n &gt;= 0 then n else 0) &gt;= 0)
   &amp;&amp; (if m &gt;= 1 then -1 + m else 0) &gt;= 0)
  &amp;&amp; (if ack m (-1 + n) &gt;= 0 then ack m (-1 + n) else 0) &gt;= 0)
 || not (ack m (-1 + n) &lt;= 0 &amp;&amp; not (m &lt;= 1))
    &amp;&amp; not (not (ack m (-1 + n) &lt;= 0) &amp;&amp; not (m &lt;= 1)))
|| Ordinal.plus (Ordinal.shift (Ordinal.Int …) (Ordinal.Int 1))
   (Ordinal.Int (if ack m (-1 + n) &gt;= 0 then ack m (-1 + n) else 0))
   Ordinal.&lt;&lt;
   Ordinal.plus (Ordinal.shift (Ordinal.Int …) (Ordinal.Int 1))
   (Ordinal.Int (if n &gt;= 0 then n else 0))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-264ee73c-19e0-4638-98c2-60810e699d82"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.shift_156
  (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
  (Ordinal.Int_122 1))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>Ordinal.zero</pre></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-aafe2f04-4997-4a90-9aa9-de6f15628b16"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-2c40f880-2a63-47fb-8b9a-9622c38c272b"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.shift_156
  (Ordinal.Int_122 (ite (&gt;= m_2578 1) (+ (- 1) m_2578) 0))
  (Ordinal.Int_122 1))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>Ordinal.zero</pre></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-1fe2f7fd-37aa-4fd6-9048-24974726946d"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 1) (+ (- 1) m_2578) 0))
…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-afde6e26-77a3-4990-9f1e-034026759f5c"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 1) (+ (- 1) m_2578) 0))
…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f15e5802-7c32-4b08-9126-3d74da855e5e';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-c61f078f-a498-4eb5-863d-9122fc474869';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-d31bef32-184b-4f9f-a3a2-d03200382682';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-fdb21af3-c5d3-41d8-b4eb-225afb577feb';
  fold.hydrate(target);
});
</script></div><p></p><div class="imandra-fold panel panel-default" id="fold-45241697-2d0c-4a30-9293-2d8570a3a044"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `ack m (n - 1)` from `ack m n`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-ecad79fd-c696-42c6-bb9b-e14fb241099f"><table><tr><td><b>original</b></td><td>ack m n</td></tr><tr><td><b>sub</b></td><td>ack m (n - 1)</td></tr><tr><td><b>original ordinal</b></td><td>Ordinal.of_list
((Ordinal.Int (if m &gt;= 0 then m else 0)) ::
 ((Ordinal.Int (if n &gt;= 0 then n else 0)) :: []))</td></tr><tr><td><b>sub ordinal</b></td><td>Ordinal.of_list
((Ordinal.Int (if m &gt;= 0 then m else 0)) ::
 ((Ordinal.Int (if (n - 1) &gt;= 0 then n - 1 else 0)) :: []))</td></tr><tr><td><b>path</b></td><td>[not (n &lt;= 0) &amp;&amp; not (m &lt;= 0)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-8f884446-9df9-4fd6-b076-31141d870a86"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-ab2aaec5-feb2-4707-bf37-636bfd4813a8"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-0268fc8b-8f22-4751-964d-a54e475e7d27"><table><tr><td><b>ground_instances</b></td><td>7</td></tr><tr><td><b>definitions</b></td><td>1</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.048s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-238afa3e-5e2a-43fd-b05d-e74623aae9a5"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-c3aa7505-39e7-46c3-9666-f93d4cfaab7e"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-af2bd184-73bd-4932-a12d-b588dcb0f1f0"><table><tr><td><b>arith offset eqs</b></td><td>3</td></tr><tr><td><b>num checks</b></td><td>16</td></tr><tr><td><b>arith assert lower</b></td><td>31</td></tr><tr><td><b>arith pivots</b></td><td>13</td></tr><tr><td><b>rlimit count</b></td><td>61514</td></tr><tr><td><b>mk clause</b></td><td>138</td></tr><tr><td><b>datatype occurs check</b></td><td>332</td></tr><tr><td><b>mk bool var</b></td><td>331</td></tr><tr><td><b>arith assert upper</b></td><td>17</td></tr><tr><td><b>datatype splits</b></td><td>23</td></tr><tr><td><b>decisions</b></td><td>238</td></tr><tr><td><b>arith add rows</b></td><td>22</td></tr><tr><td><b>arith bound prop</b></td><td>2</td></tr><tr><td><b>propagations</b></td><td>230</td></tr><tr><td><b>interface eqs</b></td><td>1</td></tr><tr><td><b>conflicts</b></td><td>22</td></tr><tr><td><b>arith fixed eqs</b></td><td>15</td></tr><tr><td><b>datatype accessor ax</b></td><td>58</td></tr><tr><td><b>arith conflicts</b></td><td>1</td></tr><tr><td><b>arith assert diseq</b></td><td>1</td></tr><tr><td><b>datatype constructor ax</b></td><td>39</td></tr><tr><td><b>num allocs</b></td><td>1815760255</td></tr><tr><td><b>final checks</b></td><td>14</td></tr><tr><td><b>added eqs</b></td><td>283</td></tr><tr><td><b>del clause</b></td><td>66</td></tr><tr><td><b>arith eq adapter</b></td><td>16</td></tr><tr><td><b>memory</b></td><td>15.550000</td></tr><tr><td><b>max memory</b></td><td>20.060000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-238afa3e-5e2a-43fd-b05d-e74623aae9a5';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-f6b469c8-4e79-4495-a5c8-a25a56bab29b"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.048s]
  not (n &lt;= 0)
  &amp;&amp; not (m &lt;= 0)
     &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0
        &amp;&amp; (if n &gt;= 0 then n else 0) &gt;= 0
           &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0
              &amp;&amp; (if (n - 1) &gt;= 0 then n - 1 else 0) &gt;= 0
  ==&gt; not ((n - 1) &lt;= 0 &amp;&amp; not (m &lt;= 0))
      &amp;&amp; not (not ((n - 1) &lt;= 0) &amp;&amp; not (m &lt;= 0))
         &amp;&amp; not (not ((n - 1) &lt;= 0) &amp;&amp; not (m &lt;= 0))
      || (if (Ordinal.Int (if m &gt;= 0 then m else 0)) ::
             ((Ordinal.Int (if (n - 1) &gt;= 0 then n - 1 else 0)) :: []) = 
             []
          then Ordinal.Int 0 else …)
         Ordinal.&lt;&lt; …</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-b4263781-c0ee-4c24-80e6-1d6abe57988a"><table><tr><td><b>into</b></td><td><pre>(not
 ((((not (n &lt;= 0) &amp;&amp; not (m &lt;= 0)) &amp;&amp; (if m &gt;= 0 then m else 0) &gt;= 0)
   &amp;&amp; (if n &gt;= 0 then n else 0) &gt;= 0)
  &amp;&amp; (if n &gt;= 1 then -1 + n else 0) &gt;= 0)
 || not (n &lt;= 1 &amp;&amp; not (m &lt;= 0)) &amp;&amp; not (not (n &lt;= 1) &amp;&amp; not (m &lt;= 0)))
|| Ordinal.plus (Ordinal.shift (Ordinal.Int …) (Ordinal.Int 1))
   (Ordinal.Int (if n &gt;= 1 then -1 + n else 0)) Ordinal.&lt;&lt;
   Ordinal.plus (Ordinal.shift (Ordinal.Int …) (Ordinal.Int 1))
   (Ordinal.Int (if n &gt;= 0 then n else 0))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b0647b55-019e-49dd-b27c-2d50845cd47f"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b7c5cb3f-d069-483a-b0b1-4e6529fde545"><table><tr><td><b>expr</b></td><td><pre>(Ordinal.shift_156
  (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
  (Ordinal.Int_122 1))</pre></td></tr><tr><td><b>expansions</b></td><td><pre>Ordinal.zero</pre></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-7d37746c-4e3c-45f2-a36a-e3a8774f06c1"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-f6a2799c-9508-46c4-a922-50d5bd48f78b"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-06b00847-5263-4596-94c5-aaaee52977dc"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-e62540eb-8461-4d66-9d1e-d66e09c86364"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-53b60140-d838-4b77-bb2e-537959de4675"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (Ordinal.shift_156
             (Ordinal.Int_122 (ite (&gt;= m_2578 0) m_2578 0))
          …</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f6b469c8-4e79-4495-a5c8-a25a56bab29b';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-ab2aaec5-feb2-4707-bf37-636bfd4813a8';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-8f884446-9df9-4fd6-b076-31141d870a86';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-45241697-2d0c-4a30-9293-2d8570a3a044';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-6f09636a-4894-424c-ac44-f3e98551292b';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Success! You may enjoy walking through Imandra's termination proof presented in the document above.</p>
<h1 id="Measures-and-Ordinals">Measures and Ordinals<a class="anchor-link" href="#Measures-and-Ordinals">&#182;</a></h1><p>If a lexicographic ordering isn't sufficient to prove termination for your function, you may need to construct a custom <em>measure function</em>.</p>
<p>A measure function is <em>ordinal valued</em>, meaning it returns a value of type <code>Ordinal.t</code>.</p>
<p>Imandra's <code>Ordinal</code> module comes with helpful tools for constructing ordinals.</p>
<p>Let's view its contents with the <code>#show</code> directive:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-37" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="o">#</span><span class="n">show</span> <span class="nc">Ordinal</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>module Ordinal :
  sig
    type t = private Int of int | Cons of t * int * t
    val pp : Format.formatter -&gt; t -&gt; unit
    val of_int : int -&gt; t
    val ( ~$ ) : int -&gt; t
    val ( &lt;&lt; ) : t -&gt; t -&gt; bool
    val plus : t -&gt; t -&gt; t
    val ( + ) : t -&gt; t -&gt; t
    val of_list : t list -&gt; t
    val shift : t -&gt; by:t -&gt; t
    val is_valid : t -&gt; bool
    val zero : t
    val one : t
    val omega : t
    val omega_omega : t
  end
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even though ordinals like $\omega$ are infinite, we may still compute with them in Imandra.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-39" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="nn">Ordinal</span><span class="p">.</span><span class="n">omega</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Ordinal.t = ω
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-40" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="nn">Ordinal</span><span class="p">.</span><span class="o">(</span><span class="n">omega</span> <span class="o">+</span> <span class="n">omega</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Ordinal.t = 2·ω
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-41" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="n">o1</span> <span class="o">=</span> <span class="nn">Ordinal</span><span class="p">.</span><span class="o">(</span><span class="n">omega</span> <span class="o">+</span> <span class="n">omega_omega</span> <span class="o">+</span> <span class="n">shift</span> <span class="n">omega</span> <span class="o">~</span><span class="n">by</span><span class="o">:(</span><span class="n">omega</span> <span class="o">+</span> <span class="n">one</span><span class="o">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[23]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val o1 : Ordinal.t = ω^(ω + 1)
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-42" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="nn">Ordinal</span><span class="p">.</span><span class="o">(</span><span class="n">o1</span> <span class="o">&lt;&lt;</span> <span class="n">omega_omega</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : bool = false
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ordinals are fundamental to program termination because they represent <a href="https://en.wikipedia.org/wiki/Well-founded_relation">well-founded orderings</a> (<a href="https://en.wikipedia.org/wiki/Well-order">well-orders</a>).</p>
<p>If we can prove that a function's recursive calls always get <em>smaller</em> with respect to some well-founded ordering, then we know the function will always terminate.</p>
<p>The fundamental well-founded relation in Imandra is <code>Ordinal.(&lt;&lt;)</code>. This is the strict, well-founded ordering relation on the ordinals up to <a href="https://en.wikipedia.org/wiki/Epsilon_numbers_%28mathematics%29">$\epsilon_0$</a>:</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4bf299b77978d2c51140c0a66c60d91d04e11de9"></p>
<p>Let's consider an example famous recursive function that we can't admit with a lexicographic order and see how we can write our own measure function and communicate it to Imandra.</p>
<h1 id="Left-pad">Left pad<a class="anchor-link" href="#Left-pad">&#182;</a></h1><p>Consider the following function <code>left_pad</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>let rec left_pad c n xs =
  if List.length xs &gt;= n then
    xs
  else
    left_pad c n (c :: xs)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we give this function to Imandra without any hints, it will not be able to prove it terminating.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-46" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">left_pad</span> <span class="n">c</span> <span class="n">n</span> <span class="n">xs</span> <span class="o">=</span>
  <span class="k">if</span> <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">xs</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="k">then</span>
    <span class="n">xs</span>
  <span class="k">else</span>
    <span class="n">left_pad</span> <span class="n">c</span> <span class="n">n</span> <span class="o">(</span><span class="n">c</span> <span class="o">::</span> <span class="n">xs</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val left_pad : &#39;a -&gt; int -&gt; &#39;a list -&gt; &#39;a list = &lt;fun&gt;
File &#34;jupyter cell 25&#34;, line 1, characters 0-96:
<span class="ansi-red-intense-fg ansi-bold">Error</span>: rejected definition for function left_pad,
Imandra could not prove termination. 
hint: problematic sub-call from `left_pad c n xs` to `left_pad c n (c :: xs)`
is not decreasing (measured subset: (xs))
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Counterexample (after 7 steps, 0.039s):
 type t = C_t_0 | C_t_1
 
</pre></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Why does this function terminate? If we think about it, we can realise that it terminates because in each recursive call, the quantity <code>n - List.length xs</code> is getting smaller. Moreover, under the guards governing the recursive calls, this quantity is always non-negative. So, let's construct an ordinal-valued measure function to express this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-48" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="n">left_pad_measure</span> <span class="n">n</span> <span class="n">xs</span> <span class="o">=</span>
  <span class="nn">Ordinal</span><span class="p">.</span><span class="n">of_int</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">xs</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val left_pad_measure : Z.t -&gt; &#39;a list -&gt; Ordinal.t = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can compute with this function, to really see it does what we want:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-50" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="n">left_pad_measure</span> <span class="mi">5</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[27]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : Ordinal.t = 2
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can give it to Imandra as the <code>measure</code> to use in proving <code>left_pad</code> terminates:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-52" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">left_pad</span> <span class="n">c</span> <span class="n">n</span> <span class="n">xs</span> <span class="o">=</span>
  <span class="k">if</span> <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">xs</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="k">then</span>
    <span class="n">xs</span>
  <span class="k">else</span>
    <span class="n">left_pad</span> <span class="n">c</span> <span class="n">n</span> <span class="o">(</span><span class="n">c</span> <span class="o">::</span> <span class="n">xs</span><span class="o">)</span>
<span class="o">[@@</span><span class="n">measure</span> <span class="n">left_pad_measure</span> <span class="n">n</span> <span class="n">xs</span><span class="o">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[28]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val left_pad : &#39;a -&gt; int -&gt; &#39;a list -&gt; &#39;a list = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-fold panel panel-default" id="fold-6789299d-208b-4aa6-b718-1d2d82ed1150"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>termination proof</span></div></div><div class="panel-body collapse"><div><h3>Termination proof</h3><p></p><div class="imandra-fold panel panel-default" id="fold-f7ce16b7-12ea-4074-8e3b-358db5fd26ba"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>call `left_pad c n (c :: xs)` from `left_pad c n xs`</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-c54edb03-ef99-41a8-9bc0-5723c384ada1"><table><tr><td><b>original</b></td><td>left_pad c n xs</td></tr><tr><td><b>sub</b></td><td>left_pad c n (c :: xs)</td></tr><tr><td><b>original ordinal</b></td><td>left_pad_measure n xs</td></tr><tr><td><b>sub ordinal</b></td><td>left_pad_measure n (c :: xs)</td></tr><tr><td><b>path</b></td><td>[not (List.length xs &gt;= n)]</td></tr><tr><td><b>proof</b></td><td><div class="imandra-fold panel panel-default" id="fold-5d255497-0b07-43af-8bfc-1592c5201341"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>detailed proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-06306bb7-1ac2-4b0a-8f75-d3b0d9143bb7"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-44dcaf35-8522-4d9b-b00d-8776e7774d58"><table><tr><td><b>ground_instances</b></td><td>2</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.018s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-2a41eb1e-335f-43a2-85ca-4082de0d4100"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-2ffa364d-5cb6-487a-8857-2733676dd27f"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-3e989ea8-9f4c-4d93-adf9-a27d875989a6"><table><tr><td><b>num checks</b></td><td>5</td></tr><tr><td><b>arith assert lower</b></td><td>9</td></tr><tr><td><b>arith pivots</b></td><td>5</td></tr><tr><td><b>rlimit count</b></td><td>78550</td></tr><tr><td><b>mk clause</b></td><td>7</td></tr><tr><td><b>datatype occurs check</b></td><td>20</td></tr><tr><td><b>mk bool var</b></td><td>36</td></tr><tr><td><b>arith assert upper</b></td><td>6</td></tr><tr><td><b>datatype splits</b></td><td>2</td></tr><tr><td><b>decisions</b></td><td>6</td></tr><tr><td><b>arith add rows</b></td><td>13</td></tr><tr><td><b>propagations</b></td><td>4</td></tr><tr><td><b>conflicts</b></td><td>3</td></tr><tr><td><b>arith fixed eqs</b></td><td>2</td></tr><tr><td><b>datatype accessor ax</b></td><td>5</td></tr><tr><td><b>arith conflicts</b></td><td>1</td></tr><tr><td><b>datatype constructor ax</b></td><td>2</td></tr><tr><td><b>num allocs</b></td><td>2038780341</td></tr><tr><td><b>final checks</b></td><td>4</td></tr><tr><td><b>added eqs</b></td><td>13</td></tr><tr><td><b>del clause</b></td><td>4</td></tr><tr><td><b>arith eq adapter</b></td><td>3</td></tr><tr><td><b>memory</b></td><td>21.840000</td></tr><tr><td><b>max memory</b></td><td>21.840000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-2a41eb1e-335f-43a2-85ca-4082de0d4100';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-d9ab3b0b-ef46-426c-ae39-b88af74ef60e"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.018s]
  not (List.length xs &gt;= n)
  &amp;&amp; (if (n - List.length xs) &gt;= 0 then n - List.length xs else 0) &gt;= 0
     &amp;&amp; (if (n - List.length (… :: xs)) &gt;= 0
         then n - List.length (… :: xs) else 0)
        &gt;= 0
  ==&gt; List.length (… :: xs) &gt;= n
      || Ordinal.Int
         (if (n - List.length (… :: xs)) &gt;= 0
          then n - List.length (… :: xs) else 0)
         Ordinal.&lt;&lt;
         Ordinal.Int
         (if (n - List.length xs) &gt;= 0 then n - List.length xs else 0)</pre></li><li><div><h5>simplify</h5><div class="imandra-table" id="table-298e3c49-f4ba-44aa-88c6-11e82edef236"><table><tr><td><b>into</b></td><td><pre>(not
 ((not (List.length xs &gt;= n)
   &amp;&amp; (if (n + -1 * List.length xs) &gt;= 0 then n + -1 * List.length xs else 0)
      &gt;= 0)
  &amp;&amp; (if (n + -1 * List.length (c :: xs)) &gt;= 0
      then n + -1 * List.length (c :: xs) else 0)
     &gt;= 0)
 || List.length (c :: xs) &gt;= n)
|| Ordinal.Int
   (if (n + -1 * List.length (c :: xs)) &gt;= 0
    then n + -1 * List.length (c :: xs) else 0)
   Ordinal.&lt;&lt;
   Ordinal.Int
   (if (n + -1 * List.length xs) &gt;= 0 then n + -1 * List.length xs else 0)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-c1198387-dc95-414d-a206-e9e271e959b3"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (+ n_2702 (* (- 1) (List.length_2698 (|::_3| c_2701 xs_2703)))))
      (a!2 (&gt;= (+ n_2702…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-e3952592-ec49-47dd-b43b-d38683547f89"><table><tr><td><b>expr</b></td><td><pre>(List.length_2698 (|::_3| c_2701 xs_2703))</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h5>unsat</h5><pre>(let ((a!1 (ite (&lt;= (+ (List.length_2698 xs_2703) (* (- 1) n_2702)) 0)
                (+ (* (- 1) (…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-d9ab3b0b-ef46-426c-ae39-b88af74ef60e';
  fold.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-06306bb7-1ac2-4b0a-8f75-d3b0d9143bb7';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-5d255497-0b07-43af-8bfc-1592c5201341';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f7ce16b7-12ea-4074-8e3b-358db5fd26ba';
  fold.hydrate(target);
});
</script></div><p></p></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-6789299d-208b-4aa6-b718-1d2d82ed1150';
  fold.hydrate(target);
});
</script></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Success! Note also how we only used two of <code>left_pad</code>'s three arguments in our measure. In general, economical measures are good, as they give us smaller <em>measured subsets</em>, which allow us to simplify more symbolic instances of our recursive functions during proof search. Moreover, they also affect how Imandra is able to use its <code>functional induction</code> (a.k.a. <code>recursion induction</code>) schemes.</p>
<p>We can find out the measured subset (and much other data) about our functions through the <code>#history</code> directive. It's also available with the handy alias <code>#h</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Proving%20Program%20Termination%20with%20Imandra.ipynb%23try-cell-54" target="_blank">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ocaml"><pre><span></span><span class="o">#</span><span class="n">history</span> <span class="n">left_pad</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[29]:</div>




<div class="output_text output_subarea output_execute_result">
<pre></pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div><h3>Fun: left_pad</h3><div class="imandra-table" id="table-2952f4de-5440-44de-8575-e577ebcd1cfe"><table><tr><td><b>iml</b></td><td><div class="imandra-fold panel panel-default" id="fold-eb2fcce8-7100-4d15-997e-54981a3bd735"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>definition</span></div></div><div class="panel-body collapse"><pre>fun (c : 'a) -&gt;
 fun (n : int) -&gt;
  fun (xs : 'a list) -&gt;
   if List.length xs &gt;= n then xs else left_pad c n (c :: xs)</pre></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-eb2fcce8-7100-4d15-997e-54981a3bd735';
  fold.hydrate(target);
});
</script></div></td></tr><tr><td><b>def</b></td><td><div class="imandra-table" id="table-8748962a-c8c4-4931-9267-afbf1d86505a"><table><tr><td><b>name</b></td><td>left_pad</td></tr><tr><td><b>type</b></td><td>'a -&gt; int -&gt; 'a list -&gt; 'a list</td></tr><tr><td><b>recursive</b></td><td>true</td></tr><tr><td><b>call signature</b></td><td>left_pad (c : 'a) (n : int) (xs : 'a list)</td></tr><tr><td><b>measured subset</b></td><td>[n; xs]</td></tr><tr><td><b>parametric</b></td><td>true</td></tr><tr><td><b>sub-function(s)</b></td><td><div class="imandra-fold panel panel-default" id="fold-5c528acb-2ce0-4e94-b5c7-84d230e59058"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-2ec599a8-bb66-4e36-99f5-a296598d4317"><table><tr><td><b>name</b></td><td>measure_fun.left_pad</td></tr><tr><td><b>type</b></td><td>int -&gt; 'a list -&gt; Ordinal.t</td></tr><tr><td><b>recursive</b></td><td>false</td></tr><tr><td><b>call signature</b></td><td>measure_fun.left_pad (n : int) (xs : 'a list)</td></tr><tr><td><b>body</b></td><td><pre>left_pad_measure n xs</pre></td></tr><tr><td><b>parametric</b></td><td>true</td></tr><tr><td><b>validated</b></td><td>true</td></tr><tr><td><b>location</b></td><td>jupyter cell 28:1,0--130</td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-5c528acb-2ce0-4e94-b5c7-84d230e59058';
  fold.hydrate(target);
});
</script></div></td></tr><tr><td><b>validated</b></td><td>true</td></tr><tr><td><b>location</b></td><td>jupyter cell 28:1,0--130</td></tr></table></div></td></tr></table></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Excellent! This concludes our brief introduction to program termination in Imandra.</p>

</div>
</div>
</div>
  
 


      </div><div class="content-nav">
          <ul>
          
            <li class="content-nav__item content-nav__item--h1"><a href="#Proving-Program-Termination">Proving Program Termination</a></li>
          
            <li class="content-nav__item content-nav__item--h2"><a href="#Inconsistent-non-terminating-functions">Inconsistent non-terminating functions</a></li>
          
            <li class="content-nav__item content-nav__item--h2"><a href="#Soundness,-Consistency-and-Conservative-Extensions">Soundness, Consistency and Conservative Extensions</a></li>
          
            <li class="content-nav__item content-nav__item--h2"><a href="#Termination-ensures-existence">Termination ensures existence</a></li>
          
            <li class="content-nav__item content-nav__item--h2"><a href="#Let's-get-our-hands-dirty">Let's get our hands dirty</a></li>
          
            <li class="content-nav__item content-nav__item--h1"><a href="#Structural-Recursions">Structural Recursions</a></li>
          
            <li class="content-nav__item content-nav__item--h1"><a href="#Ackermann-and-Admission-Hints">Ackermann and Admission Hints</a></li>
          
            <li class="content-nav__item content-nav__item--h2"><a href="#Lexicographic-termination-(up-to-$\omega^\omega$)">Lexicographic termination (up to $\omega^\omega$)</a></li>
          
            <li class="content-nav__item content-nav__item--h1"><a href="#Measures-and-Ordinals">Measures and Ordinals</a></li>
          
            <li class="content-nav__item content-nav__item--h1"><a href="#Left-pad">Left pad</a></li>
          
          </ul>
        </div></div>
  </div>
</body>
</html>
