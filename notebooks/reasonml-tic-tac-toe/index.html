<!DOCTYPE html>
<html>
    <head><meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Imandra Documentation - Tic Tac Toe with ReasonML</title>
        <meta property="og:url" content="https://docs.imandra.ai/imandra-docs/notebooks/reasonml-tic-tac-toe/">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Imandra Documentation - Tic Tac Toe with ReasonML">
        <meta property="og:description" content="As ReasonML syntax is just a frontend to OCaml, we can use ReasonML syntax with Imandra. Here we walk through a model of Tic Tac Toe (that we've attached a ReasonReact frontend to separately), and show how Imandra can help understand the various functions, as well as help check the model is functioning correctly.">
        <meta property="og:image" content="https://storage.googleapis.com/imandra-assets/images/og_image_default_i78.jpg">


        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116937440-6"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());

         gtag('config', 'UA-116937440-1');
        </script>
        <script type="text/javascript"> var sc_project=11767520; var sc_invisible=1; var sc_security="fa7e88d1"; </script>
        <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
        <noscript><div class="statcounter">
            <a title="Web Analytics" href="http://statcounter.com/" target="_blank">
                <img class="statcounter" src="//c.statcounter.com/11767520/0/fa7e88d1/1/" alt="Web Analytics"></a>
        </div></noscript>
        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,300i,400,400i%7CMerriweather:300,300i,400,400i%7CRoboto+Slab:300,300i,400,400i">

        <link rel="stylesheet" href="/imandra-docs/static/style/style.min.2726b43b.css" type="text/css">
        <link rel="stylesheet" href="/imandra-docs/static/nbextensions/nbimandra/styles.b466ce6f.css" type="text/css">
        <link rel="stylesheet" href="/imandra-docs/static/docs-styles.b9de737f.css" type="text/css">
        
        <link rel="stylesheet" href="/imandra-docs/static/jekyll-styles.c7923977.css" type="text/css">
        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="/imandra-docs/static/nbimandra-rjs-bundle.b85e58fd.js"></script>

        <style type="text/css">
         .highlight .hll { background-color: #ffffcc }
         .highlight  { background: #f8f8f8; }
         .highlight .c { color: #408080; font-style: italic } /* Comment */
         .highlight .err { border: 1px solid #FF0000 } /* Error */
         .highlight .k { color: #008000; font-weight: bold } /* Keyword */
         .highlight .o { color: #666666 } /* Operator */
         .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
         .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
         .highlight .cp { color: #BC7A00 } /* Comment.Preproc */
         .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
         .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
         .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
         .highlight .gd { color: #A00000 } /* Generic.Deleted */
         .highlight .ge { font-style: italic } /* Generic.Emph */
         .highlight .gr { color: #FF0000 } /* Generic.Error */
         .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
         .highlight .gi { color: #00A000 } /* Generic.Inserted */
         .highlight .go { color: #888888 } /* Generic.Output */
         .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
         .highlight .gs { font-weight: bold } /* Generic.Strong */
         .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
         .highlight .gt { color: #0044DD } /* Generic.Traceback */
         .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
         .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
         .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
         .highlight .kp { color: #008000 } /* Keyword.Pseudo */
         .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
         .highlight .kt { color: #B00040 } /* Keyword.Type */
         .highlight .m { color: #666666 } /* Literal.Number */
         .highlight .s { color: #BA2121 } /* Literal.String */
         .highlight .na { color: #7D9029 } /* Name.Attribute */
         .highlight .nb { color: #008000 } /* Name.Builtin */
         .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
         .highlight .no { color: #880000 } /* Name.Constant */
         .highlight .nd { color: #AA22FF } /* Name.Decorator */
         .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
         .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
         .highlight .nf { color: #0000FF } /* Name.Function */
         .highlight .nl { color: #A0A000 } /* Name.Label */
         .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
         .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
         .highlight .nv { color: #19177C } /* Name.Variable */
         .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
         .highlight .w { color: #bbbbbb } /* Text.Whitespace */
         .highlight .mb { color: #666666 } /* Literal.Number.Bin */
         .highlight .mf { color: #666666 } /* Literal.Number.Float */
         .highlight .mh { color: #666666 } /* Literal.Number.Hex */
         .highlight .mi { color: #666666 } /* Literal.Number.Integer */
         .highlight .mo { color: #666666 } /* Literal.Number.Oct */
         .highlight .sa { color: #BA2121 } /* Literal.String.Affix */
         .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
         .highlight .sc { color: #BA2121 } /* Literal.String.Char */
         .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
         .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
         .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
         .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
         .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
         .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
         .highlight .sx { color: #008000 } /* Literal.String.Other */
         .highlight .sr { color: #BB6688 } /* Literal.String.Regex */
         .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
         .highlight .ss { color: #19177C } /* Literal.String.Symbol */
         .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
         .highlight .fm { color: #0000FF } /* Name.Function.Magic */
         .highlight .vc { color: #19177C } /* Name.Variable.Class */
         .highlight .vg { color: #19177C } /* Name.Variable.Global */
         .highlight .vi { color: #19177C } /* Name.Variable.Instance */
         .highlight .vm { color: #19177C } /* Name.Variable.Magic */
         .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
        </style>

        <!-- Loading mathjax macro -->
        <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --><script>
  function handleCopyClick() {
      var el = this;
      var terminal = el.closest('.terminal');
      var highlight = terminal.getElementsByClassName('highlight')[0];
      copyToClipboardMsg(highlight);

      terminal.classList.add('terminal--hide');
      setTimeout(function () {
          terminal.classList.remove('terminal--hide');
      }, 2000);


      function copyToClipboardMsg(elem) {
          var succeed = copyToClipboard(elem);
          var msg;
          if (!succeed) {
              msg = 'Error!';
          } else {
              msg = 'Copied!';
          }

          var msgElem = terminal.querySelector('.terminal__copy-msg');
          msgElem.innerHTML = msg;
          setTimeout(function () {
              msgElem.innerHTML = 'You rock!';
          }, 1000);
      }

      function copyToClipboard(elem) {
          // create hidden text element, if it doesn't already exist
          var targetId = '_hiddenCopyText_';
          var isInput = elem.tagName === 'INPUT' || elem.tagName === 'TEXTAREA';
          var origSelectionStart, origSelectionEnd;
          if (isInput) {
              // can just use the original source element for the selection and copy
              target = elem;
              origSelectionStart = elem.selectionStart;
              origSelectionEnd = elem.selectionEnd;
          } else {
              // must use a temporary form element for the selection and copy
              target = terminal.querySelector('#' + targetId);
              if (!target) {
                  var target = document.createElement('textarea');
                  // target.style.display = 'flex';
                  // target.style.position = 'absolute';
                  // target.style.left = '-1000%';
                  target.id = targetId;
                 elem.appendChild(target);
              }
              target.textContent = elem.textContent.trim();
          }

          // select the content
          var currentFocus = document.activeElement;
          target.focus();
          target.setSelectionRange(0, target.value.length);

          // copy the selection
          var succeed;
          try {
              succeed = document.execCommand('copy');
          } catch (e) {
              succeed = false;
          }
          // restore original focus
          if (currentFocus && typeof currentFocus.focus === 'function') {
              currentFocus.focus();
          }

          if (isInput) {
              // restore prior selection
              elem.setSelectionRange(origSelectionStart, origSelectionEnd);
          } else {
              // clear temporary content
              elem.removeChild(target);
          }
          return succeed;
      }
  }
</script>
    </head>
    <body>
        <div class="background">
        </div>
        <div class="page-container">
            <main class="main-content-column">
                <!-- Jupyter (Imandra core docs) version -->
<header class="header">
    <div class="top-row-container">
        <div class="top-row">

            <div id="toggler--left" class="side__left-menu-toggler">
                <div class="side__toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p class="side__toggle-text">Docs</p>
            </div>

            <div class="side__logo-container">
                <a class="side__logo-link" href="/">
                    <img class="side__logo " src = "/imandra-docs/jekyll-resources/assets/img/imandra-gradient-logo-docs.svg">
                    <img class="side__logo--min " src="/imandra-docs/jekyll-resources/assets/img/imandra-gradient-logo-min.svg">

                </a>
            </div>

            <div id="toggler--right" class="side__right-menu-toggler">
                <p class="side__toggle-text">Pages</p>
                <div class="side__toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <nav class="side__nav-container side__nav-container--hidden">

                <ul class="side__nav-list">
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/">Documentation Home</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link side__nav-link--active" href="/imandra-docs">Imandra Core</a>
                        
                        <ul class="side__nav-list--sub-level-1">
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/welcome">A Quick Tour</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/installation">Installation</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-simple">Installer</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-manual-opam">Manual (opam)</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-docker">Docker Image</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-vscode">VSCode</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/installation-jupyter">Jupyter</a>
                                        
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/logic-and-program-modes">Logic and Program Modes</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/verification-commands">Verification</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-commands">Commands</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes">Attributes</a>
                                        
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes/#Verification-Hints">Verification Hints</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-attributes/#Rule-Classes">Rule Classes</a>
                                              
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-unrolling">Unrolling</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification">Simplification</a>
                                        
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification/#Rewrite-Rules">Rewrite Rules</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-simplification/#Forward-chaining-Rules">Forward-chaining Rules</a>
                                              
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-blast">Blast</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction">Induction</a>
                                        
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction/#Functional-Induction">Functional Induction</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-induction/#Structural-Induction">Structural Induction</a>
                                              
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall">Waterfall</a>
                                        
                                        
                                        <ul class="side__nav-list--sub-level-3">
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Simplification">Simplification</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Unrolling-check">Unrolling check</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Destructor-Elimination">Destructor Elimination</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Fertilization">Fertilization</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Generalization">Generalization</a>
                                              
                                            </li>
                                            
                                            <li class="side__nav-list-item--sub-level-3">
                                              
                                              <a class="side__nav-link" href="/imandra-docs/notebooks/verification-waterfall/#Induction">Induction</a>
                                              
                                            </li>
                                            
                                        </ul>
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/proving-program-termination">Proving Program Termination</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/decomposition-flags">Region Decomposition</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/imandra-tools-intro">Imandra Tools Introduction</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/idf">Iterative Decomposition Framework</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/region-probabilities">Region Probabilities</a>
                                        
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/loading-files">Multifile development</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/extracting-ocaml-modules-with-imandra-extract">Extracting OCaml modules with imandra-extract</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/plugins">Using code generation and plugins</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/examples">Examples</a>
                                
                                <ul class="side__nav-list--sub-level-2  side__nav-list--sub-level-2--active">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/recursion-induction-and-rewriting">Recursion, Induction and Rewriting</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verifying-merge-sort">Verifying Merge Sort in Imandra</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/ubs-case-study">Analysing the UBS ATS Dark Pool</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/six-swiss-exchange-pricing">Region Decomposition - Exchange Pricing</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/webservice-auth-logic">Analysing Web-app Authentication Logic</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/simple-vehicle-controller">Simple Vehicle Controller</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/simple-stoplight-model">Simple Car Intersection model</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/ripple-carry-adder">Verifying a Ripple Carry Adder</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/verifying-an-ros-node">Creating and Verifying a ROS Node</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link side__nav-link--active" href="/imandra-docs/notebooks/reasonml-tic-tac-toe">Tic Tac Toe with ReasonML</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/probabilistic-reasoning-in-reasonml">Probabilistic Reasoning in ReasonML</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/sudoku">Solving Sudoku with Imandra</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/crossing-river-safely">Crossing the River Safely</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/reasonml-facetime-state-machines">Exploring The Apple FaceTime Bug with ReasonML State Machines</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/key-pair-security">Key Pair Security in Imandra</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/a-comparison-with-tla-plus">A comparison with TLA+</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/solver-synthesis">Synthesising a Game Solver in Imandra</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/notebooks/supervised-learning">Analysing Machine Learning Models</a>
                                        
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li class="side__nav-list-item--sub-level-1">
                                
                                <a class="side__nav-link" href="/imandra-docs/notebooks/reference">Reference</a>
                                
                                <ul class="side__nav-list--sub-level-2 ">
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/odoc/imandra-base/Imandra_prelude/">Standard Library</a>
                                        
                                        
                                    </li>
                                    
                                    <li class="side__nav-list-item--sub-level-2">
                                        
                                        <a class="side__nav-link" href="/imandra-docs/odoc/">API Docs</a>
                                        
                                        
                                    </li>
                                    
                                </ul>
                            </li>
                            
                        </ul>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/idf-py">Py IDF</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/ipl">Imandra Protocol Language</a>
                        
                    </li>
                    
                    <li class="side__nav-list-item">
                        <a class="side__nav-link" href="/fix-engine">FIX Engine</a>
                        
                    </li>
                    
                </ul>
            </nav>
        </div>
    </div>

    <div class="background">
    </div>



    <div class="template-header">
        <div class="top-bar">
            <nav class="top-bar__nav-container">
                <a href="#" class="top-bar__toggle">≡</a>
                <div class="top-nav-bar__group ">
                    <div class="top-nav-bar__nav nav-bar--blue top-nav-bar__nav--hidden">
                        <ul class="top-nav-bar__links top-nav-bar__links--hidden-smaller-than-tablet">
                            <li class="top-nav-bar__item">
                                <a href="https://www.imandra.ai/" class="top-nav-bar__link">Home</a>
                            </li>
                            <li class="top-nav-bar__item">
                                <a href="https://try.imandra.ai/" class="top-nav-bar__link">Try</a>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--engine">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Engine</a>
                                <ul class="dropdown-content dropdown-content--engine">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--core--menu.svg" alt="Imandra Core" title="Imandra Core Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/core">Imandra Core</a></li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--docs--menu.svg" alt="Docs" title="Docs Icon">
                                        <a class="dropdown__link" href="https://docs.imandra.ai/">Docs</a></li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--research--menu.svg" alt="Research" title="Research Icon">
                                        <a class="dropdown__link dropdown__link--last" href="https://www.imandra.ai/research">Research</a></li>
                                </ul>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--industries">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Industries</a>
                                <ul class="dropdown-content dropdown-content--industries">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--financial--menu.svg" alt="Financial Markets" title="Financial Markets Icon">
                                        <a class="dropdown__link " href="https://www.imandra.ai/imarkets">Financial Markets</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--autonomy--menu.svg" alt="Autonomous Systems" title="Autonomous Systems Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/autonomy">Autonomous Systems</a>
                                    </li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--ml--menu.svg" alt="Machine Learning" title="Machine Learning Icon">
                                        <a class="dropdown__link dropdown__coming-soon dropdown__link--last ">Machine Learning</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--media">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Media</a>
                                <ul class="dropdown-content dropdown-content--media">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--media--menu.svg" alt="Media" title="Media Icon">
                                        <a class="dropdown__link " href="https://www.imandra.ai/media">Media</a></li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--blog--menu.svg" alt="Blog" title="Blog Icon">
                                        <a class="dropdown__link dropdown__link--last " href="https://medium.com/imandra">Blog</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="top-nav-bar__item top-nav-bar__item--group dropdown--company">
                                <a class="top-nav-bar__link top-nav-bar__link--group">Company</a>
                                <ul class="dropdown-content dropdown-content--company">
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--about--menu.svg" alt="About" title="About Icon">
                                        <a class="dropdown__link" href="https://www.imandra.ai/about">About</a></li>
                                    <li class="dropdown__item dropdown__item--with-icon">
                                        <img class="dropdown__icon" src="/imandra-docs/jekyll-resources/assets/img/icon--careers--menu.svg" alt=" Careers" title="Careers Icon">
                                        <a class="dropdown__link dropdown__link--last dropdown__link--bottom" href="https://www.imandra.ai/careers">Careers</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>

        <div class="template-header__image-container template-header__image-container--jupyter">
            <div class="template-header__image" href ="/imandra-docs">
                <img class="site-specific-image" src="/imandra-docs/static/img/site_specific_image_v_2.svg">
            </div>
        </div>

    </div>



    <script>
        document.getElementById('toggler--left').addEventListener('click', function () {
            document.querySelector('.side__right-menu-toggler .side__toggle').classList.remove(
                'side__toggle--active');
            document.querySelector('.side__left-menu-toggler .side__toggle').classList.toggle(
                'side__toggle--active');
            document.getElementsByClassName('side__nav-container')[0].classList.toggle(
                'side__nav-container--hidden');
            document.getElementsByClassName('top-nav-bar__nav')[0].classList.add('top-nav-bar__nav--hidden');
        });

        document.getElementById('toggler--right').addEventListener('click', function () {
            document.querySelector('.side__left-menu-toggler .side__toggle').classList.remove(
                'side__toggle--active');
            document.querySelector('.side__right-menu-toggler .side__toggle').classList.toggle(
                'side__toggle--active');

            document.getElementsByClassName('side__nav-container')[0].classList.add(
                'side__nav-container--hidden');
            document.getElementsByClassName('top-nav-bar__nav')[0].classList.toggle(
                'top-nav-bar__nav--hidden');
        });
    </script>
</header>
                <article class="article__container article__container--notebooks">
                    <div class="main-content main-content--jupyter">
                        
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Tic-Tac-Toe-with-ReasonML">Tic Tac Toe with ReasonML<a class="anchor-link" href="#Tic-Tac-Toe-with-ReasonML">&#182;</a></h1><p>ReasonML provides an alternative syntax for OCaml, which Imandra can read. Let's walk through an example ReasonML model of Tic Tac Toe and use Imandra to understand and verify some properties of it.</p>
<p>This model is wired into some ReasonReact components in order to produce <a href="https://docs.imandra.ai/reasonml-tic-tac-toe/">this final, playable version</a>. You can see the model code and components as a ReasonReact project in <a href="https://github.com/AestheticIntegration/reasonml-tic-tac-toe">this github repo</a>.</p>
<h2 id="Setting-up-the-model">Setting up the model<a class="anchor-link" href="#Setting-up-the-model">&#182;</a></h2><p>Let's start by adding some definitions for the player, state of a square on the game grid, and the grid itself.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-2" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>type player =
  | X
  | O;
  
/* the state of a particular square - None = (no move yet), Some(X/O) = either X or O has moved there */
type square_state = option(player);

/* each letter represents a square on the grid, starting in the top left and going along each row */
type grid = {
  a: square_state,
  b: square_state,
  c: square_state,
  d: square_state,
  e: square_state,
  f: square_state,
  g: square_state,
  h: square_state,
  i: square_state,
};
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type player = X | O
type square_state = player option
type grid = {
  a : square_state;
  b : square_state;
  c : square_state;
  d : square_state;
  e : square_state;
  f : square_state;
  g : square_state;
  h : square_state;
  i : square_state;
}
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>(NB: we're inputting in Reason syntax, but Imandra currently outputs OCaml syntax - this is something we'll have resolved very soon!).</p>
<h2 id="Grid-document-printer">Grid document printer<a class="anchor-link" href="#Grid-document-printer">&#182;</a></h2><p>Here's an example grid:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-4" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let a_grid = {
  a: Some(O),
  b: Some(X),
  c: Some(O),
  d: None,
  e: None,
  f: Some(X),
  g: None,
  h: None,
  i: None,
};
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val a_grid : grid =
  {a = Some O; b = Some X; c = Some O; d = None; e = None; f = Some X;
   g = None; h = None; i = None}
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As you can tell, it's not the easiest thing to interpret from Imandra's output given the way we've described the grid. Let's setup a custom document mapping for the grid type. Imandra will render the <code>Document</code> data structures as richer output to display our types in a clearer way:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-6" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>[@program] let doc_of_square_state = (s : square_state) =&gt;
  Document.s(switch (s) {
  | Some(X) =&gt; &quot;❌&quot; /* emojis! */
  | Some(O) =&gt; &quot;⭕&quot;
  | None =&gt; &quot;·&quot;
});

[@program] let doc_of_grid = (g: grid) =&gt; {
  let f = doc_of_square_state;
  Document.tbl([[f(g.a), f(g.b), f(g.c)], [f(g.d), f(g.e), f(g.f)], [f(g.g), f(g.h), f(g.i)]])
};
[@install_doc doc_of_grid];
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val doc_of_square_state : square_state -&gt; Imandra_surface.Document.t = &lt;fun&gt;
val doc_of_grid : grid -&gt; Imandra_surface.Document.t = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-7" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>a_grid
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : grid = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-29ab79ce-e6ff-4ab5-bf29-3f36591ab392"><table><tr><td>⭕</td><td>❌</td><td>⭕</td></tr><tr><td>·</td><td>·</td><td>❌</td></tr><tr><td>·</td><td>·</td><td>·</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Much better! The <code>[@program]</code> annotation tells Imandra that we're only going to be using these functions for non-analytical (and potentially side-effecting) operations, and that it doesn't have to worry about analysing them. See <a href="/imandra-docs/notebooks/logic-and-program-modes/">Logic and program modes</a> for more information.</p>
<h2 id="More-definitions">More definitions<a class="anchor-link" href="#More-definitions">&#182;</a></h2><p>Let's continue adding some more definitions:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-9" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>/* maps to the grid entries */
type move =
  | A
  | B
  | C
  | D
  | E
  | F
  | G
  | H
  | I;

/* the full game state - the current grid, and who went last */
type game_state = {
  grid,
  last_player: option(player),
};

type game_status =
  | Won(player)
  | InProgress
  | InvalidMove(move)
  | Tied;

let initial_game = {
  grid: {
    a: None,
    b: None,
    c: None,
    d: None,
    e: None,
    f: None,
    g: None,
    h: None,
    i: None,
  },
  last_player: None,
};

let initial_player = X;

/* convenience function from our move variant to the value in that grid position */
let value = ({grid: {a, b, c, d, e, f, g, h, i}, _}) =&gt;
  fun
  | A =&gt; a
  | B =&gt; b
  | C =&gt; c
  | D =&gt; d
  | E =&gt; e
  | F =&gt; f
  | G =&gt; g
  | H =&gt; h
  | I =&gt; i;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type move = A | B | C | D | E | F | G | H | I
type game_state = { grid : grid; last_player : player option; }
type game_status = Won of player | InProgress | InvalidMove of move | Tied
val initial_game : game_state = {grid = &lt;document&gt;; last_player = None}
val initial_player : player = X
val value : game_state -&gt; move -&gt; square_state = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-9d10d8fc-eb7a-4b79-8ae4-f5eb9fddbee4"><table><tr><td>·</td><td>·</td><td>·</td></tr><tr><td>·</td><td>·</td><td>·</td></tr><tr><td>·</td><td>·</td><td>·</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Game-state-document-printer">Game state document printer<a class="anchor-link" href="#Game-state-document-printer">&#182;</a></h2><p>Let's also add another document for printing <code>game_state</code>s, showing both the grid and who went last:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-11" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>[@program] let doc_of_game_state = (gs: game_state) =&gt; {
  Document.tbl([[doc_of_grid(gs.grid), Document.s(&quot;Last:&quot;), doc_of_square_state(gs.last_player)]])
};

[@install_doc doc_of_game_state];

initial_game;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val doc_of_game_state : game_state -&gt; Imandra_surface.Document.t = &lt;fun&gt;
- : game_state = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-a21dc3b7-fa37-4247-9c85-d13d323b6831"><table><tr><td><div class="imandra-table" id="table-02d842f0-5697-4dfd-b8c8-b00e1a06c10e"><table><tr><td>·</td><td>·</td><td>·</td></tr><tr><td>·</td><td>·</td><td>·</td></tr><tr><td>·</td><td>·</td><td>·</td></tr></table></div></td><td>Last:</td><td>·</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Some-logic-and-our-first-instance">Some logic and our first instance<a class="anchor-link" href="#Some-logic-and-our-first-instance">&#182;</a></h2><p>Now for our first bit of proper logic - whether or not a game is won for a particular player:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-13" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let is_winning = ({grid: {a, b, c, d, e, f, g, h, i}, _}, player) =&gt; {
  let winning_state = (Some(player), Some(player), Some(player));
  (a, b, c) == winning_state
  || (d, e, f) == winning_state
  || (g, h, i) == winning_state
  || (a, d, g) == winning_state
  || (b, e, h) == winning_state
  || (c, f, i) == winning_state
  || (a, e, i) == winning_state
  || (c, e, g) == winning_state;
};
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val is_winning : game_state -&gt; player -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's use Imandra to get a feel for this function - let's ask for an instance of a game where the game is being won by the player X. We use Imandra's <code>instance</code> mechanism, and ask for a game <code>g</code> where the predicate <code>is_winning(g, X)</code> is true:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-15" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>instance((g : game_state) =&gt; is_winning(g, X));
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; bool = &lt;fun&gt;
module CX : sig val g : game_state end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Instance (after 0 steps, 0.046s):
 let (g : game_state) =
   {grid =
     {a = (Some X); b = (Some X); c = (Some X); d = (Some X); e = (Some X);
      f = (Some X); g = (Some X); h = None; i = None};
    last_player = None}
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px solid green; border-bottom: 1px solid green"><i class="fa fa-check-circle" style="margin-right: 0.5em; color: green"></i><span>Instance</span></div><div><div class="imandra-alternatives" id="alt-d63b83ff-77b4-4a72-aa17-956aedc6f240"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-94869b5e-e692-470e-8c6d-8cbd53c659d8"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;(((((((g.grid.a = Some X &amp;&amp; g.grid.b = Some X) &amp;&amp; g.grid.c = Some X\l      \|\| (g.grid.d = Some X &amp;&amp; g.grid.e = Some X) &amp;&amp; g.grid.f = Some X)\l     \|\| (g.grid.g = Some X &amp;&amp; g.grid.h = Some X) &amp;&amp; g.grid.i = Some X)\l    \|\| (g.grid.a = Some X &amp;&amp; g.grid.d = Some X) &amp;&amp; g.grid.g = Some X)\l   \|\| (g.grid.b = Some X &amp;&amp; g.grid.e = Some X) &amp;&amp; g.grid.h = Some X)\l  \|\| (g.grid.c = Some X &amp;&amp; g.grid.f = Some X) &amp;&amp; g.grid.i = Some X)\l \|\| (g.grid.a = Some X &amp;&amp; g.grid.e = Some X) &amp;&amp; g.grid.i = Some X)\l\|\| (g.grid.c = Some X &amp;&amp; g.grid.e = Some X) &amp;&amp; g.grid.g = Some X&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-94869b5e-e692-470e-8c6d-8cbd53c659d8';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-f61a37ce-6e9f-4ea9-9719-c4cb3d11adfb"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-3ed8ae61-840a-4e7a-9f50-f4ecf8ab65f1"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-b83d37f0-5567-4863-b8af-dc8f6565eb8d"><table><tr><td><b>ground_instances</b></td><td>0</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.046s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-3fce3307-d5b4-4881-ab2d-e950eb18196c"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-2aa7fe1d-ff89-4802-9925-a62ec3cf3584"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-90f5497d-d947-41c4-8ad3-7ff9d3eb89f0"><table><tr><td><b>num checks</b></td><td>1</td></tr><tr><td><b>rlimit count</b></td><td>1594</td></tr><tr><td><b>mk clause</b></td><td>40</td></tr><tr><td><b>datatype occurs check</b></td><td>1</td></tr><tr><td><b>mk bool var</b></td><td>149</td></tr><tr><td><b>datatype splits</b></td><td>41</td></tr><tr><td><b>decisions</b></td><td>39</td></tr><tr><td><b>propagations</b></td><td>32</td></tr><tr><td><b>conflicts</b></td><td>7</td></tr><tr><td><b>datatype accessor ax</b></td><td>7</td></tr><tr><td><b>datatype constructor ax</b></td><td>58</td></tr><tr><td><b>num allocs</b></td><td>3255266</td></tr><tr><td><b>final checks</b></td><td>1</td></tr><tr><td><b>added eqs</b></td><td>275</td></tr><tr><td><b>memory</b></td><td>7.500000</td></tr><tr><td><b>max memory</b></td><td>8.050000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-3fce3307-d5b4-4881-ab2d-e950eb18196c';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-86082c74-77e4-47bf-888a-0e149eb72aed"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.046s]
  (:var_0:.grid.a, :var_0:.grid.b, :var_0:.grid.c) = (Some X, Some X, Some X)
  || (:var_0:.grid.d, :var_0:.grid.e, :var_0:.grid.f) =
     (Some X, Some X, Some X)
     || (:var_0:.grid.g, :var_0:.grid.h, :var_0:.grid.i) =
        (Some X, Some X, Some X)
        || (:var_0:.grid.a, :var_0:.grid.d, :var_0:.grid.g) =
           (Some X, Some X, Some X)
           || (:var_0:.grid.b, :var_0:.grid.e, :var_0:.grid.h) =
              (Some X, Some X, Some X)
              || (:var_0:.grid.c, :var_0:.grid.f, :var_0:.grid.i) =
                 (Some X, Some X, Some X)
                 || (:var_0:.grid.a, :var_0:.grid.e, :var_0:.grid.i) =
                    (Some X, Some X, Some X)
                    || (:var_0:.grid.c, :var_0:.grid.e, :var_0:.grid.g) =
                       (Some X, Some X, Some X)</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-73129a3e-ea3d-4487-9406-deb6f1146cfb"><table><tr><td><b>into</b></td><td><pre>(((((((:var_0:.grid.a = Some X &amp;&amp; :var_0:.grid.b = Some X)
      &amp;&amp; :var_0:.grid.c = Some X
      || (:var_0:.grid.d = Some X &amp;&amp; :var_0:.grid.e = Some X)
         &amp;&amp; :var_0:.grid.f = Some X)
     || (:var_0:.grid.g = Some X &amp;&amp; :var_0:.grid.h = Some X)
        &amp;&amp; :var_0:.grid.i = Some X)
    || (:var_0:.grid.a = Some X &amp;&amp; :var_0:.grid.d = Some X)
       &amp;&amp; :var_0:.grid.g = Some X)
   || (:var_0:.grid.b = Some X &amp;&amp; :var_0:.grid.e = Some X)
      &amp;&amp; :var_0:.grid.h = Some X)
  || (:var_0:.grid.c = Some X &amp;&amp; :var_0:.grid.f = Some X)
     &amp;&amp; :var_0:.grid.i = Some X)
 || (:var_0:.grid.a = Some X &amp;&amp; :var_0:.grid.e = Some X)
    &amp;&amp; :var_0:.grid.i = Some X)
|| (:var_0:.grid.c = Some X &amp;&amp; :var_0:.grid.e = Some X)
   &amp;&amp; :var_0:.grid.g = Some X</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let (g : game_state) =
   {grid =
     {a = (Some X); b = (Some X); c = (Some X); d = (Some X); e = (Some X);
      f = (Some X); g = (Some X); h = None; i = None};
    last_player = None}
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-86082c74-77e4-47bf-888a-0e149eb72aed';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-242717f1-968d-4238-939a-3c5ef0926fbc"><textarea style="display: none">digraph &quot;proof&quot; {
p_2 [label=&quot;Start ((:var_0:.grid.a, :var_0:.grid.b, :var_0:.grid.c) =\l       (Some X, Some X, Some X)\l       \|\| (:var_0:.grid.d, :var_0:.grid.e, :var_0:.grid.f) =\l          (Some X, Some X, Some X)\l          \|\| (:var_0:.grid.g, :var_0:.grid.h, :var_0:.grid.i) =\l             (Some X, Some X, Some X)\l             \|\| (:var_0:.grid.a, :var_0:.grid.d, :var_0:.grid.g) =\l                (Some X, Some X, Some X)\l                \|\| (:var_0:.grid.b, :var_0:.grid.e, :var_0:.grid.h) =\l                   (Some X, Some X, Some X)\l                   \|\| (:var_0:.grid.c, :var_0:.grid.f, :var_0:.grid.i) =\l                      (Some X, Some X, Some X)\l                      \|\| (:var_0:.grid.a, :var_0:.grid.e, :var_0:.grid.i) =\l                         (Some X, Some X, Some X)\l                         \|\| (:var_0:.grid.c, :var_0:.grid.e, :var_0:.grid.g)\l                            = (Some X, Some X, Some X)\l       :time 0.046s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_2 -&gt; p_1 [label=&quot;&quot;];
p_1 [label=&quot;Simplify ((((((((:var_0:.grid.a = Some X &amp;&amp; :var_0:.grid.b = Some X)\l                &amp;&amp; :var_0:.grid.c = Some X\l                \|\| (:var_0:.grid.d = Some X &amp;&amp; :var_0:.grid.e = Some X)\l                   &amp;&amp; :var_0:.grid.f = Some X)\l               \|\| (:var_0:.grid.g = Some X &amp;&amp; :var_0:.grid.h = Some X)\l                  &amp;&amp; :var_0:.grid.i = Some X)\l              \|\| (:var_0:.grid.a = Some X &amp;&amp; :var_0:.grid.d = Some X)\l                 &amp;&amp; :var_0:.grid.g = Some X)\l             \|\| (:var_0:.grid.b = Some X &amp;&amp; :var_0:.grid.e = Some X)\l                &amp;&amp; :var_0:.grid.h = Some X)\l            \|\| (:var_0:.grid.c = Some X &amp;&amp; :var_0:.grid.f = Some X)\l               &amp;&amp; :var_0:.grid.i = Some X)\l           \|\| (:var_0:.grid.a = Some X &amp;&amp; :var_0:.grid.e = Some X)\l              &amp;&amp; :var_0:.grid.i = Some X)\l          \|\| (:var_0:.grid.c = Some X &amp;&amp; :var_0:.grid.e = Some X)\l             &amp;&amp; :var_0:.grid.g = Some X\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_1 -&gt; p_0 [label=&quot;&quot;];
p_0 [label=&quot;Sat (Some  let (g : game_state) =\l   \{grid =\l     \{a = (Some X); b = (Some X); c = (Some X); d = (Some X); e = (Some X);\l      f = (Some X); g = (Some X); h = None; i = None\};\l    last_player = None\}\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-242717f1-968d-4238-939a-3c5ef0926fbc';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-3ed8ae61-840a-4e7a-9f50-f4ecf8ab65f1';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-f61a37ce-6e9f-4ea9-9719-c4cb3d11adfb';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-d63b83ff-77b4-4a72-aa17-956aedc6f240';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Rather than executing our function with random inputs as you might imagine, Imandra has examined our definitions mathematically, and generated an instance that matches what we asked for based on the code itself, without executing it directly. This means we don't have to write generators as we would if we were using a library like QuickCheck for example. We can also use Imandra's other tools, such as state space decomposition, to identify edge cases we may not have thought about. See the other documentation pages/notebooks for more detail.</p>
<p>In this case we explicitly annotated the type of <code>g</code> as <code>game_state</code>, but if this can be inferred using the usual ReasonML/OCaml inference rules, it can be omitted.</p>
<p><code>instance</code> has also reflected the value it found back into our Imandra session, so we can take a look at it:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-17" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>CX.g
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-e7c09932-5285-4cbf-aa81-8b1708ba2fae"><table><tr><td><div class="imandra-table" id="table-5f50c6f6-92b2-43e4-8f7d-a9cf82bdfcc3"><table><tr><td>❌</td><td>❌</td><td>❌</td></tr><tr><td>❌</td><td>❌</td><td>❌</td></tr><tr><td>❌</td><td>·</td><td>·</td></tr></table></div></td><td>Last:</td><td>·</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>and compute with it:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-19" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>is_winning(CX.g, X)
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : bool = true
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can see here that <code>X</code> is definitely 'winning', although the game doesn't look particularly valid. <code>O</code> hasn't made any moves, and the game state hasn't got a <code>last_player</code> set. That's fine for now though, we'll build up additional layers in our logic to handle these other cases. It can be very useful to see a concrete example of our function in action!</p>
<h2 id="Valid-grids">Valid grids<a class="anchor-link" href="#Valid-grids">&#182;</a></h2><p>Let's continue:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-21" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let other_player =
  fun
  | X =&gt; O
  | O =&gt; X;

/* count up the number of moves for each player across the whole grid - sounds useful! */
let move_counts = ({a, b, c, d, e, f, g, h, i}) =&gt;
  List.fold_right(
    (el, (x, o)) =&gt;
      switch (el) {
      | None =&gt; (x, o)
      | Some(X) =&gt; (x + 1, o)
      | Some(O) =&gt; (x, o + 1)
      },
    ~base=(0, 0),
    [a, b, c, d, e, f, g, h, i],
  );

/* whether a grid is &#39;valid&#39; - the difference between move totals should never be more than 1 */
/* with these rules, either player can go first so we check that one player is never too far ahead */
let is_valid_grid = (grid, last_player) =&gt; {
  let (x, o) = move_counts(grid);
  if (x &gt; o) {
    last_player == Some(X) &amp;&amp; x - o == 1;
  } else if (x &lt; o) {
    last_player == Some(O) &amp;&amp; o - x == 1;
  } else {
    true;
  };
};
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val other_player : player -&gt; player = &lt;fun&gt;
val move_counts : grid -&gt; Z.t * Z.t = &lt;fun&gt;
val is_valid_grid : grid -&gt; player option -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's grab a game where the grid is valid:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-23" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>instance((game) =&gt; is_valid_grid(game.grid, game.last_player));
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; bool = &lt;fun&gt;
module CX : sig val game : game_state end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Instance (after 10 steps, 0.092s):
 let (game : game_state) =
   {grid =
     {a = (Some O); b = (Some X); c = (Some O); d = None; e = (Some O);
      f = None; g = (Some X); h = (Some X); i = (Some X)};
    last_player = (Some X)}
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px solid green; border-bottom: 1px solid green"><i class="fa fa-check-circle" style="margin-right: 0.5em; color: green"></i><span>Instance</span></div><div><div class="imandra-alternatives" id="alt-4cc5845c-3dec-4ae5-9a6a-051201b1a9d9"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-49f01725-7dc0-43a0-83ba-7655a954d49b"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;if (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).0\l   \&lt;=\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).1\lthen\l  (List.fold_right\l   (fun el _x\l    -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l       if el = None then (x, o)\l       else\l       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l   (0, 0) (….a :: (… :: …))).1\l  \&lt;=\l  (List.fold_right\l   (fun el _x\l    -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l       if el = None then (x, o)\l       else\l       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l   (0, 0) (….a :: (… :: …))).0\l  \|\| game.last_player = Some O\l     &amp;&amp; (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).1\l        + -1\l          * (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l        = 1\lelse\l  game.last_player = Some X\l  &amp;&amp; (List.fold_right\l      (fun el _x\l       -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l          if el = None then (x, o)\l          else\l          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l          else (x, o + 1))\l      (0, 0) (….a :: (… :: …))).0\l     + -1\l       * (List.fold_right\l          (fun el _x\l           -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l              if el = None then (x, o)\l              else\l              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l              else (x, o + 1))\l          (0, 0) (….a :: (… :: …))).1\l     = 1&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3274 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3274 -&gt; expr_3625 [label=&quot;=&quot;];
expr_3625 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (game.grid.a ::\l                 (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3288 -&gt; call_3274 [label=&quot;calls&quot;];
expr_3288 -&gt; call_3274 [label=&quot;calls&quot;];
expr_3288 -&gt; call_3274 [label=&quot;calls&quot;];
call_115 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_115 -&gt; expr_559 [label=&quot;=&quot;];
expr_559 [label=&quot;if game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))) = []\lthen (0, 0)\lelse\lif List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   &amp;&amp; Option.get\l      (List.hd\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_115 [label=&quot;calls&quot;];
call_1208 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1208 -&gt; expr_1556 [label=&quot;=&quot;];
expr_1556 [label=&quot;if List.tl\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1222 -&gt; call_1208 [label=&quot;calls&quot;];
expr_1222 -&gt; call_1208 [label=&quot;calls&quot;];
expr_1222 -&gt; call_1208 [label=&quot;calls&quot;];
call_2607 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2607 -&gt; expr_2963 [label=&quot;=&quot;];
expr_2963 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2621 -&gt; call_2607 [label=&quot;calls&quot;];
expr_2621 -&gt; call_2607 [label=&quot;calls&quot;];
expr_2621 -&gt; call_2607 [label=&quot;calls&quot;];
call_2282 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2282 -&gt; expr_2621 [label=&quot;=&quot;];
expr_2621 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2296 -&gt; call_2282 [label=&quot;calls&quot;];
expr_2296 -&gt; call_2282 [label=&quot;calls&quot;];
expr_2296 -&gt; call_2282 [label=&quot;calls&quot;];
call_2949 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2949 -&gt; expr_3288 [label=&quot;=&quot;];
expr_3288 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2963 -&gt; call_2949 [label=&quot;calls&quot;];
expr_2963 -&gt; call_2949 [label=&quot;calls&quot;];
expr_2963 -&gt; call_2949 [label=&quot;calls&quot;];
call_847 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_847 -&gt; expr_1222 [label=&quot;=&quot;];
expr_1222 [label=&quot;if List.tl\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_861 -&gt; call_847 [label=&quot;calls&quot;];
expr_861 -&gt; call_847 [label=&quot;calls&quot;];
expr_861 -&gt; call_847 [label=&quot;calls&quot;];
call_1542 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1542 -&gt; expr_1916 [label=&quot;=&quot;];
expr_1916 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1556 -&gt; call_1542 [label=&quot;calls&quot;];
expr_1556 -&gt; call_1542 [label=&quot;calls&quot;];
expr_1556 -&gt; call_1542 [label=&quot;calls&quot;];
call_540 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_540 -&gt; expr_861 [label=&quot;=&quot;];
expr_861 [label=&quot;if List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_559 -&gt; call_540 [label=&quot;calls&quot;];
expr_559 -&gt; call_540 [label=&quot;calls&quot;];
expr_559 -&gt; call_540 [label=&quot;calls&quot;];
call_3611 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3625 -&gt; call_3611 [label=&quot;calls&quot;];
expr_3625 -&gt; call_3611 [label=&quot;calls&quot;];
expr_3625 -&gt; call_3611 [label=&quot;calls&quot;];
call_1902 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1902 -&gt; expr_2296 [label=&quot;=&quot;];
expr_2296 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1916 -&gt; call_1902 [label=&quot;calls&quot;];
expr_1916 -&gt; call_1902 [label=&quot;calls&quot;];
expr_1916 -&gt; call_1902 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-49f01725-7dc0-43a0-83ba-7655a954d49b';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-aa2f5aa2-23ae-4434-b749-8bf176630201"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-4e454688-9691-4e4a-8b0d-fc022b8a4515"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-346c7f7a-c4dd-46c7-b9fc-a2ad149950cc"><table><tr><td><b>ground_instances</b></td><td>10</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.092s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-fedd973a-b482-4545-82f0-539f67f10bc8"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-da31dc8a-ed20-41b2-b39d-011eb349a1b4"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-2b57a655-7265-4aea-8fe3-0accb81d6748"><table><tr><td><b>arith offset eqs</b></td><td>342</td></tr><tr><td><b>num checks</b></td><td>21</td></tr><tr><td><b>arith assert lower</b></td><td>291</td></tr><tr><td><b>arith pivots</b></td><td>147</td></tr><tr><td><b>rlimit count</b></td><td>43310</td></tr><tr><td><b>mk clause</b></td><td>311</td></tr><tr><td><b>datatype occurs check</b></td><td>225</td></tr><tr><td><b>mk bool var</b></td><td>1624</td></tr><tr><td><b>arith assert upper</b></td><td>279</td></tr><tr><td><b>datatype splits</b></td><td>130</td></tr><tr><td><b>decisions</b></td><td>528</td></tr><tr><td><b>arith add rows</b></td><td>694</td></tr><tr><td><b>arith bound prop</b></td><td>27</td></tr><tr><td><b>propagations</b></td><td>1055</td></tr><tr><td><b>interface eqs</b></td><td>9</td></tr><tr><td><b>conflicts</b></td><td>43</td></tr><tr><td><b>arith fixed eqs</b></td><td>310</td></tr><tr><td><b>datatype accessor ax</b></td><td>122</td></tr><tr><td><b>arith assert diseq</b></td><td>48</td></tr><tr><td><b>datatype constructor ax</b></td><td>720</td></tr><tr><td><b>num allocs</b></td><td>7227460</td></tr><tr><td><b>final checks</b></td><td>20</td></tr><tr><td><b>added eqs</b></td><td>4340</td></tr><tr><td><b>del clause</b></td><td>158</td></tr><tr><td><b>arith eq adapter</b></td><td>211</td></tr><tr><td><b>memory</b></td><td>12.110000</td></tr><tr><td><b>max memory</b></td><td>12.110000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-fedd973a-b482-4545-82f0-539f67f10bc8';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-0e8de795-1a6c-427d-b08f-0ce4dac2c1f8"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.092s]
  if (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).0
     &gt;
     (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).1
  then
    :var_0:.last_player = Some X
    &amp;&amp; (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       -
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
       = 1
  else
  if (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).0
     &lt;
     (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).1
  then
    :var_0:.last_player = Some O
    &amp;&amp; (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
       -
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       = 1
  else true</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-9da162fe-1cd0-4b84-991f-d7f7fe390030"><table><tr><td><b>into</b></td><td><pre>if (List.fold_right
    (fun el _x
     -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
        if el = None then (x, o)
        else
        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
        else (x, o + 1))
    (0, 0) (….a :: (… :: …))).0
   &lt;=
   (List.fold_right
    (fun el _x
     -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
        if el = None then (x, o)
        else
        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
        else (x, o + 1))
    (0, 0) (….a :: (… :: …))).1
then
  (List.fold_right
   (fun el _x
    -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
       if el = None then (x, o)
       else
       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))
   (0, 0) (….a :: (… :: …))).1
  &lt;=
  (List.fold_right
   (fun el _x
    -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
       if el = None then (x, o)
       else
       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))
   (0, 0) (….a :: (… :: …))).0
  || :var_0:.last_player = Some O
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).1
        + -1
          * (List.fold_right
             (fun el _x
              -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                 if el = None then (x, o)
                 else
                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                 else (x, o + 1))
             (0, 0) (….a :: (… :: …))).0
        = 1
else
  :var_0:.last_player = Some X
  &amp;&amp; (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).0
     + -1
       * (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
     = 1</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-426954dc-bf54-4074-93b7-16c11d66388e"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-52fe1f26-b668-4565-8c8f-4b415d514969"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-250fa72f-75de-4c5c-bd4f-26184ce1a729"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-f5a4a868-e93f-401b-8a7f-541ea6f771b0"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-f4fb6aae-b095-4cc4-a963-f7630670fbdb"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-acd63ccd-55e5-4842-ae0d-240887c8f8c6"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-28878382-dbb9-4dc9-8fa3-5f4d70342166"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-08c0bcec-eb40-4ed1-9853-6a764295e811"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-73d5549e-d384-430a-b672-811a64bf5d18"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-c4b6c581-bf14-4bcd-9078-4c0b5a17ee9e"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_99))
                   (|::_3| (i_27 (grid_40 game_99)) |[]_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let (game : game_state) =
   {grid =
     {a = (Some O); b = (Some X); c = (Some O); d = None; e = (Some O);
      f = None; g = (Some X); h = (Some X); i = (Some X)};
    last_player = (Some X)}
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-0e8de795-1a6c-427d-b08f-0ce4dac2c1f8';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-fd5191df-183b-4436-86d0-6ca862317136"><textarea style="display: none">digraph &quot;proof&quot; {
p_15 [label=&quot;Start (if (List.fold_right\l           (fun el _x\l            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l               if el = None then (x, o)\l               else\l               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l               else (x, o + 1))\l           (0, 0) (….a :: (… :: …))).0\l          \&gt;\l          (List.fold_right\l           (fun el _x\l            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l               if el = None then (x, o)\l               else\l               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l               else (x, o + 1))\l           (0, 0) (….a :: (… :: …))).1\l       then\l         :var_0:.last_player = Some X\l         &amp;&amp; (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            -\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l            = 1\l       else\l       if (List.fold_right\l           (fun el _x\l            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l               if el = None then (x, o)\l               else\l               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l               else (x, o + 1))\l           (0, 0) (….a :: (… :: …))).0\l          \&lt;\l          (List.fold_right\l           (fun el _x\l            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l               if el = None then (x, o)\l               else\l               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l               else (x, o + 1))\l           (0, 0) (….a :: (… :: …))).1\l       then\l         :var_0:.last_player = Some O\l         &amp;&amp; (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l            -\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            = 1\l       else true :time 0.092s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_15 -&gt; p_14 [label=&quot;&quot;];
p_14 [label=&quot;Simplify (if (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             \&lt;=\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l          then\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l            \&lt;=\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \|\| :var_0:.last_player = Some O\l               &amp;&amp; (List.fold_right\l                   (fun el _x\l                    -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                       if el = None then (x, o)\l                       else\l                       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                       else (x, o + 1))\l                   (0, 0) (….a :: (… :: …))).1\l                  + -1\l                    * (List.fold_right\l                       (fun el _x\l                        -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                           if el = None then (x, o)\l                           else\l                           if Is_a(Some, el) &amp;&amp; Option.get el = X\l                           then (x + 1, o) else (x, o + 1))\l                       (0, 0) (….a :: (… :: …))).0\l                  = 1\l          else\l            :var_0:.last_player = Some X\l            &amp;&amp; (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).0\l               + -1\l                 * (List.fold_right\l                    (fun el _x\l                     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                        if el = None then (x, o)\l                        else\l                        if Is_a(Some, el) &amp;&amp; Option.get el = X\l                        then (x + 1, o) else (x, o + 1))\l                    (0, 0) (….a :: (… :: …))).1\l               = 1\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_14 -&gt; p_13 [label=&quot;&quot;];
p_13 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….grid.a :: (….grid.b :: (… :: …)))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_13 -&gt; p_12 [label=&quot;&quot;];
p_12 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_12 -&gt; p_11 [label=&quot;&quot;];
p_11 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_11 -&gt; p_10 [label=&quot;&quot;];
p_10 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_10 -&gt; p_9 [label=&quot;&quot;];
p_9 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_9 -&gt; p_8 [label=&quot;&quot;];
p_8 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_8 -&gt; p_7 [label=&quot;&quot;];
p_7 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_7 -&gt; p_6 [label=&quot;&quot;];
p_6 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_6 -&gt; p_5 [label=&quot;&quot;];
p_5 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_5 -&gt; p_4 [label=&quot;&quot;];
p_4 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl\l                 (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_4 -&gt; p_3 [label=&quot;&quot;];
p_3 [label=&quot;Sat (Some  let (game : game_state) =\l   \{grid =\l     \{a = (Some O); b = (Some X); c = (Some O); d = None; e = (Some O);\l      f = None; g = (Some X); h = (Some X); i = (Some X)\};\l    last_player = (Some X)\}\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-fd5191df-183b-4436-86d0-6ca862317136';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-4e454688-9691-4e4a-8b0d-fc022b8a4515';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-aa2f5aa2-23ae-4434-b749-8bf176630201';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-4cc5845c-3dec-4ae5-9a6a-051201b1a9d9';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-24" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>CX.game;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-74667f12-2d98-46b1-8f37-c8f1853da8b5"><table><tr><td><div class="imandra-table" id="table-fd223975-769f-41b0-9837-e1ceacf00ab7"><table><tr><td>⭕</td><td>❌</td><td>⭕</td></tr><tr><td>·</td><td>⭕</td><td>·</td></tr><tr><td>❌</td><td>❌</td><td>❌</td></tr></table></div></td><td>Last:</td><td>❌</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is a bit better - the grid looks more reasonable now. Interestingly, we notice that the valid grid Imandra gave us is also 'winning'. We can see this by computing with the CX:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-26" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>is_winning(CX.game, O);
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : bool = false
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This begs the question - have we inadvertantly specified that every valid game is a winning game? Let's ask Imandra for an instance where this isn't the case to make sure:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-28" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>instance((game, player) =&gt; is_valid_grid(game.grid, game.last_player) &amp;&amp; !is_winning(game, player));
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; player -&gt; bool = &lt;fun&gt;
module CX : sig val game : game_state val player : player end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Instance (after 10 steps, 0.071s):
 let (game : game_state) =
   {grid =
     {a = (Some O); b = None; c = (Some X); d = None; e = (Some X); f = None;
      g = (Some X); h = (Some O); i = None};
    last_player = (Some X)}
 let (player : player) = O
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px solid green; border-bottom: 1px solid green"><i class="fa fa-check-circle" style="margin-right: 0.5em; color: green"></i><span>Instance</span></div><div><div class="imandra-alternatives" id="alt-334299b3-4097-4ae6-9c1e-644657df0157"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-195e49c2-385a-485d-a8c3-687ea4e086fb"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;(if (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).0\l    \&lt;=\l    (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).1\l then\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).1\l   \&lt;=\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).0\l   \|\| game.last_player = Some O\l      &amp;&amp; (List.fold_right\l          (fun el _x\l           -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l              if el = None then (x, o)\l              else\l              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l              else (x, o + 1))\l          (0, 0) (….a :: (… :: …))).1\l         + -1\l           * (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l         = 1\l else\l   (game.last_player = Some X\l    &amp;&amp; (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).0\l       + -1\l         * (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l       = 1))\l&amp;&amp; not\l   ((((((((….a = Some player &amp;&amp; … = Some player) &amp;&amp; ….c = Some player\l          \|\| (….d = Some player &amp;&amp; ….e = Some player)\l             &amp;&amp; ….f = Some player)\l         \|\| (….g = Some player &amp;&amp; ….h = Some player)\l            &amp;&amp; ….i = Some player)\l        \|\| (….a = Some player &amp;&amp; ….d = Some player)\l           &amp;&amp; ….g = Some player)\l       \|\| (… = Some player &amp;&amp; ….e = Some player) &amp;&amp; ….h = Some player)\l      \|\| (….c = Some player &amp;&amp; ….f = Some player) &amp;&amp; ….i = Some player)\l     \|\| (….a = Some player &amp;&amp; ….e = Some player) &amp;&amp; ….i = Some player)\l    \|\| (….c = Some player &amp;&amp; ….e = Some player) &amp;&amp; ….g = Some player)&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1437 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1437 -&gt; expr_1812 [label=&quot;=&quot;];
expr_1812 [label=&quot;if List.tl\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1451 -&gt; call_1437 [label=&quot;calls&quot;];
expr_1451 -&gt; call_1437 [label=&quot;calls&quot;];
expr_1451 -&gt; call_1437 [label=&quot;calls&quot;];
call_2135 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2135 -&gt; expr_2478 [label=&quot;=&quot;];
expr_2478 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2149 -&gt; call_2135 [label=&quot;calls&quot;];
expr_2149 -&gt; call_2135 [label=&quot;calls&quot;];
expr_2149 -&gt; call_2135 [label=&quot;calls&quot;];
call_1061 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1061 -&gt; expr_1451 [label=&quot;=&quot;];
expr_1451 [label=&quot;if List.tl\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1075 -&gt; call_1061 [label=&quot;calls&quot;];
expr_1075 -&gt; call_1061 [label=&quot;calls&quot;];
expr_1075 -&gt; call_1061 [label=&quot;calls&quot;];
call_2464 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2464 -&gt; expr_2859 [label=&quot;=&quot;];
expr_2859 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2478 -&gt; call_2464 [label=&quot;calls&quot;];
expr_2478 -&gt; call_2464 [label=&quot;calls&quot;];
expr_2478 -&gt; call_2464 [label=&quot;calls&quot;];
call_199 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_199 -&gt; expr_772 [label=&quot;=&quot;];
expr_772 [label=&quot;if game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))) = []\lthen (0, 0)\lelse\lif List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   &amp;&amp; Option.get\l      (List.hd\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_199 [label=&quot;calls&quot;];
call_3871 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3885 -&gt; call_3871 [label=&quot;calls&quot;];
expr_3885 -&gt; call_3871 [label=&quot;calls&quot;];
expr_3885 -&gt; call_3871 [label=&quot;calls&quot;];
call_756 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_756 -&gt; expr_1075 [label=&quot;=&quot;];
expr_1075 [label=&quot;if List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_772 -&gt; call_756 [label=&quot;calls&quot;];
expr_772 -&gt; call_756 [label=&quot;calls&quot;];
expr_772 -&gt; call_756 [label=&quot;calls&quot;];
call_1798 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1798 -&gt; expr_2149 [label=&quot;=&quot;];
expr_2149 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1812 -&gt; call_1798 [label=&quot;calls&quot;];
expr_1812 -&gt; call_1798 [label=&quot;calls&quot;];
expr_1812 -&gt; call_1798 [label=&quot;calls&quot;];
call_3178 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3178 -&gt; expr_3525 [label=&quot;=&quot;];
expr_3525 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3192 -&gt; call_3178 [label=&quot;calls&quot;];
expr_3192 -&gt; call_3178 [label=&quot;calls&quot;];
expr_3192 -&gt; call_3178 [label=&quot;calls&quot;];
call_2845 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2845 -&gt; expr_3192 [label=&quot;=&quot;];
expr_3192 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2859 -&gt; call_2845 [label=&quot;calls&quot;];
expr_2859 -&gt; call_2845 [label=&quot;calls&quot;];
expr_2859 -&gt; call_2845 [label=&quot;calls&quot;];
call_3511 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3511 -&gt; expr_3885 [label=&quot;=&quot;];
expr_3885 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (game.grid.a ::\l                 (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3525 -&gt; call_3511 [label=&quot;calls&quot;];
expr_3525 -&gt; call_3511 [label=&quot;calls&quot;];
expr_3525 -&gt; call_3511 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-195e49c2-385a-485d-a8c3-687ea4e086fb';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-5b9eee75-6e97-49d7-a227-55ed81fef989"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-6e10606f-a8bc-42dd-a287-c8f5e33d4f5e"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-f0a29a9f-288a-48c1-b34c-2a23515a1fcf"><table><tr><td><b>ground_instances</b></td><td>10</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.071s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-06e9de5d-4c45-40c4-ae8c-0d45bdb57c52"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-a9b57ac4-c6db-49e2-8cd9-68985c72522b"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-29185365-748c-4d1c-83eb-af3371b38f3f"><table><tr><td><b>arith offset eqs</b></td><td>607</td></tr><tr><td><b>num checks</b></td><td>21</td></tr><tr><td><b>arith assert lower</b></td><td>469</td></tr><tr><td><b>arith pivots</b></td><td>247</td></tr><tr><td><b>rlimit count</b></td><td>89593</td></tr><tr><td><b>mk clause</b></td><td>574</td></tr><tr><td><b>datatype occurs check</b></td><td>212</td></tr><tr><td><b>mk bool var</b></td><td>2036</td></tr><tr><td><b>arith assert upper</b></td><td>439</td></tr><tr><td><b>datatype splits</b></td><td>152</td></tr><tr><td><b>decisions</b></td><td>858</td></tr><tr><td><b>arith add rows</b></td><td>1779</td></tr><tr><td><b>arith bound prop</b></td><td>90</td></tr><tr><td><b>propagations</b></td><td>1879</td></tr><tr><td><b>interface eqs</b></td><td>10</td></tr><tr><td><b>conflicts</b></td><td>83</td></tr><tr><td><b>arith fixed eqs</b></td><td>551</td></tr><tr><td><b>datatype accessor ax</b></td><td>141</td></tr><tr><td><b>minimized lits</b></td><td>25</td></tr><tr><td><b>arith conflicts</b></td><td>11</td></tr><tr><td><b>arith assert diseq</b></td><td>69</td></tr><tr><td><b>datatype constructor ax</b></td><td>665</td></tr><tr><td><b>num allocs</b></td><td>14629241</td></tr><tr><td><b>final checks</b></td><td>21</td></tr><tr><td><b>added eqs</b></td><td>6179</td></tr><tr><td><b>del clause</b></td><td>272</td></tr><tr><td><b>arith eq adapter</b></td><td>355</td></tr><tr><td><b>memory</b></td><td>16.530000</td></tr><tr><td><b>max memory</b></td><td>16.530000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-06e9de5d-4c45-40c4-ae8c-0d45bdb57c52';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-00e0813c-fa98-4950-a57f-b607f60bf186"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.071s]
  (if (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      &gt;
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1
   then
     :var_0:.last_player = Some X
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).0
        -
        (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).1
        = 1
   else
   if (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      &lt;
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1
   then
     :var_0:.last_player = Some O
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).1
        -
        (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).0
        = 1
   else true)
  &amp;&amp; not
     ((….a, …, ….c) = (Some :var_1:, Some :var_1:, Some :var_1:)
      || (….d, ….e, ….f) = (Some :var_1:, Some :var_1:, Some :var_1:)
         || (….g, ….h, ….i) =
            (Some :var_1:, Some :var_1:, Some :var_1:)
            || (….a, ….d, ….g) =
               (Some :var_1:, Some :var_1:, Some :var_1:)
               || (…, ….e, ….h) =
                  (Some :var_1:, Some :var_1:, Some :var_1:)
                  || (….c, ….f, ….i) =
                     (Some :var_1:, Some :var_1:, Some :var_1:)
                     || (….a, ….e, ….i) =
                        (Some :var_1:, Some :var_1:, Some :var_1:)
                        || (….c, ….e, ….g) =
                           (Some :var_1:, Some :var_1:, Some :var_1:))</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-5f3d208f-3ecf-4399-89fa-aaed60f531d0"><table><tr><td><b>into</b></td><td><pre>(if (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).0
    &lt;=
    (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).1
 then
   (List.fold_right
    (fun el _x
     -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
        if el = None then (x, o)
        else
        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
        else (x, o + 1))
    (0, 0) (….a :: (… :: …))).1
   &lt;=
   (List.fold_right
    (fun el _x
     -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
        if el = None then (x, o)
        else
        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
        else (x, o + 1))
    (0, 0) (….a :: (… :: …))).0
   || :var_0:.last_player = Some O
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         + -1
           * (List.fold_right
              (fun el _x
               -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                  if el = None then (x, o)
                  else
                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                  else (x, o + 1))
              (0, 0) (….a :: (… :: …))).0
         = 1
 else
   (:var_0:.last_player = Some X
    &amp;&amp; (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       + -1
         * (List.fold_right
            (fun el _x
             -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                if el = None then (x, o)
                else
                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                else (x, o + 1))
            (0, 0) (….a :: (… :: …))).1
       = 1))
&amp;&amp; not
   ((((((((….a = Some :var_1: &amp;&amp; … = Some :var_1:)
          &amp;&amp; ….c = Some :var_1:
          || (….d = Some :var_1: &amp;&amp; ….e = Some :var_1:)
             &amp;&amp; ….f = Some :var_1:)
         || (….g = Some :var_1: &amp;&amp; ….h = Some :var_1:)
            &amp;&amp; ….i = Some :var_1:)
        || (….a = Some :var_1: &amp;&amp; ….d = Some :var_1:)
           &amp;&amp; ….g = Some :var_1:)
       || (… = Some :var_1: &amp;&amp; ….e = Some :var_1:)
          &amp;&amp; ….h = Some :var_1:)
      || (….c = Some :var_1: &amp;&amp; ….f = Some :var_1:)
         &amp;&amp; ….i = Some :var_1:)
     || (….a = Some :var_1: &amp;&amp; ….e = Some :var_1:)
        &amp;&amp; ….i = Some :var_1:)
    || (….c = Some :var_1: &amp;&amp; ….e = Some :var_1:) &amp;&amp; ….g = Some :var_1:)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6c90766c-3876-4a29-80fe-629c18616da6"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-db8ef54e-5810-4507-901a-61af33b9a4e7"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-e659fc34-afad-49e4-8088-389ef9511ac9"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6c894cb6-dbf4-42e8-b0eb-f22cf10aab4c"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-6f6dab69-4e19-4902-ab22-ee3001b5f37f"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-067046b4-8965-4262-91cb-dce1b76066b3"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-57e886d7-0403-4c89-8e23-26586f163658"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-1b5c10ab-55d1-4732-b132-798c76d3f55e"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-898af981-8286-430c-9cfc-d720da929ec8"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-39a99ba4-83e5-48f8-985a-abffe1fe1d78"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_101))
                   (|::_3| (i_27 (grid_40 game_101)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let (game : game_state) =
   {grid =
     {a = (Some O); b = None; c = (Some X); d = None; e = (Some X); f = None;
      g = (Some X); h = (Some O); i = None};
    last_player = (Some X)}
 let (player : player) = O
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-00e0813c-fa98-4950-a57f-b607f60bf186';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-018a560d-ac7a-4b06-8249-c4f082e36ad1"><textarea style="display: none">digraph &quot;proof&quot; {
p_28 [label=&quot;Start ((if (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           \&gt;\l           (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l        then\l          :var_0:.last_player = Some X\l          &amp;&amp; (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             -\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             = 1\l        else\l        if (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           \&lt;\l           (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l        then\l          :var_0:.last_player = Some O\l          &amp;&amp; (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             -\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             = 1\l        else true)\l       &amp;&amp; not\l          ((….a, …, ….c) = (Some :var_1:, Some :var_1:, Some :var_1:)\l           \|\| (….d, ….e, ….f) =\l              (Some :var_1:, Some :var_1:, Some :var_1:)\l              \|\| (….g, ….h, ….i) =\l                 (Some :var_1:, Some :var_1:, Some :var_1:)\l                 \|\| (….a, ….d, ….g) =\l                    (Some :var_1:, Some :var_1:, Some :var_1:)\l                    \|\| (…, ….e, ….h) =\l                       (Some :var_1:, Some :var_1:, Some :var_1:)\l                       \|\| (….c, ….f, ….i) =\l                          (Some :var_1:, Some :var_1:, Some :var_1:)\l                          \|\| (….a, ….e, ….i) =\l                             (Some :var_1:, Some :var_1:, Some :var_1:)\l                             \|\| (….c, ….e, ….g) =\l                                (Some :var_1:, Some :var_1:, Some :var_1:))\l       :time 0.071s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_28 -&gt; p_27 [label=&quot;&quot;];
p_27 [label=&quot;Simplify ((if (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              \&lt;=\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l           then\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             \&lt;=\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             \|\| :var_0:.last_player = Some O\l                &amp;&amp; (List.fold_right\l                    (fun el _x\l                     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                        if el = None then (x, o)\l                        else\l                        if Is_a(Some, el) &amp;&amp; Option.get el = X\l                        then (x + 1, o) else (x, o + 1))\l                    (0, 0) (….a :: (… :: …))).1\l                   + -1\l                     * (List.fold_right\l                        (fun el _x\l                         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                            if el = None then (x, o)\l                            else\l                            if Is_a(Some, el) &amp;&amp; Option.get el = X\l                            then (x + 1, o) else (x, o + 1))\l                        (0, 0) (….a :: (… :: …))).0\l                   = 1\l           else\l             (:var_0:.last_player = Some X\l              &amp;&amp; (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).0\l                 + -1\l                   * (List.fold_right\l                      (fun el _x\l                       -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                          if el = None then (x, o)\l                          else\l                          if Is_a(Some, el) &amp;&amp; Option.get el = X\l                          then (x + 1, o) else (x, o + 1))\l                      (0, 0) (….a :: (… :: …))).1\l                 = 1))\l          &amp;&amp; not\l             ((((((((….a = Some :var_1: &amp;&amp; … = Some :var_1:)\l                    &amp;&amp; ….c = Some :var_1:\l                    \|\| (….d = Some :var_1: &amp;&amp; ….e = Some :var_1:)\l                       &amp;&amp; ….f = Some :var_1:)\l                   \|\| (….g = Some :var_1: &amp;&amp; ….h = Some :var_1:)\l                      &amp;&amp; ….i = Some :var_1:)\l                  \|\| (….a = Some :var_1: &amp;&amp; ….d = Some :var_1:)\l                     &amp;&amp; ….g = Some :var_1:)\l                 \|\| (… = Some :var_1: &amp;&amp; ….e = Some :var_1:)\l                    &amp;&amp; ….h = Some :var_1:)\l                \|\| (….c = Some :var_1: &amp;&amp; ….f = Some :var_1:)\l                   &amp;&amp; ….i = Some :var_1:)\l               \|\| (….a = Some :var_1: &amp;&amp; ….e = Some :var_1:)\l                  &amp;&amp; ….i = Some :var_1:)\l              \|\| (….c = Some :var_1: &amp;&amp; ….e = Some :var_1:)\l                 &amp;&amp; ….g = Some :var_1:)\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_27 -&gt; p_26 [label=&quot;&quot;];
p_26 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….grid.a :: (….grid.b :: (… :: …)))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_26 -&gt; p_25 [label=&quot;&quot;];
p_25 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_25 -&gt; p_24 [label=&quot;&quot;];
p_24 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_24 -&gt; p_23 [label=&quot;&quot;];
p_23 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_23 -&gt; p_22 [label=&quot;&quot;];
p_22 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_22 -&gt; p_21 [label=&quot;&quot;];
p_21 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_21 -&gt; p_20 [label=&quot;&quot;];
p_20 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_20 -&gt; p_19 [label=&quot;&quot;];
p_19 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_19 -&gt; p_18 [label=&quot;&quot;];
p_18 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_18 -&gt; p_17 [label=&quot;&quot;];
p_17 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl\l                 (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_17 -&gt; p_16 [label=&quot;&quot;];
p_16 [label=&quot;Sat (Some  let (game : game_state) =\l   \{grid =\l     \{a = (Some O); b = None; c = (Some X); d = None; e = (Some X); f = None;\l      g = (Some X); h = (Some O); i = None\};\l    last_player = (Some X)\}\l let (player : player) = O\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-018a560d-ac7a-4b06-8249-c4f082e36ad1';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-6e10606f-a8bc-42dd-a287-c8f5e33d4f5e';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-5b9eee75-6e97-49d7-a227-55ed81fef989';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-334299b3-4097-4ae6-9c1e-644657df0157';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-29" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>CX.game
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-dbb01f12-e234-4cb5-a840-79a428b7892d"><table><tr><td><div class="imandra-table" id="table-c7e88828-6cee-452c-91c1-996850783c65"><table><tr><td>⭕</td><td>·</td><td>❌</td></tr><tr><td>·</td><td>❌</td><td>·</td></tr><tr><td>❌</td><td>⭕</td><td>·</td></tr></table></div></td><td>Last:</td><td>❌</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Fantastic. Let's also see what happens if we ask for an instance that we know shouldn't be possible - if a player is more than 1 move ahead:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-31" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>instance((game) =&gt; {
   let (x, o) = move_counts(game.grid);
   is_valid_grid(game.grid, game.last_player) &amp;&amp; ((x - o) &gt;= 2)
});
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px dashed #D84315; border-bottom: 1px dashed #D84315"><i class="fa fa-times-circle-o" style="margin-right: 0.5em; color: #D84315"></i><span>Unsatisfiable</span></div><div><div class="imandra-alternatives" id="alt-16a7dcfa-5461-442b-aa66-55bc62558e99"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>proof</a></li><li class="" data-toggle="tab"><a>call graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-3ae7b8a4-87ab-4ea2-bc5c-589e92639a97"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-4e780268-7720-4212-88c6-de19c1d3a90e"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-75908594-0cc9-4024-b221-b7803a79e14a"><table><tr><td><b>ground_instances</b></td><td>0</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.014s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-b2192262-108b-4b50-b36d-17a3c9fe95d9"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-c7bdadd9-0a93-43d4-a508-f787f33da159"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-ae2fc310-2319-4bb6-9dcc-5a1b2f111593"><table><tr><td><b>num checks</b></td><td>1</td></tr><tr><td><b>arith assert lower</b></td><td>1</td></tr><tr><td><b>arith pivots</b></td><td>1</td></tr><tr><td><b>rlimit count</b></td><td>1027</td></tr><tr><td><b>mk clause</b></td><td>29</td></tr><tr><td><b>mk bool var</b></td><td>113</td></tr><tr><td><b>datatype splits</b></td><td>49</td></tr><tr><td><b>propagations</b></td><td>7</td></tr><tr><td><b>conflicts</b></td><td>1</td></tr><tr><td><b>datatype accessor ax</b></td><td>19</td></tr><tr><td><b>datatype constructor ax</b></td><td>4</td></tr><tr><td><b>num allocs</b></td><td>23823018</td></tr><tr><td><b>added eqs</b></td><td>94</td></tr><tr><td><b>arith eq adapter</b></td><td>2</td></tr><tr><td><b>memory</b></td><td>19.770000</td></tr><tr><td><b>max memory</b></td><td>19.770000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-b2192262-108b-4b50-b36d-17a3c9fe95d9';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-c724a91f-de83-40f4-8d5f-60feb421f9a0"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.014s]
  (if (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      &gt;
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1
   then
     :var_0:.last_player = Some X
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).0
        -
        (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).1
        = 1
   else
   if (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      &lt;
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1
   then
     :var_0:.last_player = Some O
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).1
        -
        (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).0
        = 1
   else true)
  &amp;&amp; ((List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      -
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1)
     &gt;= 2</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-88d75ea0-e1bf-43da-81bb-72e77f1ad2e0"><table><tr><td><b>into</b></td><td><pre>(if (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).0
    &lt;=
    (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).1
 then
   (List.fold_right
    (fun el _x
     -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
        if el = None then (x, o)
        else
        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
        else (x, o + 1))
    (0, 0) (….a :: (… :: …))).1
   &lt;=
   (List.fold_right
    (fun el _x
     -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
        if el = None then (x, o)
        else
        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
        else (x, o + 1))
    (0, 0) (….a :: (… :: …))).0
   || :var_0:.last_player = Some O
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         + -1
           * (List.fold_right
              (fun el _x
               -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                  if el = None then (x, o)
                  else
                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                  else (x, o + 1))
              (0, 0) (….a :: (… :: …))).0
         = 1
 else
   (:var_0:.last_player = Some X
    &amp;&amp; (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       + -1
         * (List.fold_right
            (fun el _x
             -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                if el = None then (x, o)
                else
                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                else (x, o + 1))
            (0, 0) (….a :: (… :: …))).1
       = 1))
&amp;&amp; ((List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).0
    + -1
      * (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).1)
   &gt;= 2</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h4>unsat</h4><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_104))
                   (|::_3| (i_27 (grid_40 game_104)) |[…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-c724a91f-de83-40f4-8d5f-60feb421f9a0';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-f5856935-dfe6-43a3-8a86-fffd0bf3a09e"><textarea style="display: none">digraph &quot;proof&quot; {
p_31 [label=&quot;Start ((if (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           \&gt;\l           (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l        then\l          :var_0:.last_player = Some X\l          &amp;&amp; (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             -\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             = 1\l        else\l        if (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           \&lt;\l           (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l        then\l          :var_0:.last_player = Some O\l          &amp;&amp; (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             -\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             = 1\l        else true)\l       &amp;&amp; ((List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           -\l           (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1)\l          \&gt;= 2\l       :time 0.014s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_31 -&gt; p_30 [label=&quot;&quot;];
p_30 [label=&quot;Simplify ((if (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              \&lt;=\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l           then\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             \&lt;=\l             (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l             \|\| :var_0:.last_player = Some O\l                &amp;&amp; (List.fold_right\l                    (fun el _x\l                     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                        if el = None then (x, o)\l                        else\l                        if Is_a(Some, el) &amp;&amp; Option.get el = X\l                        then (x + 1, o) else (x, o + 1))\l                    (0, 0) (….a :: (… :: …))).1\l                   + -1\l                     * (List.fold_right\l                        (fun el _x\l                         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                            if el = None then (x, o)\l                            else\l                            if Is_a(Some, el) &amp;&amp; Option.get el = X\l                            then (x + 1, o) else (x, o + 1))\l                        (0, 0) (….a :: (… :: …))).0\l                   = 1\l           else\l             (:var_0:.last_player = Some X\l              &amp;&amp; (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).0\l                 + -1\l                   * (List.fold_right\l                      (fun el _x\l                       -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                          if el = None then (x, o)\l                          else\l                          if Is_a(Some, el) &amp;&amp; Option.get el = X\l                          then (x + 1, o) else (x, o + 1))\l                      (0, 0) (….a :: (… :: …))).1\l                 = 1))\l          &amp;&amp; ((List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              + -1\l                * (List.fold_right\l                   (fun el _x\l                    -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                       if el = None then (x, o)\l                       else\l                       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                       else (x, o + 1))\l                   (0, 0) (….a :: (… :: …))).1)\l             \&gt;= 2\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_30 -&gt; p_29 [label=&quot;&quot;];
p_29 -&gt; p_z3_430 [label=&quot;&quot;,fontname=&quot;courier&quot;,fontsize=14];
p_z3_430 [label=&quot;(let ((a!1 (|::_3| (h_26 (grid_40 game_104))
                   (|::_3| (i_27 (grid_40 game_104)) |[…&quot;,shape=box,fontname=&quot;courier&quot;,fontsize=14];p_29 [label=&quot;unsat&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-f5856935-dfe6-43a3-8a86-fffd0bf3a09e';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-4e780268-7720-4212-88c6-de19c1d3a90e';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-3ae7b8a4-87ab-4ea2-bc5c-589e92639a97';
  fold.hydrate(target);
});
</script></div></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-7fbd494d-9eeb-4db5-8e1c-551926f1f8a5"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;(if (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).0\l    \&lt;=\l    (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).1\l then\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).1\l   \&lt;=\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).0\l   \|\| game.last_player = Some O\l      &amp;&amp; (List.fold_right\l          (fun el _x\l           -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l              if el = None then (x, o)\l              else\l              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l              else (x, o + 1))\l          (0, 0) (….a :: (… :: …))).1\l         + -1\l           * (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l         = 1\l else\l   (game.last_player = Some X\l    &amp;&amp; (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).0\l       + -1\l         * (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l       = 1))\l&amp;&amp; ((List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).0\l    + -1\l      * (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).1)\l   \&gt;= 2&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_116 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_116 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-7fbd494d-9eeb-4db5-8e1c-551926f1f8a5';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-16a7dcfa-5461-442b-aa66-55bc62558e99';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As this is invalid according to the description we've provided, Imandra can't find an instance. In fact, this <code>Unsatisfiable</code> judgment tells us that Imandra has actually constructed a mathematical proof that no such instance exists.</p>
<h2 id="Verifying">Verifying<a class="anchor-link" href="#Verifying">&#182;</a></h2><p>We can invert this question, and turn it into a verification statement and ask Imandra to check it for us like a test.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-33" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>verify((game) =&gt; {
   let (x, o) = move_counts(game.grid);
   not(is_valid_grid(game.grid, game.last_player) &amp;&amp; ((x - o) &gt;= 2))
});
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px solid green; border-bottom: 1px solid green"><i class="fa fa-check-circle" style="margin-right: 0.5em; color: green"></i><span>Proved</span></div><div><div class="imandra-alternatives" id="alt-462a0326-47df-4efd-a8a8-1f6d4bdffe25"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>proof</a></li><li class="" data-toggle="tab"><a>call graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-267116b6-13bc-4b4c-9c68-c7dabaf65dd3"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-a58066e9-5410-4c1d-ba08-b3b1287eb187"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-eec17e01-f45d-4651-9a30-684722f8d7f0"><table><tr><td><b>ground_instances</b></td><td>0</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.011s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-70d227f0-99c2-489d-866e-e9ca5aca3524"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-755cf2b1-fabc-4ac0-b39f-ea3fa608835f"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-cdd17af3-879b-4220-906f-61f06c156dc4"><table><tr><td><b>num checks</b></td><td>1</td></tr><tr><td><b>arith assert lower</b></td><td>1</td></tr><tr><td><b>arith pivots</b></td><td>1</td></tr><tr><td><b>rlimit count</b></td><td>1035</td></tr><tr><td><b>mk clause</b></td><td>29</td></tr><tr><td><b>mk bool var</b></td><td>113</td></tr><tr><td><b>datatype splits</b></td><td>49</td></tr><tr><td><b>propagations</b></td><td>7</td></tr><tr><td><b>conflicts</b></td><td>1</td></tr><tr><td><b>datatype accessor ax</b></td><td>19</td></tr><tr><td><b>datatype constructor ax</b></td><td>4</td></tr><tr><td><b>num allocs</b></td><td>35877713</td></tr><tr><td><b>added eqs</b></td><td>94</td></tr><tr><td><b>arith eq adapter</b></td><td>2</td></tr><tr><td><b>memory</b></td><td>23.250000</td></tr><tr><td><b>max memory</b></td><td>23.250000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-70d227f0-99c2-489d-866e-e9ca5aca3524';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-13a33050-779c-40fa-97bf-3c70a785a967"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.011s]
  not
  ((if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &gt;
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      :var_0:.last_player = Some X
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).0
         -
         (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         = 1
    else
    if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &lt;
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      :var_0:.last_player = Some O
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         -
         (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).0
         = 1
    else true)
   &amp;&amp; ((List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       -
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1)
      &gt;= 2)</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-53beea10-5900-4b98-9262-93d0ed383e14"><table><tr><td><b>into</b></td><td><pre>not
((if (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).0
     &lt;=
     (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).1
  then
    (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).1
    &lt;=
    (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).0
    || :var_0:.last_player = Some O
       &amp;&amp; (List.fold_right
           (fun el _x
            -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
               if el = None then (x, o)
               else
               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
               else (x, o + 1))
           (0, 0) (….a :: (… :: …))).1
          + -1
            * (List.fold_right
               (fun el _x
                -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                   if el = None then (x, o)
                   else
                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                   else (x, o + 1))
               (0, 0) (….a :: (… :: …))).0
          = 1
  else
    (:var_0:.last_player = Some X
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).0
        + -1
          * (List.fold_right
             (fun el _x
              -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                 if el = None then (x, o)
                 else
                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                 else (x, o + 1))
             (0, 0) (….a :: (… :: …))).1
        = 1))
 &amp;&amp; ((List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).0
     + -1
       * (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1)
    &gt;= 2)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div><h4>unsat</h4><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_108))
                   (|::_3| (i_27 (grid_40 game_108)) |[…</pre></div></li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-13a33050-779c-40fa-97bf-3c70a785a967';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-cfe3f679-7baa-46e5-ba45-045024fad9f9"><textarea style="display: none">digraph &quot;proof&quot; {
p_34 [label=&quot;Start (not\l       ((if (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \&gt;\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l         then\l           :var_0:.last_player = Some X\l           &amp;&amp; (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              -\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              = 1\l         else\l         if (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \&lt;\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l         then\l           :var_0:.last_player = Some O\l           &amp;&amp; (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              -\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              = 1\l         else true)\l        &amp;&amp; ((List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            -\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1)\l           \&gt;= 2)\l       :time 0.011s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_34 -&gt; p_33 [label=&quot;&quot;];
p_33 [label=&quot;Simplify (not\l          ((if (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).0\l               \&lt;=\l               (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).1\l            then\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              \&lt;=\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              \|\| :var_0:.last_player = Some O\l                 &amp;&amp; (List.fold_right\l                     (fun el _x\l                      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                         if el = None then (x, o)\l                         else\l                         if Is_a(Some, el) &amp;&amp; Option.get el = X\l                         then (x + 1, o) else (x, o + 1))\l                     (0, 0) (….a :: (… :: …))).1\l                    + -1\l                      * (List.fold_right\l                         (fun el _x\l                          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                             if el = None then (x, o)\l                             else\l                             if Is_a(Some, el) &amp;&amp; Option.get el = X\l                             then (x + 1, o) else (x, o + 1))\l                         (0, 0) (….a :: (… :: …))).0\l                    = 1\l            else\l              (:var_0:.last_player = Some X\l               &amp;&amp; (List.fold_right\l                   (fun el _x\l                    -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                       if el = None then (x, o)\l                       else\l                       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                       else (x, o + 1))\l                   (0, 0) (….a :: (… :: …))).0\l                  + -1\l                    * (List.fold_right\l                       (fun el _x\l                        -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                           if el = None then (x, o)\l                           else\l                           if Is_a(Some, el) &amp;&amp; Option.get el = X\l                           then (x + 1, o) else (x, o + 1))\l                       (0, 0) (….a :: (… :: …))).1\l                  = 1))\l           &amp;&amp; ((List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).0\l               + -1\l                 * (List.fold_right\l                    (fun el _x\l                     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                        if el = None then (x, o)\l                        else\l                        if Is_a(Some, el) &amp;&amp; Option.get el = X\l                        then (x + 1, o) else (x, o + 1))\l                    (0, 0) (….a :: (… :: …))).1)\l              \&gt;= 2)\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_33 -&gt; p_32 [label=&quot;&quot;];
p_32 -&gt; p_z3_444 [label=&quot;&quot;,fontname=&quot;courier&quot;,fontsize=14];
p_z3_444 [label=&quot;(let ((a!1 (|::_3| (h_26 (grid_40 game_108))
                   (|::_3| (i_27 (grid_40 game_108)) |[…&quot;,shape=box,fontname=&quot;courier&quot;,fontsize=14];p_32 [label=&quot;unsat&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-cfe3f679-7baa-46e5-ba45-045024fad9f9';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-a58066e9-5410-4c1d-ba08-b3b1287eb187';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-267116b6-13bc-4b4c-9c68-c7dabaf65dd3';
  fold.hydrate(target);
});
</script></div></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-76638480-2605-443b-bbba-5f0ef7b85217"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;(if (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).0\l    \&lt;=\l    (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).1\l then\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).1\l   \&lt;=\l   (List.fold_right\l    (fun el _x\l     -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l        if el = None then (x, o)\l        else\l        if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l        else (x, o + 1))\l    (0, 0) (….a :: (… :: …))).0\l   \|\| game.last_player = Some O\l      &amp;&amp; (List.fold_right\l          (fun el _x\l           -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l              if el = None then (x, o)\l              else\l              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l              else (x, o + 1))\l          (0, 0) (….a :: (… :: …))).1\l         + -1\l           * (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).0\l         = 1\l else\l   (game.last_player = Some X\l    &amp;&amp; (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).0\l       + -1\l         * (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).1\l       = 1))\l&amp;&amp; ((List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).0\l    + -1\l      * (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).1)\l   \&gt;= 2&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_119 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_119 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-76638480-2605-443b-bbba-5f0ef7b85217';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-462a0326-47df-4efd-a8a8-1f6d4bdffe25';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Valid-games">Valid games<a class="anchor-link" href="#Valid-games">&#182;</a></h2><p>Let's continue adding some more definitions - we havent really covered winning criteria as part of <code>is_valid_grid</code>, so let's include a few:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-35" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let is_tie = ({grid: {a, b, c, d, e, f, g, h, i}, _}) =&gt;
  List.for_all((!=)(None), [a, b, c, d, e, f, g, h, i]);
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val is_tie : game_state -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-36" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let is_valid_game = game =&gt; {
  let winning_X = is_winning(game, X);
  let winning_O = is_winning(game, O);
  is_valid_grid(game.grid, game.last_player)
  &amp;&amp; (! winning_X &amp;&amp; ! winning_O || winning_X != winning_O);
};
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val is_valid_game : game_state -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... and let's ask for a valid game where X is winning:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-38" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>instance((game) =&gt; is_valid_game(game) &amp;&amp; is_winning(game, X));
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; bool = &lt;fun&gt;
module CX : sig val game : game_state end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Instance (after 10 steps, 0.050s):
 let (game : game_state) =
   {grid =
     {a = (Some X); b = None; c = (Some O); d = (Some O); e = (Some X);
      f = None; g = (Some O); h = None; i = (Some X)};
    last_player = None}
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px solid green; border-bottom: 1px solid green"><i class="fa fa-check-circle" style="margin-right: 0.5em; color: green"></i><span>Instance</span></div><div><div class="imandra-alternatives" id="alt-c8894bcb-1fa2-4c97-a415-81d591cb4c46"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-07806630-54dc-49f2-ab97-31e050a78855"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;((if (List.fold_right\l      (fun el _x\l       -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l          if el = None then (x, o)\l          else\l          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l          else (x, o + 1))\l      (0, 0) (….a :: (… :: …))).0\l     \&lt;=\l     (List.fold_right\l      (fun el _x\l       -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l          if el = None then (x, o)\l          else\l          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l          else (x, o + 1))\l      (0, 0) (….a :: (… :: …))).1\l  then\l    (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).1\l    \&lt;=\l    (List.fold_right\l     (fun el _x\l      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l         if el = None then (x, o)\l         else\l         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l         else (x, o + 1))\l     (0, 0) (….a :: (… :: …))).0\l    \|\| game.last_player = Some O\l       &amp;&amp; (List.fold_right\l           (fun el _x\l            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l               if el = None then (x, o)\l               else\l               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l               else (x, o + 1))\l           (0, 0) (….a :: (… :: …))).1\l          + -1\l            * (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l          = 1\l  else\l    (game.last_player = Some X\l     &amp;&amp; (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).0\l        + -1\l          * (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l        = 1))\l &amp;&amp; (not\l     ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l            \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l           \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l          \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l         \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l        \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l       \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l      \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l     &amp;&amp; not\l        ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l               \|\| (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)\l              \|\| (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)\l             \|\| (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)\l            \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l           \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l          \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l         \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)\l     \|\| not\l        ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l               \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l              \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l             \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l            \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l           \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l          \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l         \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l        =\l        ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l               \|\| (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)\l              \|\| (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)\l             \|\| (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)\l            \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l           \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l          \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l         \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)))\l&amp;&amp; ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l          \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l         \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l        \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l       \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l      \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l     \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l    \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2849 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2849 -&gt; expr_3209 [label=&quot;=&quot;];
expr_3209 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2863 -&gt; call_2849 [label=&quot;calls&quot;];
expr_2863 -&gt; call_2849 [label=&quot;calls&quot;];
expr_2863 -&gt; call_2849 [label=&quot;calls&quot;];
call_932 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_932 -&gt; expr_1300 [label=&quot;=&quot;];
expr_1300 [label=&quot;if List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_948 -&gt; call_932 [label=&quot;calls&quot;];
expr_948 -&gt; call_932 [label=&quot;calls&quot;];
expr_948 -&gt; call_932 [label=&quot;calls&quot;];
call_3538 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3538 -&gt; expr_3964 [label=&quot;=&quot;];
expr_3964 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3552 -&gt; call_3538 [label=&quot;calls&quot;];
expr_3552 -&gt; call_3538 [label=&quot;calls&quot;];
expr_3552 -&gt; call_3538 [label=&quot;calls&quot;];
call_2440 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2440 -&gt; expr_2863 [label=&quot;=&quot;];
expr_2863 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2454 -&gt; call_2440 [label=&quot;calls&quot;];
expr_2454 -&gt; call_2440 [label=&quot;calls&quot;];
expr_2454 -&gt; call_2440 [label=&quot;calls&quot;];
call_3950 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3950 -&gt; expr_4293 [label=&quot;=&quot;];
expr_4293 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (game.grid.a ::\l                 (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3964 -&gt; call_3950 [label=&quot;calls&quot;];
expr_3964 -&gt; call_3950 [label=&quot;calls&quot;];
expr_3964 -&gt; call_3950 [label=&quot;calls&quot;];
call_1775 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1775 -&gt; expr_2115 [label=&quot;=&quot;];
expr_2115 [label=&quot;if List.tl\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1789 -&gt; call_1775 [label=&quot;calls&quot;];
expr_1789 -&gt; call_1775 [label=&quot;calls&quot;];
expr_1789 -&gt; call_1775 [label=&quot;calls&quot;];
call_1286 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_1286 -&gt; expr_1789 [label=&quot;=&quot;];
expr_1789 [label=&quot;if List.tl\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_1300 -&gt; call_1286 [label=&quot;calls&quot;];
expr_1300 -&gt; call_1286 [label=&quot;calls&quot;];
expr_1300 -&gt; call_1286 [label=&quot;calls&quot;];
call_2101 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_2101 -&gt; expr_2454 [label=&quot;=&quot;];
expr_2454 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_2115 -&gt; call_2101 [label=&quot;calls&quot;];
expr_2115 -&gt; call_2101 [label=&quot;calls&quot;];
expr_2115 -&gt; call_2101 [label=&quot;calls&quot;];
call_3195 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3195 -&gt; expr_3552 [label=&quot;=&quot;];
expr_3552 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3209 -&gt; call_3195 [label=&quot;calls&quot;];
expr_3209 -&gt; call_3195 [label=&quot;calls&quot;];
expr_3209 -&gt; call_3195 [label=&quot;calls&quot;];
call_4279 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_4293 -&gt; call_4279 [label=&quot;calls&quot;];
expr_4293 -&gt; call_4279 [label=&quot;calls&quot;];
expr_4293 -&gt; call_4279 [label=&quot;calls&quot;];
call_318 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_318 -&gt; expr_948 [label=&quot;=&quot;];
expr_948 [label=&quot;if game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))) = []\lthen (0, 0)\lelse\lif List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   &amp;&amp; Option.get\l      (List.hd\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_318 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-07806630-54dc-49f2-ab97-31e050a78855';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-b0e6500e-0578-4c4a-9b8a-da864ea0d110"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-56b0f190-3917-4ee1-9828-da3e2a5d0e3a"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-254e00f3-141d-4e11-84a4-eadc75249114"><table><tr><td><b>ground_instances</b></td><td>10</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.050s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-b5299fd1-a279-41e6-bdda-50d06e6acb8d"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-db206c2f-8aa0-4f8f-b143-db941ba9bee7"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-f2719ffd-af86-41f2-923d-d0b6b39daf8b"><table><tr><td><b>arith offset eqs</b></td><td>470</td></tr><tr><td><b>num checks</b></td><td>21</td></tr><tr><td><b>arith assert lower</b></td><td>418</td></tr><tr><td><b>arith pivots</b></td><td>269</td></tr><tr><td><b>rlimit count</b></td><td>87823</td></tr><tr><td><b>mk clause</b></td><td>609</td></tr><tr><td><b>datatype occurs check</b></td><td>224</td></tr><tr><td><b>mk bool var</b></td><td>1976</td></tr><tr><td><b>arith assert upper</b></td><td>371</td></tr><tr><td><b>datatype splits</b></td><td>176</td></tr><tr><td><b>decisions</b></td><td>844</td></tr><tr><td><b>arith add rows</b></td><td>1930</td></tr><tr><td><b>arith bound prop</b></td><td>65</td></tr><tr><td><b>propagations</b></td><td>2009</td></tr><tr><td><b>interface eqs</b></td><td>7</td></tr><tr><td><b>conflicts</b></td><td>106</td></tr><tr><td><b>arith fixed eqs</b></td><td>427</td></tr><tr><td><b>datatype accessor ax</b></td><td>136</td></tr><tr><td><b>minimized lits</b></td><td>50</td></tr><tr><td><b>arith conflicts</b></td><td>12</td></tr><tr><td><b>arith assert diseq</b></td><td>63</td></tr><tr><td><b>datatype constructor ax</b></td><td>642</td></tr><tr><td><b>num allocs</b></td><td>56580263</td></tr><tr><td><b>final checks</b></td><td>18</td></tr><tr><td><b>added eqs</b></td><td>6359</td></tr><tr><td><b>del clause</b></td><td>290</td></tr><tr><td><b>arith eq adapter</b></td><td>318</td></tr><tr><td><b>memory</b></td><td>28.410000</td></tr><tr><td><b>max memory</b></td><td>28.470000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-b5299fd1-a279-41e6-bdda-50d06e6acb8d';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-a61dce07-f1c0-4b5e-82d5-dfb81981fa1b"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.050s]
  ((if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &gt;
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      :var_0:.last_player = Some X
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).0
         -
         (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         = 1
    else
    if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &lt;
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      :var_0:.last_player = Some O
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         -
         (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).0
         = 1
    else true)
   &amp;&amp; (not
       ((….a, …, ….c) = (Some X, Some X, Some X)
        || (….d, ….e, ….f) = (Some X, Some X, Some X)
           || (….g, ….h, ….i) = (Some X, Some X, Some X)
              || (….a, ….d, ….g) = (Some X, Some X, Some X)
                 || (…, ….e, ….h) = (Some X, Some X, Some X)
                    || (….c, ….f, ….i) = (Some X, Some X, Some X)
                       || (….a, ….e, ….i) = (Some X, Some X, Some X)
                          || (….c, ….e, ….g) = (Some X, Some X, Some X))
       &amp;&amp; not
          ((….a, …, ….c) = (Some O, Some O, Some O)
           || (….d, ….e, ….f) = (Some O, Some O, Some O)
              || (….g, ….h, ….i) = (Some O, Some O, Some O)
                 || (….a, ….d, ….g) = (Some O, Some O, Some O)
                    || (…, ….e, ….h) = (Some O, Some O, Some O)
                       || (….c, ….f, ….i) = (Some O, Some O, Some O)
                          || (….a, ….e, ….i) = (Some O, Some O, Some O)
                             || (….c, ….e, ….g) =
                                (Some O, Some O, Some O))
       || not
          (((….a, …, ….c) = (Some X, Some X, Some X)
            || (….d, ….e, ….f) = (Some X, Some X, Some X)
               || (….g, ….h, ….i) = (Some X, Some X, Some X)
                  || (….a, ….d, ….g) = (Some X, Some X, Some X)
                     || (…, ….e, ….h) = (Some X, Some X, Some X)
                        || (….c, ….f, ….i) = (Some X, Some X, Some X)
                           || (….a, ….e, ….i) =
                              (Some X, Some X, Some X)
                              || (….c, ….e, ….g) =
                                 (Some X, Some X, Some X))
           =
           ((….a, …, ….c) = (Some O, Some O, Some O)
            || (….d, ….e, ….f) = (Some O, Some O, Some O)
               || (….g, ….h, ….i) = (Some O, Some O, Some O)
                  || (….a, ….d, ….g) = (Some O, Some O, Some O)
                     || (…, ….e, ….h) = (Some O, Some O, Some O)
                        || (….c, ….f, ….i) = (Some O, Some O, Some O)
                           || (….a, ….e, ….i) =
                              (Some O, Some O, Some O)
                              || (….c, ….e, ….g) =
                                 (Some O, Some O, Some O)))))
  &amp;&amp; ((….a, …, ….c) = (Some X, Some X, Some X)
      || (….d, ….e, ….f) = (Some X, Some X, Some X)
         || (….g, ….h, ….i) = (Some X, Some X, Some X)
            || (….a, ….d, ….g) = (Some X, Some X, Some X)
               || (…, ….e, ….h) = (Some X, Some X, Some X)
                  || (….c, ….f, ….i) = (Some X, Some X, Some X)
                     || (….a, ….e, ….i) = (Some X, Some X, Some X)
                        || (….c, ….e, ….g) = (Some X, Some X, Some X))</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-e142d354-23f0-46dc-8787-feca60b8dc2d"><table><tr><td><b>into</b></td><td><pre>((if (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).0
     &lt;=
     (List.fold_right
      (fun el _x
       -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
          if el = None then (x, o)
          else
          if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
          else (x, o + 1))
      (0, 0) (….a :: (… :: …))).1
  then
    (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).1
    &lt;=
    (List.fold_right
     (fun el _x
      -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
         if el = None then (x, o)
         else
         if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
         else (x, o + 1))
     (0, 0) (….a :: (… :: …))).0
    || :var_0:.last_player = Some O
       &amp;&amp; (List.fold_right
           (fun el _x
            -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
               if el = None then (x, o)
               else
               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
               else (x, o + 1))
           (0, 0) (….a :: (… :: …))).1
          + -1
            * (List.fold_right
               (fun el _x
                -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                   if el = None then (x, o)
                   else
                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                   else (x, o + 1))
               (0, 0) (….a :: (… :: …))).0
          = 1
  else
    (:var_0:.last_player = Some X
     &amp;&amp; (List.fold_right
         (fun el _x
          -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
             if el = None then (x, o)
             else
             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
             else (x, o + 1))
         (0, 0) (….a :: (… :: …))).0
        + -1
          * (List.fold_right
             (fun el _x
              -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                 if el = None then (x, o)
                 else
                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                 else (x, o + 1))
             (0, 0) (….a :: (… :: …))).1
        = 1))
 &amp;&amp; (not
     ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X
            || (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)
           || (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)
          || (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)
         || (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)
        || (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)
       || (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)
      || (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)
     &amp;&amp; not
        ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O
               || (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)
              || (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)
             || (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)
            || (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)
           || (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)
          || (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)
         || (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)
     || not
        ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X
               || (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)
              || (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)
             || (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)
            || (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)
           || (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)
          || (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)
         || (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)
        =
        ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O
               || (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)
              || (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)
             || (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)
            || (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)
           || (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)
          || (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)
         || (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)))
&amp;&amp; ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X
          || (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)
         || (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)
        || (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)
       || (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)
      || (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)
     || (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)
    || (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-de857edb-f329-4d26-a343-8def2b1c7743"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-3a9be410-80f7-4ac6-95df-7bfd5fd1664f"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-c20fa46c-c454-41be-9b5d-78ae55b63aef"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-d4676059-a2dc-4fda-89ac-4ef9f4916acb"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-33fb8abe-2246-484e-877b-9bf723808e2a"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b345edaa-e54c-454c-84fe-409ef668a6ee"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-be9faacb-3505-4fd6-9f31-fadbf62aa7b7"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-50643c72-2585-40a7-acc3-d25efb24b847"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-949d61be-24c1-467f-a668-3f95d39c3a6a"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ed0c6ae6-5821-49b8-a277-bc84c6cfef10"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_127))
                   (|::_3| (i_27 (grid_40 game_127)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let (game : game_state) =
   {grid =
     {a = (Some X); b = None; c = (Some O); d = (Some O); e = (Some X);
      f = None; g = (Some O); h = None; i = (Some X)};
    last_player = None}
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-a61dce07-f1c0-4b5e-82d5-dfb81981fa1b';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-4a0e598a-1e7b-479d-a0aa-4410dc53c351"><textarea style="display: none">digraph &quot;proof&quot; {
p_47 [label=&quot;Start (((if (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \&gt;\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l         then\l           :var_0:.last_player = Some X\l           &amp;&amp; (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              -\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              = 1\l         else\l         if (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \&lt;\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l         then\l           :var_0:.last_player = Some O\l           &amp;&amp; (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              -\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              = 1\l         else true)\l        &amp;&amp; (not\l            ((….a, …, ….c) = (Some X, Some X, Some X)\l             \|\| (….d, ….e, ….f) = (Some X, Some X, Some X)\l                \|\| (….g, ….h, ….i) = (Some X, Some X, Some X)\l                   \|\| (….a, ….d, ….g) = (Some X, Some X, Some X)\l                      \|\| (…, ….e, ….h) = (Some X, Some X, Some X)\l                         \|\| (….c, ….f, ….i) = (Some X, Some X, Some X)\l                            \|\| (….a, ….e, ….i) =\l                               (Some X, Some X, Some X)\l                               \|\| (….c, ….e, ….g) =\l                                  (Some X, Some X, Some X))\l            &amp;&amp; not\l               ((….a, …, ….c) = (Some O, Some O, Some O)\l                \|\| (….d, ….e, ….f) = (Some O, Some O, Some O)\l                   \|\| (….g, ….h, ….i) = (Some O, Some O, Some O)\l                      \|\| (….a, ….d, ….g) = (Some O, Some O, Some O)\l                         \|\| (…, ….e, ….h) = (Some O, Some O, Some O)\l                            \|\| (….c, ….f, ….i) =\l                               (Some O, Some O, Some O)\l                               \|\| (….a, ….e, ….i) =\l                                  (Some O, Some O, Some O)\l                                  \|\| (….c, ….e, ….g) =\l                                     (Some O, Some O, Some O))\l            \|\| not\l               (((….a, …, ….c) = (Some X, Some X, Some X)\l                 \|\| (….d, ….e, ….f) = (Some X, Some X, Some X)\l                    \|\| (….g, ….h, ….i) = (Some X, Some X, Some X)\l                       \|\| (….a, ….d, ….g) = (Some X, Some X, Some X)\l                          \|\| (…, ….e, ….h) = (Some X, Some X, Some X)\l                             \|\| (….c, ….f, ….i) =\l                                (Some X, Some X, Some X)\l                                \|\| (….a, ….e, ….i) =\l                                   (Some X, Some X, Some X)\l                                   \|\| (….c, ….e, ….g) =\l                                      (Some X, Some X, Some X))\l                =\l                ((….a, …, ….c) = (Some O, Some O, Some O)\l                 \|\| (….d, ….e, ….f) = (Some O, Some O, Some O)\l                    \|\| (….g, ….h, ….i) = (Some O, Some O, Some O)\l                       \|\| (….a, ….d, ….g) = (Some O, Some O, Some O)\l                          \|\| (…, ….e, ….h) = (Some O, Some O, Some O)\l                             \|\| (….c, ….f, ….i) =\l                                (Some O, Some O, Some O)\l                                \|\| (….a, ….e, ….i) =\l                                   (Some O, Some O, Some O)\l                                   \|\| (….c, ….e, ….g) =\l                                      (Some O, Some O, Some O)))))\l       &amp;&amp; ((….a, …, ….c) = (Some X, Some X, Some X)\l           \|\| (….d, ….e, ….f) = (Some X, Some X, Some X)\l              \|\| (….g, ….h, ….i) = (Some X, Some X, Some X)\l                 \|\| (….a, ….d, ….g) = (Some X, Some X, Some X)\l                    \|\| (…, ….e, ….h) = (Some X, Some X, Some X)\l                       \|\| (….c, ….f, ….i) = (Some X, Some X, Some X)\l                          \|\| (….a, ….e, ….i) = (Some X, Some X, Some X)\l                             \|\| (….c, ….e, ….g) =\l                                (Some X, Some X, Some X))\l       :time 0.050s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_47 -&gt; p_46 [label=&quot;&quot;];
p_46 [label=&quot;Simplify (((if (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).0\l               \&lt;=\l               (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).1\l            then\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              \&lt;=\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              \|\| :var_0:.last_player = Some O\l                 &amp;&amp; (List.fold_right\l                     (fun el _x\l                      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                         if el = None then (x, o)\l                         else\l                         if Is_a(Some, el) &amp;&amp; Option.get el = X\l                         then (x + 1, o) else (x, o + 1))\l                     (0, 0) (….a :: (… :: …))).1\l                    + -1\l                      * (List.fold_right\l                         (fun el _x\l                          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                             if el = None then (x, o)\l                             else\l                             if Is_a(Some, el) &amp;&amp; Option.get el = X\l                             then (x + 1, o) else (x, o + 1))\l                         (0, 0) (….a :: (… :: …))).0\l                    = 1\l            else\l              (:var_0:.last_player = Some X\l               &amp;&amp; (List.fold_right\l                   (fun el _x\l                    -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                       if el = None then (x, o)\l                       else\l                       if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                       else (x, o + 1))\l                   (0, 0) (….a :: (… :: …))).0\l                  + -1\l                    * (List.fold_right\l                       (fun el _x\l                        -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                           if el = None then (x, o)\l                           else\l                           if Is_a(Some, el) &amp;&amp; Option.get el = X\l                           then (x + 1, o) else (x, o + 1))\l                       (0, 0) (….a :: (… :: …))).1\l                  = 1))\l           &amp;&amp; (not\l               ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                      \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l                     \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l                    \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l                   \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l                  \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l                 \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l                \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l               &amp;&amp; not\l                  ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l                         \|\| (….d = Some O &amp;&amp; ….e = Some O)\l                            &amp;&amp; ….f = Some O)\l                        \|\| (….g = Some O &amp;&amp; ….h = Some O)\l                           &amp;&amp; ….i = Some O)\l                       \|\| (….a = Some O &amp;&amp; ….d = Some O)\l                          &amp;&amp; ….g = Some O)\l                      \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l                     \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l                    \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l                   \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)\l               \|\| not\l                  ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                         \|\| (….d = Some X &amp;&amp; ….e = Some X)\l                            &amp;&amp; ….f = Some X)\l                        \|\| (….g = Some X &amp;&amp; ….h = Some X)\l                           &amp;&amp; ….i = Some X)\l                       \|\| (….a = Some X &amp;&amp; ….d = Some X)\l                          &amp;&amp; ….g = Some X)\l                      \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l                     \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l                    \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l                   \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l                  =\l                  ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l                         \|\| (….d = Some O &amp;&amp; ….e = Some O)\l                            &amp;&amp; ….f = Some O)\l                        \|\| (….g = Some O &amp;&amp; ….h = Some O)\l                           &amp;&amp; ….i = Some O)\l                       \|\| (….a = Some O &amp;&amp; ….d = Some O)\l                          &amp;&amp; ….g = Some O)\l                      \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l                     \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l                    \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l                   \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)))\l          &amp;&amp; ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                    \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l                   \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l                  \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l                 \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l                \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l               \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l              \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_46 -&gt; p_45 [label=&quot;&quot;];
p_45 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….grid.a :: (….grid.b :: (… :: …)))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_45 -&gt; p_44 [label=&quot;&quot;];
p_44 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_44 -&gt; p_43 [label=&quot;&quot;];
p_43 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_43 -&gt; p_42 [label=&quot;&quot;];
p_42 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_42 -&gt; p_41 [label=&quot;&quot;];
p_41 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_41 -&gt; p_40 [label=&quot;&quot;];
p_40 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_40 -&gt; p_39 [label=&quot;&quot;];
p_39 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_39 -&gt; p_38 [label=&quot;&quot;];
p_38 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_38 -&gt; p_37 [label=&quot;&quot;];
p_37 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_37 -&gt; p_36 [label=&quot;&quot;];
p_36 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl\l                 (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_36 -&gt; p_35 [label=&quot;&quot;];
p_35 [label=&quot;Sat (Some  let (game : game_state) =\l   \{grid =\l     \{a = (Some X); b = None; c = (Some O); d = (Some O); e = (Some X);\l      f = None; g = (Some O); h = None; i = (Some X)\};\l    last_player = None\}\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-4a0e598a-1e7b-479d-a0aa-4410dc53c351';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-56b0f190-3917-4ee1-9828-da3e2a5d0e3a';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-b0e6500e-0578-4c4a-9b8a-da864ea0d110';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-c8894bcb-1fa2-4c97-a415-81d591cb4c46';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-39" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>CX.game;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-6bad7bf6-83f6-4a2c-a5da-f44fb01081ed"><table><tr><td><div class="imandra-table" id="table-93f72a64-084d-4693-86b7-fa2f98df6b6e"><table><tr><td>❌</td><td>·</td><td>⭕</td></tr><tr><td>⭕</td><td>❌</td><td>·</td></tr><tr><td>⭕</td><td>·</td><td>❌</td></tr></table></div></td><td>Last:</td><td>·</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Valid-moves">Valid moves<a class="anchor-link" href="#Valid-moves">&#182;</a></h2><p>Looks good! We're on the home stretch now - let's add the last few helper functions around playing moves:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-41" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let is_valid_move = (game, player, move) =&gt;
  ! (is_winning(game, X) || is_winning(game, O) || is_tie(game))
  &amp;&amp; is_valid_game(game)
  &amp;&amp; (
    game.last_player == None
    &amp;&amp; player == initial_player
    || game.last_player == Some(other_player(player))
  );

let play_move = ({grid, _}, player, move) =&gt; {
  let play = Some(player);
  let grid =
    switch (move) {
    | A =&gt; {...grid, a: play}
    | B =&gt; {...grid, b: play}
    | C =&gt; {...grid, c: play}
    | D =&gt; {...grid, d: play}
    | E =&gt; {...grid, e: play}
    | F =&gt; {...grid, f: play}
    | G =&gt; {...grid, g: play}
    | H =&gt; {...grid, h: play}
    | I =&gt; {...grid, i: play}
    };
  {grid, last_player: play};
};

let status = game =&gt;
  if (is_winning(game, X)) {
    Won(X);
  } else if (is_winning(game, O)) {
    Won(O);
  } else if (is_tie(game)) {
    Tied;
  } else {
    InProgress;
  };
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[23]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val is_valid_move : game_state -&gt; player -&gt; &#39;a -&gt; bool = &lt;fun&gt;
val play_move : game_state -&gt; player -&gt; move -&gt; game_state = &lt;fun&gt;
val status : game_state -&gt; game_status = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And finally, the function we call from the ReasonReact frontend to actually play the game!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-43" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let play = ({last_player, _} as game, move) =&gt; {
  let player =
    switch (last_player) {
    | None =&gt; initial_player
    | Some(player) =&gt; other_player(player)
    };
  if (is_valid_move(game, player, move)) {
    let game = play_move(game, player, move);
    (game, status(game));
  } else {
    (game, InvalidMove(move));
  };
};
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val play : game_state -&gt; move -&gt; game_state * game_status = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>...and we're done! Let's add one more verification statement to check that these functions work as we expect. If we've got a valid game, and a valid move, then if we play the move on the game, we should still have a valid game.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<pre><code>verify((game, player, move) =&gt;
  (is_valid_game(game) &amp;&amp; is_valid_move(game, player, move))
  ==&gt; is_valid_game(play_move(game, player, move))
);</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>a ==&gt; b</code> operator here is the logical "implies" - "if <code>a</code> is true, then <code>b</code> is also true". It's defined as a regular infix operator in the Imandra prelude:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-47" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>(==&gt;)
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : bool -&gt; bool -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Anyway! Let's actually run the statement:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-49" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>verify((game, player, move) =&gt;
  (is_valid_game(game) &amp;&amp; is_valid_move(game, player, move))
  ==&gt; is_valid_game(play_move(game, player, move))
);
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; player -&gt; move -&gt; bool = &lt;fun&gt;
module CX : sig val game : game_state val player : player val move : move end
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>Counterexample (after 24 steps, 0.554s):
 let (game : game_state) =
   {grid =
     {a = (Some X); b = (Some O); c = None; d = (Some X); e = (Some O);
      f = (Some O); g = (Some O); h = (Some X); i = None};
    last_player = (Some O)}
 let (player : player) = X
 let (move : move) = D
</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px dashed #D84315; border-bottom: 1px dashed #D84315"><i class="fa fa-times-circle-o" style="margin-right: 0.5em; color: #D84315"></i><span>Refuted</span></div><div><div class="imandra-alternatives" id="alt-82d86e56-e3ca-4e56-bb5b-6846d73e84d6"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>call graph</a></li><li class="" data-toggle="tab"><a>proof</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-graphviz" id="graphviz-e6215e10-d657-4697-8b1b-3dc4fa33796f"><textarea style="display: none">digraph &quot;call graph&quot; {
goal [label=&quot;not\l(not\l ((((if (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).0\l        \&lt;=\l        (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).1\l     then\l       (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).1\l       \&lt;=\l       (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).0\l       \|\| game.last_player = Some O\l          &amp;&amp; (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             + -1\l               * (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).0\l             = 1\l     else\l       (game.last_player = Some X\l        &amp;&amp; (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           + -1\l             * (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).1\l           = 1))\l    &amp;&amp; (not\l        ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l               \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l              \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l             \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l            \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l           \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l          \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l         \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l        &amp;&amp; not\l           ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l                  \|\| (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)\l                 \|\| (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)\l                \|\| (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)\l               \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l              \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l             \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l            \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)\l        \|\| not\l           ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                  \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l                 \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l                \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l               \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l              \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l             \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l            \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l           =\l           ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l                  \|\| (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)\l                 \|\| (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)\l                \|\| (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)\l               \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l              \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l             \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l            \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)))\l   &amp;&amp; not\l      (((((((((((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                      \|\| (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)\l                     \|\| (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)\l                    \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l                   \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l                  \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l                 \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l                \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l               \|\| (….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O)\l              \|\| (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)\l             \|\| (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)\l            \|\| (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)\l           \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l          \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l         \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l        \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)\l       \|\| List.for_all ((\&lt;\&gt;) None) (….a :: (… :: …))))\l  &amp;&amp; (game.last_player = None &amp;&amp; player = X\l      \|\| game.last_player = Some (if player = X then O else X)))\l \|\| (if (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).0\l        \&lt;=\l        (List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….a :: (… :: …))).1\l     then\l       (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).1\l       \&lt;=\l       (List.fold_right\l        (fun el _x\l         -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l            if el = None then (x, o)\l            else\l            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l            else (x, o + 1))\l        (0, 0) (….a :: (… :: …))).0\l       \|\| player = O\l          &amp;&amp; (List.fold_right\l              (fun el _x\l               -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                  if el = None then (x, o)\l                  else\l                  if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                  else (x, o + 1))\l              (0, 0) (….a :: (… :: …))).1\l             + -1\l               * (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).0\l             = 1\l     else\l       (player = X\l        &amp;&amp; (List.fold_right\l            (fun el _x\l             -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                if el = None then (x, o)\l                else\l                if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                else (x, o + 1))\l            (0, 0) (….a :: (… :: …))).0\l           + -1\l             * (List.fold_right\l                (fun el _x\l                 -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                    if el = None then (x, o)\l                    else\l                    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                    else (x, o + 1))\l                (0, 0) (….a :: (… :: …))).1\l           = 1))\l    &amp;&amp; (not\l        ((((((((….a = Some X &amp;&amp; … = Some X)\l               &amp;&amp; (if move = … then … else …).c = Some X \|\| …)\l              \|\| …)\l             \|\| …)\l            \|\| …)\l           \|\| …)\l          \|\| …)\l         \|\| …)\l        &amp;&amp; … \|\| …))&quot;,shape=box,style=filled,color=&quot;cyan&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_5840 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_5840 -&gt; expr_6202 [label=&quot;=&quot;];
expr_6202 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_5854 -&gt; call_5840 [label=&quot;calls&quot;];
expr_5854 -&gt; call_5840 [label=&quot;calls&quot;];
expr_5854 -&gt; call_5840 [label=&quot;calls&quot;];
call_10123 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl ((if move = A then … else …).a :: (….b :: (… :: …)))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_10123 -&gt; expr_10573 [label=&quot;=&quot;];
expr_10573 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else if move = B then … else …).a\l         ::\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else …).b\l          :: (….c :: (… :: …)))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else if move = B then … else …).a\l          ::\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else …).b\l           :: (….c :: (… :: …))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else if move = B then … else …).a\l          ::\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else …).b\l           :: (….c :: (… :: …)))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             ((if move = A\l               then\l                 \{a = …; b = …; c = …; d = …; e = …; f = …;\l                  g = …; h = …; i = …\}\l               else if move = B then … else …).a\l              ::\l              ((if move = A\l                then\l                  \{a = …; b = …; c = …; d = …; e = …; f = …;\l                   g = …; h = …; i = …\}\l                else …).b\l               :: (….c :: (… :: …)))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_10137 -&gt; call_10123 [label=&quot;calls&quot;];
expr_10137 -&gt; call_10123 [label=&quot;calls&quot;];
expr_10137 -&gt; call_10123 [label=&quot;calls&quot;];
call_4920 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_4920 -&gt; expr_5461 [label=&quot;=&quot;];
expr_5461 [label=&quot;if List.tl\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_4934 -&gt; call_4920 [label=&quot;calls&quot;];
expr_4934 -&gt; call_4920 [label=&quot;calls&quot;];
expr_4934 -&gt; call_4920 [label=&quot;calls&quot;];
call_8850 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl ((if move = A then … else …).a :: (….b :: (… :: …))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_8850 -&gt; expr_10137 [label=&quot;=&quot;];
expr_10137 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else if move = B then … else …).a\l        ::\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else …).b\l         :: (….c :: (… :: …))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else if move = B then … else …).a\l         ::\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else …).b\l          :: (….c :: (… :: …)))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else if move = B then … else …).a\l         ::\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else …).b\l          :: (….c :: (… :: …))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else if move = B then … else …).a\l             ::\l             ((if move = A\l               then\l                 \{a = …; b = …; c = …; d = …; e = …; f = …;\l                  g = …; h = …; i = …\}\l               else …).b\l              :: (….c :: (… :: …))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_8864 -&gt; call_8850 [label=&quot;calls&quot;];
expr_8864 -&gt; call_8850 [label=&quot;calls&quot;];
expr_8864 -&gt; call_8850 [label=&quot;calls&quot;];
call_5447 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_5447 -&gt; expr_5854 [label=&quot;=&quot;];
expr_5854 [label=&quot;if List.tl\l   (List.tl\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_5461 -&gt; call_5447 [label=&quot;calls&quot;];
expr_5461 -&gt; call_5447 [label=&quot;calls&quot;];
expr_5461 -&gt; call_5447 [label=&quot;calls&quot;];
call_344 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_344 -&gt; expr_3934 [label=&quot;=&quot;];
expr_3934 [label=&quot;if game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))) = []\lthen (0, 0)\lelse\lif List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   &amp;&amp; Option.get\l      (List.hd\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_344 [label=&quot;calls&quot;];
call_10457 [label=&quot;List.for_all ((\&lt;\&gt;) None)\l(List.tl\l (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_10459 -&gt; call_10457 [label=&quot;calls&quot;];
call_11209 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        ((if move = A then … else …).a :: (….b :: (… :: …)))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_11209 -&gt; expr_19893 [label=&quot;=&quot;];
expr_19893 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else if move = B then … else …).a\l           ::\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else …).b\l            :: (….c :: (… :: …)))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else if move = B then … else …).a\l            ::\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else …).b\l             :: (….c :: (… :: …))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else if move = B then … else …).a\l            ::\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else …).b\l             :: (….c :: (… :: …)))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               ((if move = A\l                 then\l                   \{a = …; b = …; c = …; d = …; e = …; f = …;\l                    g = …; h = …; i = …\}\l                 else if move = B then … else …).a\l                ::\l                ((if move = A\l                  then\l                    \{a = …; b = …; c = …; d = …; e = …; f = …;\l                     g = …; h = …; i = …\}\l                  else …).b\l                 :: (….c :: (… :: …)))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_11223 -&gt; call_11209 [label=&quot;calls&quot;];
expr_11223 -&gt; call_11209 [label=&quot;calls&quot;];
expr_11223 -&gt; call_11209 [label=&quot;calls&quot;];
call_485 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) ((if move = A then … else …).a :: (….b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_485 -&gt; expr_3209 [label=&quot;=&quot;];
expr_3209 [label=&quot;if (if move = A\l    then\l      \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l       h = …; i = …\}\l    else if move = B then … else …).a\l   ::\l   ((if move = A\l     then\l       \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l        h = …; i = …\}\l     else …).b\l    :: (….c :: (… :: …)))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   ((if move = A\l     then\l       \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l        h = …; i = …\}\l     else if move = B then … else …).a\l    ::\l    ((if move = A\l      then\l        \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l         h = …; i = …\}\l      else …).b\l     :: (….c :: (… :: …))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   ((if move = A\l     then\l       \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l        h = …; i = …\}\l     else if move = B then … else …).a\l    ::\l    ((if move = A\l      then\l        \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l         h = …; i = …\}\l      else …).b\l     :: (….c :: (… :: …)))))\l   &amp;&amp; Option.get\l      (List.hd\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else if move = B then … else …).a\l        ::\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else …).b\l         :: (….c :: (… :: …)))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_485 [label=&quot;calls&quot;];
call_7943 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_7943 -&gt; expr_8448 [label=&quot;=&quot;];
expr_8448 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (game.grid.a ::\l                 (game.grid.b :: (game.grid.c :: (… :: …))))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_7957 -&gt; call_7943 [label=&quot;calls&quot;];
expr_7957 -&gt; call_7943 [label=&quot;calls&quot;];
expr_7957 -&gt; call_7943 [label=&quot;calls&quot;];
call_4757 [label=&quot;List.for_all ((\&lt;\&gt;) None)\l(List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_4757 -&gt; expr_8272 [label=&quot;=&quot;];
expr_8272 [label=&quot;List.tl\l(List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))) =\l[]\l\|\| not\l   (None =\l    List.hd\l    (List.tl\l     (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))\l   &amp;&amp; List.for_all ((\&lt;\&gt;) None)\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_4759 -&gt; call_4757 [label=&quot;calls&quot;];
call_8270 [label=&quot;List.for_all ((\&lt;\&gt;) None)\l(List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_8270 -&gt; expr_10459 [label=&quot;=&quot;];
expr_10459 [label=&quot;List.tl\l(List.tl\l (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l= []\l\|\| not\l   (None =\l    List.hd\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   &amp;&amp; List.for_all ((\&lt;\&gt;) None)\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_8272 -&gt; call_8270 [label=&quot;calls&quot;];
call_10559 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl ((if move = A then … else …).a :: (….b :: (… :: …))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_10559 -&gt; expr_11223 [label=&quot;=&quot;];
expr_11223 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else if move = B then … else …).a\l          ::\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else …).b\l           :: (….c :: (… :: …))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else if move = B then … else …).a\l           ::\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else …).b\l            :: (….c :: (… :: …)))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else if move = B then … else …).a\l           ::\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else …).b\l            :: (….c :: (… :: …))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              ((if move = A\l                then\l                  \{a = …; b = …; c = …; d = …; e = …; f = …;\l                   g = …; h = …; i = …\}\l                else if move = B then … else …).a\l               ::\l               ((if move = A\l                 then\l                   \{a = …; b = …; c = …; d = …; e = …; f = …;\l                    g = …; h = …; i = …\}\l                 else …).b\l                :: (….c :: (… :: …))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_10573 -&gt; call_10559 [label=&quot;calls&quot;];
expr_10573 -&gt; call_10559 [label=&quot;calls&quot;];
expr_10573 -&gt; call_10559 [label=&quot;calls&quot;];
call_10111 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          ((if move = A then … else …).a :: (….b :: (… :: …)))))))))))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_21681 -&gt; call_10111 [label=&quot;calls&quot;];
expr_21681 -&gt; call_10111 [label=&quot;calls&quot;];
expr_21681 -&gt; call_10111 [label=&quot;calls&quot;];
call_4234 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl ((if move = A then … else …).a :: (….b :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_4234 -&gt; expr_6582 [label=&quot;=&quot;];
expr_6582 [label=&quot;if List.tl\l   (List.tl\l    ((if move = A\l      then\l        \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l         h = …; i = …\}\l      else if move = B then … else …).a\l     ::\l     ((if move = A\l       then\l         \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l          h = …; i = …\}\l       else …).b\l      :: (….c :: (… :: …)))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     ((if move = A\l       then\l         \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l          h = …; i = …\}\l       else if move = B then … else …).a\l      ::\l      ((if move = A\l        then\l          \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l           h = …; i = …\}\l        else …).b\l       :: (….c :: (… :: …))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     ((if move = A\l       then\l         \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l          h = …; i = …\}\l       else if move = B then … else …).a\l      ::\l      ((if move = A\l        then\l          \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l           h = …; i = …\}\l        else …).b\l       :: (….c :: (… :: …)))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else if move = B then … else …).a\l          ::\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else …).b\l           :: (….c :: (… :: …)))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_4248 -&gt; call_4234 [label=&quot;calls&quot;];
expr_4248 -&gt; call_4234 [label=&quot;calls&quot;];
expr_4248 -&gt; call_4234 [label=&quot;calls&quot;];
call_6188 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_6188 -&gt; expr_6901 [label=&quot;=&quot;];
expr_6901 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_6202 -&gt; call_6188 [label=&quot;calls&quot;];
expr_6202 -&gt; call_6188 [label=&quot;calls&quot;];
expr_6202 -&gt; call_6188 [label=&quot;calls&quot;];
call_8434 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))))&quot;,shape=box,style=filled,color=&quot;yellow&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_8448 -&gt; call_8434 [label=&quot;calls&quot;];
expr_8448 -&gt; call_8434 [label=&quot;calls&quot;];
expr_8448 -&gt; call_8434 [label=&quot;calls&quot;];
call_19879 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         ((if move = A then … else …).a :: (….b :: (… :: …))))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_19879 -&gt; expr_21681 [label=&quot;=&quot;];
expr_21681 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else if move = B then … else …).a\l            ::\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else …).b\l             :: (….c :: (… :: …))))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else if move = B then … else …).a\l             ::\l             ((if move = A\l               then\l                 \{a = …; b = …; c = …; d = …; e = …; f = …;\l                  g = …; h = …; i = …\}\l               else …).b\l              :: (….c :: (… :: …)))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else if move = B then … else …).a\l             ::\l             ((if move = A\l               then\l                 \{a = …; b = …; c = …; d = …; e = …; f = …;\l                  g = …; h = …; i = …\}\l               else …).b\l              :: (….c :: (… :: …))))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                ((if move = A\l                  then\l                    \{a = …; b = …; c = …; d = …; e = …; f = …;\l                     g = …; h = …; i = …\}\l                  else if move = B then … else …).a\l                 ::\l                 ((if move = A\l                   then\l                     \{a = …; b = …; c = …; d = …; e = …; f = …;\l                      g = …; h = …; i = …\}\l                   else …).b\l                  :: (….c :: (… :: …))))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_19893 -&gt; call_19879 [label=&quot;calls&quot;];
expr_19893 -&gt; call_19879 [label=&quot;calls&quot;];
expr_19893 -&gt; call_19879 [label=&quot;calls&quot;];
call_3192 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl ((if move = A then … else …).a :: (….b :: (… :: …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3192 -&gt; expr_4248 [label=&quot;=&quot;];
expr_4248 [label=&quot;if List.tl\l   ((if move = A\l     then\l       \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l        h = …; i = …\}\l     else if move = B then … else …).a\l    ::\l    ((if move = A\l      then\l        \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l         h = …; i = …\}\l      else …).b\l     :: (….c :: (… :: …))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    ((if move = A\l      then\l        \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l         h = …; i = …\}\l      else if move = B then … else …).a\l     ::\l     ((if move = A\l       then\l         \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l          h = …; i = …\}\l       else …).b\l      :: (….c :: (… :: …)))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    ((if move = A\l      then\l        \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l         h = …; i = …\}\l      else if move = B then … else …).a\l     ::\l     ((if move = A\l       then\l         \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l          h = …; i = …\}\l       else …).b\l      :: (….c :: (… :: …))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else if move = B then … else …).a\l         ::\l         ((if move = A\l           then\l             \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l              h = …; i = …\}\l           else …).b\l          :: (….c :: (… :: …))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3209 -&gt; call_3192 [label=&quot;calls&quot;];
expr_3209 -&gt; call_3192 [label=&quot;calls&quot;];
expr_3209 -&gt; call_3192 [label=&quot;calls&quot;];
call_3829 [label=&quot;List.for_all ((\&lt;\&gt;) None)\l(List.tl (….grid.a :: (….grid.b :: (… :: …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3829 -&gt; expr_4759 [label=&quot;=&quot;];
expr_4759 [label=&quot;List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) = []\l\|\| not\l   (None =\l    List.hd\l    (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   &amp;&amp; List.for_all ((\&lt;\&gt;) None)\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3831 -&gt; call_3829 [label=&quot;calls&quot;];
call_7616 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_7616 -&gt; expr_7957 [label=&quot;=&quot;];
expr_7957 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_7630 -&gt; call_7616 [label=&quot;calls&quot;];
expr_7630 -&gt; call_7616 [label=&quot;calls&quot;];
expr_7630 -&gt; call_7616 [label=&quot;calls&quot;];
call_8472 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl ((if move = A then … else …).a :: (….b :: (… :: …)))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_8472 -&gt; expr_8864 [label=&quot;=&quot;];
expr_8864 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      ((if move = A\l        then\l          \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l           h = …; i = …\}\l        else if move = B then … else …).a\l       ::\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else …).b\l        :: (….c :: (… :: …)))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else if move = B then … else …).a\l        ::\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else …).b\l         :: (….c :: (… :: …))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else if move = B then … else …).a\l        ::\l        ((if move = A\l          then\l            \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l             h = …; i = …\}\l          else …).b\l         :: (….c :: (… :: …)))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else if move = B then … else …).a\l            ::\l            ((if move = A\l              then\l                \{a = …; b = …; c = …; d = …; e = …; f = …;\l                 g = …; h = …; i = …\}\l              else …).b\l             :: (….c :: (… :: …)))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_8498 -&gt; call_8472 [label=&quot;calls&quot;];
expr_8498 -&gt; call_8472 [label=&quot;calls&quot;];
expr_8498 -&gt; call_8472 [label=&quot;calls&quot;];
call_3920 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_3920 -&gt; expr_4934 [label=&quot;=&quot;];
expr_4934 [label=&quot;if List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))) =\l   []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_3934 -&gt; call_3920 [label=&quot;calls&quot;];
expr_3934 -&gt; call_3920 [label=&quot;calls&quot;];
expr_3934 -&gt; call_3920 [label=&quot;calls&quot;];
call_6887 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_6887 -&gt; expr_7252 [label=&quot;=&quot;];
expr_7252 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_6901 -&gt; call_6887 [label=&quot;calls&quot;];
expr_6901 -&gt; call_6887 [label=&quot;calls&quot;];
expr_6901 -&gt; call_6887 [label=&quot;calls&quot;];
call_409 [label=&quot;List.for_all ((\&lt;\&gt;) None) (….grid.a :: (….grid.b :: (… :: …)))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_409 -&gt; expr_3831 [label=&quot;=&quot;];
expr_3831 [label=&quot;game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))) = []\l\|\| not\l   (None =\l    List.hd (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))\l   &amp;&amp; List.for_all ((\&lt;\&gt;) None)\l      (List.tl\l       (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
goal -&gt; call_409 [label=&quot;calls&quot;];
call_6568 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl ((if move = A then … else …).a :: (….b :: (… :: …))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_6568 -&gt; expr_8498 [label=&quot;=&quot;];
expr_8498 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     ((if move = A\l       then\l         \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l          h = …; i = …\}\l       else if move = B then … else …).a\l      ::\l      ((if move = A\l        then\l          \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l           h = …; i = …\}\l        else …).b\l       :: (….c :: (… :: …))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      ((if move = A\l        then\l          \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l           h = …; i = …\}\l        else if move = B then … else …).a\l       ::\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else …).b\l        :: (….c :: (… :: …)))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      ((if move = A\l        then\l          \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l           h = …; i = …\}\l        else if move = B then … else …).a\l       ::\l       ((if move = A\l         then\l           \{a = …; b = …; c = …; d = …; e = …; f = …; g = …;\l            h = …; i = …\}\l         else …).b\l        :: (….c :: (… :: …))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          ((if move = A\l            then\l              \{a = …; b = …; c = …; d = …; e = …; f = …; \l               g = …; h = …; i = …\}\l            else if move = B then … else …).a\l           ::\l           ((if move = A\l             then\l               \{a = …; b = …; c = …; d = …; e = …; f = …;\l                g = …; h = …; i = …\}\l             else …).b\l            :: (….c :: (… :: …))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_6582 -&gt; call_6568 [label=&quot;calls&quot;];
expr_6582 -&gt; call_6568 [label=&quot;calls&quot;];
expr_6582 -&gt; call_6568 [label=&quot;calls&quot;];
call_7238 [label=&quot;List.fold_right\l(fun el _x\l -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l    if el = None then (x, o)\l    else\l    if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o) else (x, o + 1))\l(0, 0)\l(List.tl\l (List.tl\l  (List.tl\l   (List.tl\l    (List.tl (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))&quot;,shape=box,style=filled,color=&quot;green&quot;,fontname=&quot;courier&quot;,fontsize=14];
call_7238 -&gt; expr_7630 [label=&quot;=&quot;];
expr_7630 [label=&quot;if List.tl\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))\l   = []\lthen (0, 0)\lelse\lif List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …)))))))))))\l   = None\lthen (….0, ….1)\lelse\lif Is_a(Some,\l   List.hd\l   (List.tl\l    (List.tl\l     (List.tl\l      (List.tl\l       (List.tl\l        (List.tl\l         (List.tl\l          (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l   &amp;&amp; Option.get\l      (List.hd\l       (List.tl\l        (List.tl\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (game.grid.a :: (game.grid.b :: (game.grid.c :: (… :: …))))))))))))\l      = X\lthen (…, ….1) else (….0, …)&quot;,shape=box,style=filled,color=&quot;grey&quot;,fontname=&quot;courier&quot;,fontsize=14];
expr_7252 -&gt; call_7238 [label=&quot;calls&quot;];
expr_7252 -&gt; call_7238 [label=&quot;calls&quot;];
expr_7252 -&gt; call_7238 [label=&quot;calls&quot;];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-e6215e10-d657-4697-8b1b-3dc4fa33796f';
  graphviz.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-proof-top"><div class="imandra-fold panel panel-default" id="fold-9609875f-7735-40ce-b502-fc65f56924d3"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>proof attempt</span></div></div><div class="panel-body collapse"><div class="imandra-proof"><div class="imandra-alternatives" id="alt-ece8b9be-0cd9-421f-a270-10f8bf8b77a3"><ul class="nav nav-tabs"><li class="active" data-toggle="tab"><a>summary</a></li><li class="" data-toggle="tab"><a>full</a></li><li class="" data-toggle="tab"><a>graph</a></li></ul><div class="tab-content"><div class="tab-pane active"><div class="imandra-table" id="table-02db2e2d-1584-4d1d-b05f-5fd977307288"><table><tr><td><b>ground_instances</b></td><td>24</td></tr><tr><td><b>definitions</b></td><td>0</td></tr><tr><td><b>inductions</b></td><td>0</td></tr><tr><td><b>search_time</b></td><td><pre>0.554s</pre></td></tr><tr><td><b>details</b></td><td><div class="imandra-fold panel panel-default" id="fold-5cd7b732-10d3-485c-8335-2697492c619d"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><div class="imandra-table" id="table-ef2e7de7-5941-4783-bcbb-f077e0b3de3d"><table><tr><td><b>smt_stats</b></td><td><div class="imandra-table" id="table-d6e29cd9-1049-424b-a609-4eabd66db497"><table><tr><td><b>arith offset eqs</b></td><td>11720</td></tr><tr><td><b>num checks</b></td><td>49</td></tr><tr><td><b>arith assert lower</b></td><td>12474</td></tr><tr><td><b>arith pivots</b></td><td>1252</td></tr><tr><td><b>rlimit count</b></td><td>1240275</td></tr><tr><td><b>mk clause</b></td><td>4939</td></tr><tr><td><b>datatype occurs check</b></td><td>2360</td></tr><tr><td><b>restarts</b></td><td>4</td></tr><tr><td><b>mk bool var</b></td><td>11672</td></tr><tr><td><b>arith assert upper</b></td><td>11432</td></tr><tr><td><b>datatype splits</b></td><td>1736</td></tr><tr><td><b>decisions</b></td><td>9226</td></tr><tr><td><b>arith add rows</b></td><td>19183</td></tr><tr><td><b>arith bound prop</b></td><td>2181</td></tr><tr><td><b>propagations</b></td><td>57488</td></tr><tr><td><b>interface eqs</b></td><td>45</td></tr><tr><td><b>conflicts</b></td><td>774</td></tr><tr><td><b>arith fixed eqs</b></td><td>10262</td></tr><tr><td><b>datatype accessor ax</b></td><td>679</td></tr><tr><td><b>minimized lits</b></td><td>787</td></tr><tr><td><b>arith conflicts</b></td><td>83</td></tr><tr><td><b>arith assert diseq</b></td><td>6393</td></tr><tr><td><b>datatype constructor ax</b></td><td>5881</td></tr><tr><td><b>num allocs</b></td><td>163366858</td></tr><tr><td><b>final checks</b></td><td>70</td></tr><tr><td><b>added eqs</b></td><td>101133</td></tr><tr><td><b>del clause</b></td><td>1380</td></tr><tr><td><b>dyn ack</b></td><td>1</td></tr><tr><td><b>arith eq adapter</b></td><td>1977</td></tr><tr><td><b>memory</b></td><td>36.390000</td></tr><tr><td><b>max memory</b></td><td>36.630000</td></tr></table></div></td></tr></table></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-5cd7b732-10d3-485c-8335-2697492c619d';
  fold.hydrate(target);
});
</script></div></td></tr></table></div></div><div class="tab-pane"><div class="imandra-fold panel panel-default" id="fold-76c69e53-66b8-49b8-b2e3-f57198af9f02"><div class="panel-heading"><div><i class="fa fa-chevron-down hidden"></i><i class="fa fa-chevron-right"></i><span>Expand</span></div></div><div class="panel-body collapse"><ul><li><pre>start[0.554s]
  ((if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &gt;
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      :var_0:.last_player = Some X
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).0
         -
         (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         = 1
    else
    if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &lt;
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      :var_0:.last_player = Some O
      &amp;&amp; (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).1
         -
         (List.fold_right
          (fun el _x
           -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
              if el = None then (x, o)
              else
              if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
              else (x, o + 1))
          (0, 0) (….a :: (… :: …))).0
         = 1
    else true)
   &amp;&amp; (not
       ((….a, …, ….c) = (Some X, Some X, Some X)
        || (….d, ….e, ….f) = (Some X, Some X, Some X)
           || (….g, ….h, ….i) = (Some X, Some X, Some X)
              || (….a, ….d, ….g) = (Some X, Some X, Some X)
                 || (…, ….e, ….h) = (Some X, Some X, Some X)
                    || (….c, ….f, ….i) = (Some X, Some X, Some X)
                       || (….a, ….e, ….i) = (Some X, Some X, Some X)
                          || (….c, ….e, ….g) = (Some X, Some X, Some X))
       &amp;&amp; not
          ((….a, …, ….c) = (Some O, Some O, Some O)
           || (….d, ….e, ….f) = (Some O, Some O, Some O)
              || (….g, ….h, ….i) = (Some O, Some O, Some O)
                 || (….a, ….d, ….g) = (Some O, Some O, Some O)
                    || (…, ….e, ….h) = (Some O, Some O, Some O)
                       || (….c, ….f, ….i) = (Some O, Some O, Some O)
                          || (….a, ….e, ….i) = (Some O, Some O, Some O)
                             || (….c, ….e, ….g) =
                                (Some O, Some O, Some O))
       || not
          (((….a, …, ….c) = (Some X, Some X, Some X)
            || (….d, ….e, ….f) = (Some X, Some X, Some X)
               || (….g, ….h, ….i) = (Some X, Some X, Some X)
                  || (….a, ….d, ….g) = (Some X, Some X, Some X)
                     || (…, ….e, ….h) = (Some X, Some X, Some X)
                        || (….c, ….f, ….i) = (Some X, Some X, Some X)
                           || (….a, ….e, ….i) =
                              (Some X, Some X, Some X)
                              || (….c, ….e, ….g) =
                                 (Some X, Some X, Some X))
           =
           ((….a, …, ….c) = (Some O, Some O, Some O)
            || (….d, ….e, ….f) = (Some O, Some O, Some O)
               || (….g, ….h, ….i) = (Some O, Some O, Some O)
                  || (….a, ….d, ….g) = (Some O, Some O, Some O)
                     || (…, ….e, ….h) = (Some O, Some O, Some O)
                        || (….c, ….f, ….i) = (Some O, Some O, Some O)
                           || (….a, ….e, ….i) =
                              (Some O, Some O, Some O)
                              || (….c, ….e, ….g) =
                                 (Some O, Some O, Some O)))))
  &amp;&amp; not
     (((….a, …, ….c) = (Some X, Some X, Some X)
       || (….d, ….e, ….f) = (Some X, Some X, Some X)
          || (….g, ….h, ….i) = (Some X, Some X, Some X)
             || (….a, ….d, ….g) = (Some X, Some X, Some X)
                || (…, ….e, ….h) = (Some X, Some X, Some X)
                   || (….c, ….f, ….i) = (Some X, Some X, Some X)
                      || (….a, ….e, ….i) = (Some X, Some X, Some X)
                         || (….c, ….e, ….g) = (Some X, Some X, Some X))
      || ((….a, …, ….c) = (Some O, Some O, Some O)
          || (….d, ….e, ….f) = (Some O, Some O, Some O)
             || (….g, ….h, ….i) = (Some O, Some O, Some O)
                || (….a, ….d, ….g) = (Some O, Some O, Some O)
                   || (…, ….e, ….h) = (Some O, Some O, Some O)
                      || (….c, ….f, ….i) = (Some O, Some O, Some O)
                         || (….a, ….e, ….i) = (Some O, Some O, Some O)
                            || (….c, ….e, ….g) =
                               (Some O, Some O, Some O))
         || List.for_all ((&lt;&gt;) None) (….a :: (… :: …)))
     &amp;&amp; …
  ==&gt; …</pre></li><li><div><h4>simplify</h4><div class="imandra-table" id="table-568f5a99-bb09-4908-90c8-8eb0fd220406"><table><tr><td><b>into</b></td><td><pre>not
((((if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &lt;=
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1
      &lt;=
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      || :var_0:.last_player = Some O
         &amp;&amp; (List.fold_right
             (fun el _x
              -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                 if el = None then (x, o)
                 else
                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                 else (x, o + 1))
             (0, 0) (….a :: (… :: …))).1
            + -1
              * (List.fold_right
                 (fun el _x
                  -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                     if el = None then (x, o)
                     else
                     if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                     else (x, o + 1))
                 (0, 0) (….a :: (… :: …))).0
            = 1
    else
      (:var_0:.last_player = Some X
       &amp;&amp; (List.fold_right
           (fun el _x
            -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
               if el = None then (x, o)
               else
               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
               else (x, o + 1))
           (0, 0) (….a :: (… :: …))).0
          + -1
            * (List.fold_right
               (fun el _x
                -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                   if el = None then (x, o)
                   else
                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                   else (x, o + 1))
               (0, 0) (….a :: (… :: …))).1
          = 1))
   &amp;&amp; (not
       ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X
              || (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)
             || (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)
            || (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)
           || (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)
          || (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)
         || (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)
        || (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)
       &amp;&amp; not
          ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O
                 || (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)
                || (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)
               || (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)
              || (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)
             || (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)
            || (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)
           || (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)
       || not
          ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X
                 || (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)
                || (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)
               || (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)
              || (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)
             || (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)
            || (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)
           || (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)
          =
          ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O
                 || (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)
                || (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)
               || (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)
              || (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)
             || (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)
            || (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)
           || (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)))
  &amp;&amp; not
     (((((((((((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X
                     || (….d = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….f = Some X)
                    || (….g = Some X &amp;&amp; ….h = Some X) &amp;&amp; ….i = Some X)
                   || (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)
                  || (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)
                 || (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)
                || (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)
               || (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)
              || (….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O)
             || (….d = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….f = Some O)
            || (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)
           || (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)
          || (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)
         || (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)
        || (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)
       || (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)
      || List.for_all ((&lt;&gt;) None) (….a :: (… :: …))))
 &amp;&amp; (:var_0:.last_player = None &amp;&amp; :var_1: = X
     || :var_0:.last_player = Some (if :var_1: = X then O else X)))
|| (if (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).0
       &lt;=
       (List.fold_right
        (fun el _x
         -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
            if el = None then (x, o)
            else
            if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
            else (x, o + 1))
        (0, 0) (….a :: (… :: …))).1
    then
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).1
      &lt;=
      (List.fold_right
       (fun el _x
        -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
           if el = None then (x, o)
           else
           if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
           else (x, o + 1))
       (0, 0) (….a :: (… :: …))).0
      || :var_1: = O
         &amp;&amp; (List.fold_right
             (fun el _x
              -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                 if el = None then (x, o)
                 else
                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                 else (x, o + 1))
             (0, 0) (….a :: (… :: …))).1
            + -1
              * (List.fold_right
                 (fun el _x
                  -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                     if el = None then (x, o)
                     else
                     if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                     else (x, o + 1))
                 (0, 0) (….a :: (… :: …))).0
            = 1
    else
      (:var_1: = X
       &amp;&amp; (List.fold_right
           (fun el _x
            -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
               if el = None then (x, o)
               else
               if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
               else (x, o + 1))
           (0, 0) (….a :: (… :: …))).0
          + -1
            * (List.fold_right
               (fun el _x
                -&gt; let (x : int) = _x.0 and (o : int) = _x.1 in
                   if el = None then (x, o)
                   else
                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)
                   else (x, o + 1))
               (0, 0) (….a :: (… :: …))).1
          = 1))
   &amp;&amp; (not
       ((((((((….a = Some X &amp;&amp; … = Some X)
              &amp;&amp; (if :var_2: = A
                  then
                    {a = Some :var_1:; b = …; c = ….c; d = ….d;
                     e = ….e; f = ….f; g = ….g; h = ….h; i = ….i}
                  else …).c
                 = Some X
              || …)
             || …)
            || …)
           || …)
          || …)
         || …)
        || …)
       &amp;&amp; … || …)</pre></td></tr><tr><td><b>expansions</b></td><td><pre>[]</pre></td></tr><tr><td><b>rewrite_steps</b></td><td><ul></ul></td></tr><tr><td><b>forward_chaining</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-3ea3e18b-aa60-4f50-bef5-f531c5e71619"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-9989d3ee-4acf-4f17-8eaa-837cc85b7348"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-b8925d08-20c3-4f0a-89a3-13f064bcbe84"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-c35f911d-b186-44bf-9830-c1f9599344e7"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-0e9282bd-3dd4-4b27-9f69-b433d95faa6b"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ecd9d17c-9f2d-4bf6-8cf0-2fa011bb209b"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-d5e80116-b42a-49e3-85b3-ae04cc63d75c"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-f647f07d-e314-478b-ac06-c0898a374606"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-88235fe3-a7e1-4c0d-807f-22cd1a446ded"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-314b1f0a-c649-4abe-b794-7c31c9707e5c"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-9b76e8ab-4d8c-4ebd-8c05-63d866d74fdf"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-df0e8d70-8432-48cb-aa94-2322b617bf2a"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ae2434ce-33d1-4f26-a75e-ae5d7c0a7114"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-86ef8b05-68b3-418b-8086-287b6b7c440f"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-216620a7-d4e5-4e96-95d8-a2f6d8b51602"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-817f3ad1-88f3-4232-b92f-fee96ddcdc34"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-5e367f04-1616-489b-8a3e-bc74171e0a02"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-24c8c6f9-c2b7-4251-bd38-e1e56087e912"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ad721e14-0849-4c6b-9c3a-91abe8e5ba82"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-0e38f383-976d-4c12-81e7-d55da16cf858"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (|::_3| (h_26 (grid_40 game_151))
                   (|::_3| (i_27 (grid_40 game_151)) |[…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-7e5ad728-2c6a-414c-a669-62b7a1136a35"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ab78ba35-cdc6-458c-9f8e-56fb95d5484d"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-af43a9ca-bab1-46e2-b2aa-39c1f4d33242"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li><div>unroll<div class="imandra-table" id="table-ae266cfd-fb97-402e-9a21-66a5b4eb5275"><table><tr><td><b>expr</b></td><td><pre>(let ((a!1 (ite (= move_153 H_37)
                (|rec_mk.grid_1974|
                  (a_19 (grid_…</pre></td></tr><tr><td><b>expansions</b></td><td><ul></ul></td></tr></table></div></div></li><li>Sat (Some  let (game : game_state) =
   {grid =
     {a = (Some X); b = (Some O); c = None; d = (Some X); e = (Some O);
      f = (Some O); g = (Some O); h = (Some X); i = None};
    last_player = (Some O)}
 let (player : player) = X
 let (move : move) = D
)</li></ul></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-76c69e53-66b8-49b8-b2e3-f57198af9f02';
  fold.hydrate(target);
});
</script></div></div><div class="tab-pane"><div class="imandra-graphviz" id="graphviz-6a02d2b2-dad1-459f-8c8e-71d7a50d01f8"><textarea style="display: none">digraph &quot;proof&quot; {
p_74 [label=&quot;Start (((if (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \&gt;\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l         then\l           :var_0:.last_player = Some X\l           &amp;&amp; (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              -\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              = 1\l         else\l         if (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).0\l            \&lt;\l            (List.fold_right\l             (fun el _x\l              -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                 if el = None then (x, o)\l                 else\l                 if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                 else (x, o + 1))\l             (0, 0) (….a :: (… :: …))).1\l         then\l           :var_0:.last_player = Some O\l           &amp;&amp; (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).1\l              -\l              (List.fold_right\l               (fun el _x\l                -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                   if el = None then (x, o)\l                   else\l                   if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                   else (x, o + 1))\l               (0, 0) (….a :: (… :: …))).0\l              = 1\l         else true)\l        &amp;&amp; (not\l            ((….a, …, ….c) = (Some X, Some X, Some X)\l             \|\| (….d, ….e, ….f) = (Some X, Some X, Some X)\l                \|\| (….g, ….h, ….i) = (Some X, Some X, Some X)\l                   \|\| (….a, ….d, ….g) = (Some X, Some X, Some X)\l                      \|\| (…, ….e, ….h) = (Some X, Some X, Some X)\l                         \|\| (….c, ….f, ….i) = (Some X, Some X, Some X)\l                            \|\| (….a, ….e, ….i) =\l                               (Some X, Some X, Some X)\l                               \|\| (….c, ….e, ….g) =\l                                  (Some X, Some X, Some X))\l            &amp;&amp; not\l               ((….a, …, ….c) = (Some O, Some O, Some O)\l                \|\| (….d, ….e, ….f) = (Some O, Some O, Some O)\l                   \|\| (….g, ….h, ….i) = (Some O, Some O, Some O)\l                      \|\| (….a, ….d, ….g) = (Some O, Some O, Some O)\l                         \|\| (…, ….e, ….h) = (Some O, Some O, Some O)\l                            \|\| (….c, ….f, ….i) =\l                               (Some O, Some O, Some O)\l                               \|\| (….a, ….e, ….i) =\l                                  (Some O, Some O, Some O)\l                                  \|\| (….c, ….e, ….g) =\l                                     (Some O, Some O, Some O))\l            \|\| not\l               (((….a, …, ….c) = (Some X, Some X, Some X)\l                 \|\| (….d, ….e, ….f) = (Some X, Some X, Some X)\l                    \|\| (….g, ….h, ….i) = (Some X, Some X, Some X)\l                       \|\| (….a, ….d, ….g) = (Some X, Some X, Some X)\l                          \|\| (…, ….e, ….h) = (Some X, Some X, Some X)\l                             \|\| (….c, ….f, ….i) =\l                                (Some X, Some X, Some X)\l                                \|\| (….a, ….e, ….i) =\l                                   (Some X, Some X, Some X)\l                                   \|\| (….c, ….e, ….g) =\l                                      (Some X, Some X, Some X))\l                =\l                ((….a, …, ….c) = (Some O, Some O, Some O)\l                 \|\| (….d, ….e, ….f) = (Some O, Some O, Some O)\l                    \|\| (….g, ….h, ….i) = (Some O, Some O, Some O)\l                       \|\| (….a, ….d, ….g) = (Some O, Some O, Some O)\l                          \|\| (…, ….e, ….h) = (Some O, Some O, Some O)\l                             \|\| (….c, ….f, ….i) =\l                                (Some O, Some O, Some O)\l                                \|\| (….a, ….e, ….i) =\l                                   (Some O, Some O, Some O)\l                                   \|\| (….c, ….e, ….g) =\l                                      (Some O, Some O, Some O)))))\l       &amp;&amp; not\l          (((….a, …, ….c) = (Some X, Some X, Some X)\l            \|\| (….d, ….e, ….f) = (Some X, Some X, Some X)\l               \|\| (….g, ….h, ….i) = (Some X, Some X, Some X)\l                  \|\| (….a, ….d, ….g) = (Some X, Some X, Some X)\l                     \|\| (…, ….e, ….h) = (Some X, Some X, Some X)\l                        \|\| (….c, ….f, ….i) = (Some X, Some X, Some X)\l                           \|\| (….a, ….e, ….i) =\l                              (Some X, Some X, Some X)\l                              \|\| (….c, ….e, ….g) =\l                                 (Some X, Some X, Some X))\l           \|\| ((….a, …, ….c) = (Some O, Some O, Some O)\l               \|\| (….d, ….e, ….f) = (Some O, Some O, Some O)\l                  \|\| (….g, ….h, ….i) = (Some O, Some O, Some O)\l                     \|\| (….a, ….d, ….g) = (Some O, Some O, Some O)\l                        \|\| (…, ….e, ….h) = (Some O, Some O, Some O)\l                           \|\| (….c, ….f, ….i) =\l                              (Some O, Some O, Some O)\l                              \|\| (….a, ….e, ….i) =\l                                 (Some O, Some O, Some O)\l                                 \|\| (….c, ….e, ….g) =\l                                    (Some O, Some O, Some O))\l              \|\| List.for_all ((\&lt;\&gt;) None) (….a :: (… :: …)))\l          &amp;&amp; …\l       ==\&gt; … :time 0.554s)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_74 -&gt; p_73 [label=&quot;&quot;];
p_73 [label=&quot;Simplify (not\l          ((((if (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).0\l                 \&lt;=\l                 (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).1\l              then\l                (List.fold_right\l                 (fun el _x\l                  -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                     if el = None then (x, o)\l                     else\l                     if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                     else (x, o + 1))\l                 (0, 0) (….a :: (… :: …))).1\l                \&lt;=\l                (List.fold_right\l                 (fun el _x\l                  -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                     if el = None then (x, o)\l                     else\l                     if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                     else (x, o + 1))\l                 (0, 0) (….a :: (… :: …))).0\l                \|\| :var_0:.last_player = Some O\l                   &amp;&amp; (List.fold_right\l                       (fun el _x\l                        -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                           if el = None then (x, o)\l                           else\l                           if Is_a(Some, el) &amp;&amp; Option.get el = X\l                           then (x + 1, o) else (x, o + 1))\l                       (0, 0) (….a :: (… :: …))).1\l                      + -1\l                        * (List.fold_right\l                           (fun el _x\l                            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                               if el = None then (x, o)\l                               else\l                               if Is_a(Some, el) &amp;&amp; Option.get el = X\l                               then (x + 1, o) else (x, o + 1))\l                           (0, 0) (….a :: (… :: …))).0\l                      = 1\l              else\l                (:var_0:.last_player = Some X\l                 &amp;&amp; (List.fold_right\l                     (fun el _x\l                      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                         if el = None then (x, o)\l                         else\l                         if Is_a(Some, el) &amp;&amp; Option.get el = X\l                         then (x + 1, o) else (x, o + 1))\l                     (0, 0) (….a :: (… :: …))).0\l                    + -1\l                      * (List.fold_right\l                         (fun el _x\l                          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                             if el = None then (x, o)\l                             else\l                             if Is_a(Some, el) &amp;&amp; Option.get el = X\l                             then (x + 1, o) else (x, o + 1))\l                         (0, 0) (….a :: (… :: …))).1\l                    = 1))\l             &amp;&amp; (not\l                 ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                        \|\| (….d = Some X &amp;&amp; ….e = Some X)\l                           &amp;&amp; ….f = Some X)\l                       \|\| (….g = Some X &amp;&amp; ….h = Some X)\l                          &amp;&amp; ….i = Some X)\l                      \|\| (….a = Some X &amp;&amp; ….d = Some X) &amp;&amp; ….g = Some X)\l                     \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l                    \|\| (….c = Some X &amp;&amp; ….f = Some X) &amp;&amp; ….i = Some X)\l                   \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l                  \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l                 &amp;&amp; not\l                    ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l                           \|\| (….d = Some O &amp;&amp; ….e = Some O)\l                              &amp;&amp; ….f = Some O)\l                          \|\| (….g = Some O &amp;&amp; ….h = Some O)\l                             &amp;&amp; ….i = Some O)\l                         \|\| (….a = Some O &amp;&amp; ….d = Some O)\l                            &amp;&amp; ….g = Some O)\l                        \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l                       \|\| (….c = Some O &amp;&amp; ….f = Some O)\l                          &amp;&amp; ….i = Some O)\l                      \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l                     \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)\l                 \|\| not\l                    ((((((((….a = Some X &amp;&amp; … = Some X) &amp;&amp; ….c = Some X\l                           \|\| (….d = Some X &amp;&amp; ….e = Some X)\l                              &amp;&amp; ….f = Some X)\l                          \|\| (….g = Some X &amp;&amp; ….h = Some X)\l                             &amp;&amp; ….i = Some X)\l                         \|\| (….a = Some X &amp;&amp; ….d = Some X)\l                            &amp;&amp; ….g = Some X)\l                        \|\| (… = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….h = Some X)\l                       \|\| (….c = Some X &amp;&amp; ….f = Some X)\l                          &amp;&amp; ….i = Some X)\l                      \|\| (….a = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….i = Some X)\l                     \|\| (….c = Some X &amp;&amp; ….e = Some X) &amp;&amp; ….g = Some X)\l                    =\l                    ((((((((….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O\l                           \|\| (….d = Some O &amp;&amp; ….e = Some O)\l                              &amp;&amp; ….f = Some O)\l                          \|\| (….g = Some O &amp;&amp; ….h = Some O)\l                             &amp;&amp; ….i = Some O)\l                         \|\| (….a = Some O &amp;&amp; ….d = Some O)\l                            &amp;&amp; ….g = Some O)\l                        \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l                       \|\| (….c = Some O &amp;&amp; ….f = Some O)\l                          &amp;&amp; ….i = Some O)\l                      \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l                     \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)))\l            &amp;&amp; not\l               (((((((((((((((((….a = Some X &amp;&amp; … = Some X)\l                               &amp;&amp; ….c = Some X\l                               \|\| (….d = Some X &amp;&amp; ….e = Some X)\l                                  &amp;&amp; ….f = Some X)\l                              \|\| (….g = Some X &amp;&amp; ….h = Some X)\l                                 &amp;&amp; ….i = Some X)\l                             \|\| (….a = Some X &amp;&amp; ….d = Some X)\l                                &amp;&amp; ….g = Some X)\l                            \|\| (… = Some X &amp;&amp; ….e = Some X)\l                               &amp;&amp; ….h = Some X)\l                           \|\| (….c = Some X &amp;&amp; ….f = Some X)\l                              &amp;&amp; ….i = Some X)\l                          \|\| (….a = Some X &amp;&amp; ….e = Some X)\l                             &amp;&amp; ….i = Some X)\l                         \|\| (….c = Some X &amp;&amp; ….e = Some X)\l                            &amp;&amp; ….g = Some X)\l                        \|\| (….a = Some O &amp;&amp; … = Some O) &amp;&amp; ….c = Some O)\l                       \|\| (….d = Some O &amp;&amp; ….e = Some O)\l                          &amp;&amp; ….f = Some O)\l                      \|\| (….g = Some O &amp;&amp; ….h = Some O) &amp;&amp; ….i = Some O)\l                     \|\| (….a = Some O &amp;&amp; ….d = Some O) &amp;&amp; ….g = Some O)\l                    \|\| (… = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….h = Some O)\l                   \|\| (….c = Some O &amp;&amp; ….f = Some O) &amp;&amp; ….i = Some O)\l                  \|\| (….a = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….i = Some O)\l                 \|\| (….c = Some O &amp;&amp; ….e = Some O) &amp;&amp; ….g = Some O)\l                \|\| List.for_all ((\&lt;\&gt;) None) (….a :: (… :: …))))\l           &amp;&amp; (:var_0:.last_player = None &amp;&amp; :var_1: = X\l               \|\| :var_0:.last_player = Some (if :var_1: = X then O else X)))\l          \|\| (if (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).0\l                 \&lt;=\l                 (List.fold_right\l                  (fun el _x\l                   -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                      if el = None then (x, o)\l                      else\l                      if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                      else (x, o + 1))\l                  (0, 0) (….a :: (… :: …))).1\l              then\l                (List.fold_right\l                 (fun el _x\l                  -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                     if el = None then (x, o)\l                     else\l                     if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                     else (x, o + 1))\l                 (0, 0) (….a :: (… :: …))).1\l                \&lt;=\l                (List.fold_right\l                 (fun el _x\l                  -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                     if el = None then (x, o)\l                     else\l                     if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l                     else (x, o + 1))\l                 (0, 0) (….a :: (… :: …))).0\l                \|\| :var_1: = O\l                   &amp;&amp; (List.fold_right\l                       (fun el _x\l                        -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                           if el = None then (x, o)\l                           else\l                           if Is_a(Some, el) &amp;&amp; Option.get el = X\l                           then (x + 1, o) else (x, o + 1))\l                       (0, 0) (….a :: (… :: …))).1\l                      + -1\l                        * (List.fold_right\l                           (fun el _x\l                            -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                               if el = None then (x, o)\l                               else\l                               if Is_a(Some, el) &amp;&amp; Option.get el = X\l                               then (x + 1, o) else (x, o + 1))\l                           (0, 0) (….a :: (… :: …))).0\l                      = 1\l              else\l                (:var_1: = X\l                 &amp;&amp; (List.fold_right\l                     (fun el _x\l                      -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                         if el = None then (x, o)\l                         else\l                         if Is_a(Some, el) &amp;&amp; Option.get el = X\l                         then (x + 1, o) else (x, o + 1))\l                     (0, 0) (….a :: (… :: …))).0\l                    + -1\l                      * (List.fold_right\l                         (fun el _x\l                          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l                             if el = None then (x, o)\l                             else\l                             if Is_a(Some, el) &amp;&amp; Option.get el = X\l                             then (x + 1, o) else (x, o + 1))\l                         (0, 0) (….a :: (… :: …))).1\l                    = 1))\l             &amp;&amp; (not\l                 ((((((((….a = Some X &amp;&amp; … = Some X)\l                        &amp;&amp; (if :var_2: = A\l                            then\l                              \{a = Some :var_1:; b = …; c = ….c;\l                               d = ….d; e = ….e; f = ….f; g = ….g;\l                               h = ….h; i = ….i\}\l                            else …).c\l                           = Some X\l                        \|\| …)\l                       \|\| …)\l                      \|\| …)\l                     \|\| …)\l                    \|\| …)\l                   \|\| …)\l                  \|\| …)\l                 &amp;&amp; … \|\| …)\l          :expansions [] :rw [] :fc [])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_73 -&gt; p_72 [label=&quot;&quot;];
p_72 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         ((if move = A then … else …).a :: (….b :: (… :: …)))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_72 -&gt; p_71 [label=&quot;&quot;];
p_71 [label=&quot;Unroll ([List.for_all ((\&lt;\&gt;) None)\l         (….grid.a :: (….grid.b :: (… :: …)))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_71 -&gt; p_70 [label=&quot;&quot;];
p_70 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (….grid.a :: (….grid.b :: (… :: …)))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_70 -&gt; p_69 [label=&quot;&quot;];
p_69 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          ((if move = A then … else …).a :: (….b :: (… :: …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_69 -&gt; p_68 [label=&quot;&quot;];
p_68 [label=&quot;Unroll ([List.for_all ((\&lt;\&gt;) None)\l         (List.tl (….grid.a :: (….grid.b :: (… :: …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_68 -&gt; p_67 [label=&quot;&quot;];
p_67 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0) (List.tl (….grid.a :: (….grid.b :: (… :: …))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_67 -&gt; p_66 [label=&quot;&quot;];
p_66 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_66 -&gt; p_65 [label=&quot;&quot;];
p_65 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_65 -&gt; p_64 [label=&quot;&quot;];
p_64 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_64 -&gt; p_63 [label=&quot;&quot;];
p_63 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           ((if move = A then … else …).a :: (….b :: (… :: …)))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_63 -&gt; p_62 [label=&quot;&quot;];
p_62 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_62 -&gt; p_61 [label=&quot;&quot;];
p_61 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_61 -&gt; p_60 [label=&quot;&quot;];
p_60 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_60 -&gt; p_59 [label=&quot;&quot;];
p_59 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl (….grid.a :: (….grid.b :: (… :: …)))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_59 -&gt; p_58 [label=&quot;&quot;];
p_58 [label=&quot;Unroll ([List.for_all ((\&lt;\&gt;) None)\l         (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …)))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_58 -&gt; p_57 [label=&quot;&quot;];
p_57 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl\l                 (List.tl (….grid.a :: (….grid.b :: (… :: …))))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_57 -&gt; p_56 [label=&quot;&quot;];
p_56 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            ((if move = A then … else …).a :: (….b :: (… :: …))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_56 -&gt; p_55 [label=&quot;&quot;];
p_55 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             ((if move = A then … else …).a :: (….b :: (… :: …)))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_55 -&gt; p_54 [label=&quot;&quot;];
p_54 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              ((if move = A then … else …).a :: (….b :: (… :: …))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_54 -&gt; p_53 [label=&quot;&quot;];
p_53 [label=&quot;Unroll ([List.for_all ((\&lt;\&gt;) None)\l         (List.tl\l          (List.tl (List.tl (….grid.a :: (….grid.b :: (… :: …))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_53 -&gt; p_52 [label=&quot;&quot;];
p_52 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               ((if move = A then … else …).a :: (….b :: (… :: …)))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_52 -&gt; p_51 [label=&quot;&quot;];
p_51 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                ((if move = A then … else …).a :: (….b :: (… :: …))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_51 -&gt; p_50 [label=&quot;&quot;];
p_50 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl\l                 ((if move = A then … else …).a ::\l                  (….b :: (… :: …)))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_50 -&gt; p_49 [label=&quot;&quot;];
p_49 [label=&quot;Unroll ([List.fold_right\l         (fun el _x\l          -\&gt; let (x : int) = _x.0 and (o : int) = _x.1 in\l             if el = None then (x, o)\l             else\l             if Is_a(Some, el) &amp;&amp; Option.get el = X then (x + 1, o)\l             else (x, o + 1))\l         (0, 0)\l         (List.tl\l          (List.tl\l           (List.tl\l            (List.tl\l             (List.tl\l              (List.tl\l               (List.tl\l                (List.tl\l                 (List.tl\l                  ((if move = A then … else …).a ::\l                   (….b :: (… :: …))))))))))))],\l        [[]])&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
p_49 -&gt; p_48 [label=&quot;&quot;];
p_48 [label=&quot;Sat (Some  let (game : game_state) =\l   \{grid =\l     \{a = (Some X); b = (Some O); c = None; d = (Some X); e = (Some O);\l      f = (Some O); g = (Some O); h = (Some X); i = None\};\l    last_player = (Some O)\}\l let (player : player) = X\l let (move : move) = D\l)&quot;,shape=box,style=filled,fontname=&quot;courier&quot;,fontsize=14];
}
</textarea><button class="btn btn-primary">Load graph</button><div class="imandra-graphviz-loading display-none">Loading..</div><div class="imandra-graphviz-target"></div><script>
require(['nbextensions/nbimandra/graphviz'], function (graphviz) {
  var target = '#graphviz-6a02d2b2-dad1-459f-8c8e-71d7a50d01f8';
  graphviz.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-ece8b9be-0cd9-421f-a270-10f8bf8b77a3';
  alternatives.hydrate(target);
});
</script></div></div></div><script>
require(['nbextensions/nbimandra/fold'], function (fold) {
  var target = '#fold-9609875f-7735-40ce-b502-fc65f56924d3';
  fold.hydrate(target);
});
</script></div></div></div></div><script>
require(['nbextensions/nbimandra/alternatives'], function (alternatives) {
  var target = '#alt-82d86e56-e3ca-4e56-bb5b-6846d73e84d6';
  alternatives.hydrate(target);
});
</script></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-50" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>CX.game;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[27]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state = &lt;document&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div class="imandra-table" id="table-2f0aec91-8f3c-4759-b6bd-2634dc36ec01"><table><tr><td><div class="imandra-table" id="table-a9be7971-1100-4ab2-8927-c7c6a77e1a81"><table><tr><td>❌</td><td>⭕</td><td>·</td></tr><tr><td>❌</td><td>⭕</td><td>⭕</td></tr><tr><td>⭕</td><td>❌</td><td>·</td></tr></table></div></td><td>Last:</td><td>⭕</td></tr></table></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Uh oh! What's gone wrong?</p>
<p>In this case, the problem is clear - player <code>O</code> is moving in square <code>B</code>, but there's already a move there. If you try out <a href="https://docs.imandra.ai/reasonml-tic-tac-toe/index-initial.html">the initial version of the game</a> based on the code so far, you'll see the bug if you try and make a move in a square that's already filled.</p>
<p>Imandra has spotted the issue for us from a straightforward statement about the logic of the game!</p>
<p>The culprit is the <code>is_valid_move</code> function - we don't check that the square is empty. Let's add <code>&amp;&amp; value(game, move) == None</code> to our check:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-52" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>let is_valid_move = (game, player, move) =&gt;
  ! (is_winning(game, X) || is_winning(game, O) || is_tie(game))
  &amp;&amp; is_valid_game(game)
  &amp;&amp; (
    game.last_player == None
    &amp;&amp; player == initial_player
    || game.last_player == Some(other_player(player))
  )
  &amp;&amp; value(game, move) == None
;
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[28]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>val is_valid_move : game_state -&gt; player -&gt; move -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... and verify once more (using <code>[@blast]</code> to speed it up):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="try-this-container">
  <a href="https://try.imandra.ai/launch/?next=/h/user-redirect/notebooks/Tic%20Tac%20Toe%20with%20ReasonML.ipynb%23try-cell-54" target="_blank" rel="nofollow">
    <div class="try-this">Try this!</div>
  </a>
</div>
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-reasonml"><pre><span></span>[@blast]
verify((game, player, move) =&gt;
  (is_valid_game(game) &amp;&amp; is_valid_move(game, player, move))
  ==&gt; is_valid_game(play_move(game, player, move))
);
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[29]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>- : game_state -&gt; player -&gt; move -&gt; bool = &lt;fun&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><pre>proof from &quot;blast&quot; (after 2.61s)!</pre></div>

</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div><div style="font-size: 1.2em; padding: 0.5em; border-top: 1px solid green; border-bottom: 1px solid green"><i class="fa fa-check-circle" style="margin-right: 0.5em; color: green"></i><span>Proved</span></div><div><div></div></div></div>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Much better! You can play <a href="https://docs.imandra.ai/reasonml-tic-tac-toe/">the final version here</a>, and you'll see that the bug is fixed. Hopefully this gives you a feel for an interactive development workflow with Imandra, in particular how seeing concrete examples can be really useful to understanding what's going on.</p>
</div>
</div>
</div>
                    </div>

                    <div class="sidebar-right">
                        <div class="sidebar-right__menu">
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h1" href="#Tic-Tac-Toe-with-ReasonML">Tic Tac Toe with ReasonML</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Setting-up-the-model">Setting up the model</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Grid-document-printer">Grid document printer</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#More-definitions">More definitions</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Game-state-document-printer">Game state document printer</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Some-logic-and-our-first-instance">Some logic and our first instance</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Valid-grids">Valid grids</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Verifying">Verifying</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Valid-games">Valid games</a>
                            
                            <a class="sidebar-right__menu-item sidebar-right__menu-item--h2" href="#Valid-moves">Valid moves</a>
                            
                        </div>
                    </div></article>
            </main>
            <footer class="footer">
                <a class="copyrights"href="http://imandra.ai">&#9400; 2018 - 2019 Imandra Inc. All rights reserved.</a>
            </footer>
        </div>
    
 


    </body>
</html>
