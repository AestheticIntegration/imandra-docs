---
title: "Scheduling smaller class sizes during Covid"
description: "This notebook demonstrates how to encode and solve a constraint problem of making sure all children from the same family go to school on the same day, when days at school are restricted due to Covid."
kernel: imandra
slug: school-scheduler
key-phrases:
  - OCaml
  - proof
  - instance
---
# Stating the problem

During the Covid pandemic of 2019/2020 it became apparent that due to social distancing, children going to school in the Scotland and elsewhere would only be able to attend for a restricted number of days per week. One of the primary concerns for families was that siblings should attend on the same day. This problem is a classic scheduling problem which can become very tricky due to a combinatorial explosion. This notebook demonstrates how it is possible to encode such a problem and use imandra to write a solver to find a solution. 

# Representation of classes, families and students

For the purposes of this demonstration, we assume (without loss of generality) that there are seven years of a primary school, each with 3 classes of 30 students. We randomly populate the school with students and families in such a way as to mimic realistic data. The school is full and is comprised of families of 1,2,3 and 4 students. We encode each student as a unique identifier `S0` to `S629` and each family as an identifier `F0` to `F308`. Each student is mapped to each of 21 classes - `P1A` through to `P7C`. 

# Initial data
The initial data for this school is represented by various function on the students and families to denote the distribution of families and students to classes. We also introduce days `M,T,W,Th,F` to represent days. In this instance we solve for the problem of students going one day a week - this is also generalisable according to the specifics of the problem. At the time of writing this was realistic according to the social distancing guidelines in schools meaning a class which ordinarily would accommodate 30 children would now accommodate 6 or 7. 

This data below can easily be auto-generated from school roll information - for example by parsing `.csv` files. 
```{.imandra .input}


type class_id =
  P1A | P1B | P1C | P2A | P2B | P2C | P3A | P3B | P3C | P4A | P4B | P4C | P5A | P5B | P5C | P6A | P6B | P6C | P7A | P7B | P7C
;;

let class_day_alloc : class_id -> int =
  fun _ -> 7
;;

type day = M | T | W | Th | F
;;


type family_id = |F0|F1|F2|F3|F4|F5|F6|F7|F8|F9|F10|F11|F12|F13|F14|F15|F16|F17|F18|F19|F20|F21|F22|F23|F24|F25|F26|F27|F28|F29|F30|F31|F32|F33|F34|F35|F36|F37|F38|F39|F40|F41|F42|F43|F44|F45|F46|F47|F48|F49|F50|F51|F52|F53|F54|F55|F56|F57|F58|F59|F60|F61|F62|F63|F64|F65|F66|F67|F68|F69|F70|F71|F72|F73|F74|F75|F76|F77|F78|F79|F80|F81|F82|F83|F84|F85|F86|F87|F88|F89|F90|F91|F92|F93|F94|F95|F96|F97|F98|F99|F100|F101|F102|F103|F104|F105|F106|F107|F108|F109|F110|F111|F112|F113|F114|F115|F116|F117|F118|F119|F120|F121|F122|F123|F124|F125|F126|F127|F128|F129|F130|F131|F132|F133|F134|F135|F136|F137|F138|F139|F140|F141|F142|F143|F144|F145|F146|F147|F148|F149|F150|F151|F152|F153|F154|F155|F156|F157|F158|F159|F160|F161|F162|F163|F164|F165|F166|F167|F168|F169|F170|F171|F172|F173|F174|F175|F176|F177|F178|F179|F180|F181|F182|F183|F184|F185|F186|F187|F188|F189|F190|F191|F192|F193|F194|F195|F196|F197|F198|F199|F200|F201|F202|F203|F204|F205|F206|F207|F208|F209|F210|F211|F212|F213|F214|F215|F216|F217|F218|F219|F220|F221|F222|F223|F224|F225|F226|F227|F228|F229|F230|F231|F232|F233|F234|F235|F236|F237|F238|F239|F240|F241|F242|F243|F244|F245|F246|F247|F248|F249|F250|F251|F252|F253|F254|F255|F256|F257|F258|F259|F260|F261|F262|F263|F264|F265|F266|F267|F268|F269|F270|F271|F272|F273|F274|F275|F276|F277|F278|F279|F280|F281|F282|F283|F284|F285|F286|F287|F288|F289|F290|F291|F292|F293|F294|F295|F296|F297|F298|F299|F300|F301|F302|F303|F304|F305|F306|F307|F308


let families = [F0;F1;F2;F3;F4;F5;F6;F7;F8;F9;F10;F11;F12;F13;F14;F15;F16;F17;F18;F19;F20;F21;F22;F23;F24;F25;F26;F27;F28;F29;F30;F31;F32;F33;F34;F35;F36;F37;F38;F39;F40;F41;F42;F43;F44;F45;F46;F47;F48;F49;F50;F51;F52;F53;F54;F55;F56;F57;F58;F59;F60;F61;F62;F63;F64;F65;F66;F67;F68;F69;F70;F71;F72;F73;F74;F75;F76;F77;F78;F79;F80;F81;F82;F83;F84;F85;F86;F87;F88;F89;F90;F91;F92;F93;F94;F95;F96;F97;F98;F99;F100;F101;F102;F103;F104;F105;F106;F107;F108;F109;F110;F111;F112;F113;F114;F115;F116;F117;F118;F119;F120;F121;F122;F123;F124;F125;F126;F127;F128;F129;F130;F131;F132;F133;F134;F135;F136;F137;F138;F139;F140;F141;F142;F143;F144;F145;F146;F147;F148;F149;F150;F151;F152;F153;F154;F155;F156;F157;F158;F159;F160;F161;F162;F163;F164;F165;F166;F167;F168;F169;F170;F171;F172;F173;F174;F175;F176;F177;F178;F179;F180;F181;F182;F183;F184;F185;F186;F187;F188;F189;F190;F191;F192;F193;F194;F195;F196;F197;F198;F199;F200;F201;F202;F203;F204;F205;F206;F207;F208;F209;F210;F211;F212;F213;F214;F215;F216;F217;F218;F219;F220;F221;F222;F223;F224;F225;F226;F227;F228;F229;F230;F231;F232;F233;F234;F235;F236;F237;F238;F239;F240;F241;F242;F243;F244;F245;F246;F247;F248;F249;F250;F251;F252;F253;F254;F255;F256;F257;F258;F259;F260;F261;F262;F263;F264;F265;F266;F267;F268;F269;F270;F271;F272;F273;F274;F275;F276;F277;F278;F279;F280;F281;F282;F283;F284;F285;F286;F287;F288;F289;F290;F291;F292;F293;F294;F295;F296;F297;F298;F299;F300;F301;F302;F303;F304;F305;F306;F307;F308];;


type student_id =
	|S629	|S628	|S627	|S626	|S625	|S624	|S623	|S622	|S621	|S620	|S619	|S618	|S617	|S616	|S615	|S614	|S613	|S612	|S611	|S610	|S609	|S608	|S607	|S606	|S605	|S604	|S603	|S602	|S601	|S600	|S599	|S598	|S597	|S596	|S595	|S594	|S593	|S592	|S591	|S590	|S589	|S588	|S587	|S586	|S585	|S584	|S583	|S582	|S581	|S580	|S579	|S578	|S577	|S576	|S575	|S574	|S573	|S572	|S571	|S570	|S569	|S568	|S567	|S566	|S565	|S564	|S563	|S562	|S561	|S560	|S559	|S558	|S557	|S556	|S555	|S554	|S553	|S552	|S551	|S550	|S549	|S548	|S547	|S546	|S545	|S544	|S543	|S542	|S541	|S540	|S539	|S538	|S537	|S536	|S535	|S534	|S533	|S532	|S531	|S530	|S529	|S528	|S527	|S526	|S525	|S524	|S523	|S522	|S521	|S520	|S519	|S518	|S517	|S516	|S515	|S514	|S513	|S512	|S511	|S510	|S509	|S508	|S507	|S506	|S505	|S504	|S503	|S502	|S501	|S500	|S499	|S498	|S497	|S496	|S495	|S494	|S493	|S492	|S491	|S490	|S489	|S488	|S487	|S486	|S485	|S484	|S483	|S482	|S481	|S480	|S479	|S478	|S477	|S476	|S475	|S474	|S473	|S472	|S471	|S470	|S469	|S468	|S467	|S466	|S465	|S464	|S463	|S462	|S461	|S460	|S459	|S458	|S457	|S456	|S455	|S454	|S453	|S452	|S451	|S450	|S449	|S448	|S447	|S446	|S445	|S444	|S443	|S442	|S441	|S440	|S439	|S438	|S437	|S436	|S435	|S434	|S433	|S432	|S431	|S430	|S429	|S428	|S427	|S426	|S425	|S424	|S423	|S422	|S421	|S420	|S419	|S418	|S417	|S416	|S415	|S414	|S413	|S412	|S411	|S410	|S409	|S408	|S407	|S406	|S405	|S404	|S403	|S402	|S401	|S400	|S399	|S398	|S397	|S396	|S395	|S394	|S393	|S392	|S391	|S390	|S389	|S388	|S387	|S386	|S385	|S384	|S383	|S382	|S381	|S380	|S379	|S378	|S377	|S376	|S375	|S374	|S373	|S372	|S371	|S370	|S369	|S368	|S367	|S366	|S365	|S364	|S363	|S362	|S361	|S360	|S359	|S358	|S357	|S356	|S355	|S354	|S353	|S352	|S351	|S350	|S349	|S348	|S347	|S346	|S345	|S344	|S343	|S342	|S341	|S340	|S339	|S338	|S337	|S336	|S335	|S334	|S333	|S332	|S331	|S330	|S329	|S328	|S327	|S326	|S325	|S324	|S323	|S322	|S321	|S320	|S319	|S318	|S317	|S316	|S315	|S314	|S313	|S312	|S311	|S310	|S309	|S308	|S307	|S306	|S305	|S304	|S303	|S302	|S301	|S300	|S299	|S298	|S297	|S296	|S295	|S294	|S293	|S292	|S291	|S290	|S289	|S288	|S287	|S286	|S285	|S284	|S283	|S282	|S281	|S280	|S279	|S278	|S277	|S276	|S275	|S274	|S273	|S272	|S271	|S270	|S269	|S268	|S267	|S266	|S265	|S264	|S263	|S262	|S261	|S260	|S259	|S258	|S257	|S256	|S255	|S254	|S253	|S252	|S251	|S250	|S249	|S248	|S247	|S246	|S245	|S244	|S243	|S242	|S241	|S240	|S239	|S238	|S237	|S236	|S235	|S234	|S233	|S232	|S231	|S230	|S229	|S228	|S227	|S226	|S225	|S224	|S223	|S222	|S221	|S220	|S219	|S218	|S217	|S216	|S215	|S214	|S213	|S212	|S211	|S210	|S209	|S208	|S207	|S206	|S205	|S204	|S203	|S202	|S201	|S200	|S199	|S198	|S197	|S196	|S195	|S194	|S193	|S192	|S191	|S190	|S189	|S188	|S187	|S186	|S185	|S184	|S183	|S182	|S181	|S180	|S179	|S178	|S177	|S176	|S175	|S174	|S173	|S172	|S171	|S170	|S169	|S168	|S167	|S166	|S165	|S164	|S163	|S162	|S161	|S160	|S159	|S158	|S157	|S156	|S155	|S154	|S153	|S152	|S151	|S150	|S149	|S148	|S147	|S146	|S145	|S144	|S143	|S142	|S141	|S140	|S139	|S138	|S137	|S136	|S135	|S134	|S133	|S132	|S131	|S130	|S129	|S128	|S127	|S126	|S125	|S124	|S123	|S122	|S121	|S120	|S119	|S118	|S117	|S116	|S115	|S114	|S113	|S112	|S111	|S110	|S109	|S108	|S107	|S106	|S105	|S104	|S103	|S102	|S101	|S100	|S99	|S98	|S97	|S96	|S95	|S94	|S93	|S92	|S91	|S90	|S89	|S88	|S87	|S86	|S85	|S84	|S83	|S82	|S81	|S80	|S79	|S78	|S77	|S76	|S75	|S74	|S73	|S72	|S71	|S70	|S69	|S68	|S67	|S66	|S65	|S64	|S63	|S62	|S61	|S60	|S59	|S58	|S57	|S56	|S55	|S54	|S53	|S52	|S51	|S50	|S49	|S48	|S47	|S46	|S45	|S44	|S43	|S42	|S41	|S40	|S39	|S38	|S37	|S36	|S35	|S34	|S33	|S32	|S31	|S30	|S29	|S28	|S27	|S26	|S25	|S24	|S23	|S22	|S21	|S20	|S19	|S18	|S17	|S16	|S15	|S14	|S13	|S12	|S11	|S10	|S9	|S8	|S7	|S6	|S5	|S4	|S3	|S2	|S1	| S0
;;

let student_alloc : student_id -> class_id = function
| S629->P2A
| S628->P2A
| S627->P2A
| S626->P2A
| S625->P2A
| S624->P2A
| S623->P2A
| S622->P2A
| S621->P5A
| S620->P4A
| S619->P2A
| S618->P4A
| S617->P2A
| S616->P5C
| S615->P5A
| S614->P2A
| S613->P7C
| S612->P5A
| S611->P1A
| S610->P5C
| S609->P6B
| S608->P5B
| S607->P4A
| S606->P5B
| S605->P5C
| S604->P5A
| S603->P5C
| S602->P1B
| S601->P6B
| S600->P1A
| S599->P1A
| S598->P6B
| S597->P5C
| S596->P3B
| S595->P3B
| S594->P7C
| S593->P3B
| S592->P5C
| S591->P7C
| S590->P2A
| S589->P5C
| S588->P3B
| S587->P5A
| S586->P7A
| S585->P6B
| S584->P6B
| S583->P3B
| S582->P1B
| S581->P3B
| S580->P5B
| S579->P1B
| S578->P5C
| S577->P1B
| S576->P1A
| S575->P2A
| S574->P5C
| S573->P3B
| S572->P5C
| S571->P4A
| S570->P5A
| S569->P5B
| S568->P2C
| S567->P4A
| S566->P6B
| S565->P5A
| S564->P7A
| S563->P2C
| S562->P2C
| S561->P7C
| S560->P6B
| S559->P7A
| S558->P3B
| S557->P7A
| S556->P5C
| S555->P3B
| S554->P6B
| S553->P5A
| S552->P6C
| S551->P4A
| S550->P4A
| S549->P1B
| S548->P7A
| S547->P5B
| S546->P4B
| S545->P6C
| S544->P5B
| S543->P5C
| S542->P5C
| S541->P1C
| S540->P6B
| S539->P5B
| S538->P4A
| S537->P1B
| S536->P7C
| S535->P1B
| S534->P5C
| S533->P7A
| S532->P6C
| S531->P2C
| S530->P5C
| S529->P2A
| S528->P7A
| S527->P6B
| S526->P4B
| S525->P1C
| S524->P5A
| S523->P4B
| S522->P2B
| S521->P2A
| S520->P5A
| S519->P4A
| S518->P5A
| S517->P2C
| S516->P3A
| S515->P4B
| S514->P1C
| S513->P7C
| S512->P1B
| S511->P1A
| S510->P4A
| S509->P6C
| S508->P6B
| S507->P5B
| S506->P6C
| S505->P7C
| S504->P6C
| S503->P1A
| S502->P2A
| S501->P7A
| S500->P2C
| S499->P3B
| S498->P2A
| S497->P1A
| S496->P6B
| S495->P6C
| S494->P6B
| S493->P6C
| S492->P2B
| S491->P4C
| S490->P4C
| S489->P3B
| S488->P6C
| S487->P5B
| S486->P6A
| S485->P3B
| S484->P6A
| S483->P6B
| S482->P4B
| S481->P6B
| S480->P1A
| S479->P5A
| S478->P1C
| S477->P4A
| S476->P1C
| S475->P4A
| S474->P5A
| S473->P4B
| S472->P1C
| S471->P7C
| S470->P7C
| S469->P3A
| S468->P4C
| S467->P2B
| S466->P2B
| S465->P6B
| S464->P2C
| S463->P3B
| S462->P3B
| S461->P7A
| S460->P7C
| S459->P5B
| S458->P7A
| S457->P4A
| S456->P1A
| S455->P3A
| S454->P6C
| S453->P3A
| S452->P1C
| S451->P1C
| S450->P3A
| S449->P4C
| S448->P5B
| S447->P4A
| S446->P7C
| S445->P5B
| S444->P1A
| S443->P4A
| S442->P7A
| S441->P1A
| S440->P4C
| S439->P5B
| S438->P4C
| S437->P2C
| S436->P2C
| S435->P6A
| S434->P3A
| S433->P4C
| S432->P2B
| S431->P5A
| S430->P2A
| S429->P6A
| S428->P7A
| S427->P1B
| S426->P1C
| S425->P6A
| S424->P6A
| S423->P7B
| S422->P6B
| S421->P2B
| S420->P3B
| S419->P1C
| S418->P5B
| S417->P1B
| S416->P6B
| S415->P4C
| S414->P6B
| S413->P4C
| S412->P7B
| S411->P1A
| S410->P3C
| S409->P2C
| S408->P4A
| S407->P1A
| S406->P3A
| S405->P7B
| S404->P3B
| S403->P4A
| S402->P7C
| S401->P5B
| S400->P3C
| S399->P1B
| S398->P2B
| S397->P5B
| S396->P6C
| S395->P2A
| S394->P3C
| S393->P7C
| S392->P3A
| S391->P6A
| S390->P5C
| S389->P4C
| S388->P3B
| S387->P2B
| S386->P2A
| S385->P4B
| S384->P6C
| S383->P5C
| S382->P5B
| S381->P6C
| S380->P3B
| S379->P5C
| S378->P2A
| S377->P6A
| S376->P6A
| S375->P4B
| S374->P3A
| S373->P6B
| S372->P4C
| S371->P4B
| S370->P6A
| S369->P6C
| S368->P2C
| S367->P6B
| S366->P7A
| S365->P1C
| S364->P3A
| S363->P5B
| S362->P6A
| S361->P4C
| S360->P1C
| S359->P6C
| S358->P5C
| S357->P1A
| S356->P6A
| S355->P7B
| S354->P6B
| S353->P1B
| S352->P6C
| S351->P2B
| S350->P7B
| S349->P3A
| S348->P3B
| S347->P5C
| S346->P3A
| S345->P7C
| S344->P7B
| S343->P7B
| S342->P4C
| S341->P2C
| S340->P1B
| S339->P6A
| S338->P7B
| S337->P1A
| S336->P4C
| S335->P3B
| S334->P5B
| S333->P1B
| S332->P6A
| S331->P4A
| S330->P3C
| S329->P4C
| S328->P7C
| S327->P7C
| S326->P4C
| S325->P2A
| S324->P3C
| S323->P1C
| S322->P7A
| S321->P3B
| S320->P5B
| S319->P4A
| S318->P4C
| S317->P1B
| S316->P3C
| S315->P4B
| S314->P2C
| S313->P3C
| S312->P4B
| S311->P7C
| S310->P3A
| S309->P1C
| S308->P4B
| S307->P4C
| S306->P6A
| S305->P3C
| S304->P2A
| S303->P1B
| S302->P6C
| S301->P3B
| S300->P3A
| S299->P2C
| S298->P4B
| S297->P1B
| S296->P6C
| S295->P2A
| S294->P2B
| S293->P2B
| S292->P7A
| S291->P2B
| S290->P7C
| S289->P4C
| S288->P3B
| S287->P4B
| S286->P7A
| S285->P7C
| S284->P5A
| S283->P4B
| S282->P4C
| S281->P4A
| S280->P6A
| S279->P7B
| S278->P1B
| S277->P6B
| S276->P1B
| S275->P1B
| S274->P7C
| S273->P5A
| S272->P1B
| S271->P6C
| S270->P7B
| S269->P5A
| S268->P4C
| S267->P5B
| S266->P2C
| S265->P5B
| S264->P6A
| S263->P7B
| S262->P1B
| S261->P6A
| S260->P4B
| S259->P3A
| S258->P3B
| S257->P4C
| S256->P4B
| S255->P6A
| S254->P5A
| S253->P3C
| S252->P1C
| S251->P2B
| S250->P2C
| S249->P6B
| S248->P2A
| S247->P6B
| S246->P7C
| S245->P2B
| S244->P7B
| S243->P3A
| S242->P1A
| S241->P1A
| S240->P4C
| S239->P6C
| S238->P3A
| S237->P1A
| S236->P6A
| S235->P7B
| S234->P4B
| S233->P6B
| S232->P5C
| S231->P2B
| S230->P1A
| S229->P4B
| S228->P7B
| S227->P3A
| S226->P1A
| S225->P1A
| S224->P2C
| S223->P5A
| S222->P5A
| S221->P3C
| S220->P7B
| S219->P7A
| S218->P7B
| S217->P7C
| S216->P3C
| S215->P4B
| S214->P3A
| S213->P7C
| S212->P4B
| S211->P1C
| S210->P3A
| S209->P4B
| S208->P6B
| S207->P6C
| S206->P1C
| S205->P4B
| S204->P3C
| S203->P2C
| S202->P4C
| S201->P5C
| S200->P3C
| S199->P4B
| S198->P1B
| S197->P1C
| S196->P4A
| S195->P3B
| S194->P5A
| S193->P4B
| S192->P4C
| S191->P2B
| S190->P7A
| S189->P7A
| S188->P1C
| S187->P7A
| S186->P7B
| S185->P7A
| S184->P2A
| S183->P7C
| S182->P6C
| S181->P3C
| S180->P3A
| S179->P7A
| S178->P6C
| S177->P5A
| S176->P7A
| S175->P1B
| S174->P1C
| S173->P2A
| S172->P7C
| S171->P2B
| S170->P2C
| S169->P1B
| S168->P3C
| S167->P2C
| S166->P4B
| S165->P5B
| S164->P2B
| S163->P4C
| S162->P1A
| S161->P6A
| S160->P5A
| S159->P6B
| S158->P4C
| S157->P2C
| S156->P7A
| S155->P2B
| S154->P6A
| S153->P3C
| S152->P1C
| S151->P2C
| S150->P6A
| S149->P6C
| S148->P5C
| S147->P7B
| S146->P4A
| S145->P1B
| S144->P1C
| S143->P7B
| S142->P4B
| S141->P7A
| S140->P4A
| S139->P5A
| S138->P1C
| S137->P7B
| S136->P4A
| S135->P4A
| S134->P1C
| S133->P7A
| S132->P6A
| S131->P7B
| S130->P5C
| S129->P7A
| S128->P2B
| S127->P3B
| S126->P2B
| S125->P1C
| S124->P3B
| S123->P3C
| S122->P6C
| S121->P1B
| S120->P7B
| S119->P4A
| S118->P5A
| S117->P1C
| S116->P1B
| S115->P6A
| S114->P1A
| S113->P2C
| S112->P3C
| S111->P7B
| S110->P7C
| S109->P1C
| S108->P5A
| S107->P2B
| S106->P3A
| S105->P6A
| S104->P3C
| S103->P7A
| S102->P7C
| S101->P7B
| S100->P6A
| S99->P6C
| S98->P4A
| S97->P2C
| S96->P1A
| S95->P2A
| S94->P5A
| S93->P1A
| S92->P1A
| S91->P7C
| S90->P2B
| S89->P5B
| S88->P3B
| S87->P4C
| S86->P4B
| S85->P3C
| S84->P1B
| S83->P3A
| S82->P2A
| S81->P4C
| S80->P5B
| S79->P2C
| S78->P5B
| S77->P3A
| S76->P5C
| S75->P1A
| S74->P3C
| S73->P6B
| S72->P2C
| S71->P7B
| S70->P5C
| S69->P2B
| S68->P5B
| S67->P7A
| S66->P5A
| S65->P5C
| S64->P1A
| S63->P3B
| S62->P5B
| S61->P3C
| S60->P3A
| S59->P6A
| S58->P6C
| S57->P1A
| S56->P4B
| S55->P4A
| S54->P3A
| S53->P3C
| S52->P4A
| S51->P4A
| S50->P6C
| S49->P4C
| S48->P2A
| S47->P4B
| S46->P1A
| S45->P7B
| S44->P2C
| S43->P2B
| S42->P7C
| S41->P3C
| S40->P5C
| S39->P2B
| S38->P7B
| S37->P5C
| S36->P1C
| S35->P2B
| S34->P3C
| S33->P5B
| S32->P6A
| S31->P6C
| S30->P2B
| S29->P1C
| S28->P7A
| S27->P6C
| S26->P7B
| S25->P1B
| S24->P6B
| S23->P5B
| S22->P3C
| S21->P3A
| S20->P5A
| S19->P2C
| S18->P5C
| S17->P2B
| S16->P7C
| S15->P3C
| S14->P3C
| S13->P7B
| S12->P1C
| S11->P3A
| S10->P3A
| S9->P5A
| S8->P7B
| S7->P3C
| S6->P3B
| S5->P6A
| S4->P2B
| S3->P3A
| S2->P2C
| S1->P3C
| S0->P2C
;;



let family_of_student : student_id -> family_id = function
| S4-> F0| S39-> F0
| S66-> F1| S52-> F1
| S135-> F2
| S5-> F3| S17-> F3| S30-> F3| S23-> F3
| S1-> F4
| S20-> F5
| S7-> F6
| S116-> F7| S169-> F7
| S100-> F8| S159-> F8| S46-> F8
| S63-> F9| S32-> F9
| S18-> F10| S9-> F10| S98-> F10
| S64-> F11| S14-> F11
| S93-> F12| S81-> F12
| S2-> F13
| S34-> F14
| S33-> F15| S70-> F15
| S110-> F16| S59-> F16
| S62-> F17| S233-> F17| S91-> F17| S122-> F17
| S105-> F18| S76-> F18
| S158-> F19
| S87-> F20
| S79-> F21| S40-> F21| S145-> F21| S247-> F21
| S173-> F22
| S65-> F23
| S109-> F24
| S51-> F25| S50-> F25
| S36-> F26
| S68-> F27| S127-> F27
| S193-> F28| S27-> F28
| S12-> F29| S108-> F29
| S15-> F30| S133-> F30
| S166-> F31
| S72-> F32
| S28-> F33| S29-> F33
| S25-> F34
| S67-> F35| S248-> F35| S118-> F35
| S80-> F36| S0-> F36
| S119-> F37| S48-> F37
| S35-> F38
| S55-> F39| S129-> F39| S19-> F39| S208-> F39
| S75-> F40
| S3-> F41
| S44-> F42| S172-> F42
| S103-> F43
| S102-> F44| S195-> F44| S8-> F44| S13-> F44
| S88-> F45
| S99-> F46| S121-> F46
| S26-> F47
| S21-> F48| S141-> F48| S22-> F48
| S10-> F49
| S71-> F50| S56-> F50
| S82-> F51
| S16-> F52| S54-> F52
| S73-> F53| S95-> F53
| S38-> F54| S24-> F54
| S78-> F55
| S42-> F56| S84-> F56
| S115-> F57| S86-> F57
| S49-> F58
| S37-> F59| S163-> F59| S57-> F59
| S45-> F60
| S142-> F61
| S6-> F62
| S43-> F63| S124-> F63| S192-> F63
| S94-> F64| S47-> F64
| S58-> F65
| S11-> F66
| S92-> F67
| S60-> F68
| S184-> F69| S125-> F69
| S31-> F70
| S117-> F71
| S257-> F72
| S236-> F73| S170-> F73
| S154-> F74| S285-> F74
| S268-> F75
| S139-> F76
| S61-> F77| S177-> F77| S222-> F77
| S217-> F78| S126-> F78
| S232-> F79| S53-> F79
| S274-> F80| S198-> F80| S128-> F80
| S97-> F81| S69-> F81
| S347-> F82| S183-> F82
| S143-> F83| S262-> F83| S378-> F83
| S104-> F84| S194-> F84
| S157-> F85
| S160-> F86| S149-> F86| S414-> F86| S74-> F86
| S275-> F87| S41-> F87| S373-> F87| S96-> F87
| S178-> F88| S230-> F88
| S320-> F89
| S106-> F90| S334-> F90
| S239-> F91| S120-> F91
| S304-> F92| S288-> F92
| S180-> F93| S202-> F93
| S246-> F94| S155-> F94
| S213-> F95
| S205-> F96
| S138-> F97| S295-> F97
| S386-> F98| S150-> F98
| S187-> F99| S162-> F99
| S77-> F100| S282-> F100
| S196-> F101| S289-> F101| S85-> F101
| S90-> F102| S258-> F102
| S277-> F103| S348-> F103| S114-> F103
| S175-> F104
| S185-> F105| S229-> F105
| S188-> F106| S395-> F106
| S209-> F107
| S156-> F108| S335-> F108| S226-> F108
| S272-> F109| S354-> F109
| S255-> F110
| S83-> F111| S201-> F111| S151-> F111
| S107-> F112| S189-> F112| S240-> F112
| S130-> F113| S182-> F113| S199-> F113| S367-> F113
| S212-> F114| S179-> F114| S148-> F114
| S113-> F115| S144-> F115| S137-> F115
| S146-> F116| S249-> F116| S321-> F116| S101-> F116
| S134-> F117| S267-> F117
| S225-> F118
| S176-> F119
| S131-> F120
| S210-> F121| S132-> F121
| S89-> F122
| S265-> F123
| S214-> F124| S207-> F124
| S301-> F125| S276-> F125
| S281-> F126| S358-> F126
| S165-> F127| S152-> F127| S215-> F127| S174-> F127
| S161-> F128| S319-> F128| S223-> F128
| S167-> F129
| S111-> F130| S140-> F130
| S136-> F131| S325-> F131
| S271-> F132
| S317-> F133
| S168-> F134
| S309-> F135
| S333-> F136
| S388-> F137| S224-> F137| S298-> F137| S303-> F137
| S420-> F138| S181-> F138| S322-> F138
| S206-> F139| S250-> F139| S261-> F139| S418-> F139
| S264-> F140| S290-> F140| S311-> F140
| S297-> F141| S306-> F141
| S153-> F142| S340-> F142
| S404-> F143| S256-> F143| S287-> F143
| S112-> F144| S397-> F144
| S280-> F145| S474-> F145| S283-> F145
| S430-> F146
| S211-> F147
| S292-> F148| S310-> F148| S529-> F148
| S314-> F149
| S407-> F150| S259-> F150| S393-> F150
| S431-> F151| S242-> F151| S286-> F151
| S342-> F152
| S245-> F153| S439-> F153
| S254-> F154
| S231-> F155| S323-> F155| S328-> F155| S326-> F155
| S191-> F156| S366-> F156| S352-> F156| S327-> F156
| S251-> F157| S200-> F157| S502-> F157| S380-> F157
| S197-> F158| S227-> F158
| S345-> F159| S331-> F159
| S498-> F160
| S299-> F161
| S443-> F162| S339-> F162| S379-> F162
| S234-> F163| S260-> F163
| S381-> F164| S164-> F164| S219-> F164
| S220-> F165| S534-> F165| S463-> F165
| S284-> F166| S390-> F166
| S457-> F167| S416-> F167| S530-> F167
| S462-> F168| S190-> F168
| S237-> F169| S465-> F169| S238-> F169| S408-> F169
| S171-> F170| S542-> F170
| S123-> F171| S332-> F171| S363-> F171
| S336-> F172| S521-> F172| S422-> F172
| S403-> F173
| S203-> F174| S269-> F174
| S278-> F175| S401-> F175| S235-> F175
| S369-> F176
| S300-> F177| S329-> F177
| S307-> F178| S243-> F178
| S252-> F179| S318-> F179
| S273-> F180
| S382-> F181| S186-> F181
| S147-> F182| S447-> F182| S483-> F182
| S218-> F183| S359-> F183| S266-> F183
| S383-> F184
| S228-> F185
| S337-> F186
| S302-> F187| S575-> F187| S481-> F187
| S241-> F188
| S494-> F189| S357-> F189| S296-> F189
| S519-> F190| S263-> F190| S343-> F190
| S361-> F191
| S364-> F192| S244-> F192
| S456-> F193| S411-> F193
| S368-> F194
| S480-> F195| S279-> F195| S572-> F195| S540-> F195
| S497-> F196| S437-> F196
| S574-> F197| S589-> F197| S464-> F197
| S433-> F198| S623-> F198| S501-> F198
| S371-> F199| S385-> F199
| S614-> F200
| S312-> F201| S305-> F201
| S520-> F202| S313-> F202
| S553-> F203
| S294-> F204| S291-> F204
| S406-> F205| S479-> F205
| S554-> F206| S398-> F206| S372-> F206
| S341-> F207| S590-> F207| S538-> F207
| S578-> F208
| S315-> F209| S446-> F209
| S444-> F210| S477-> F210
| S402-> F211| S365-> F211| S460-> F211| S507-> F211
| S308-> F212| S461-> F212
| S436-> F213| S253-> F213
| S487-> F214
| S505-> F215| S458-> F215| S617-> F215| S459-> F215
| S470-> F216| S558-> F216| S556-> F216
| S448-> F217| S499-> F217
| S374-> F218| S413-> F218| S454-> F218| S389-> F218
| S376-> F219
| S518-> F220| S270-> F220
| S427-> F221| S221-> F221| S471-> F221
| S391-> F222| S415-> F222| S384-> F222
| S493-> F223| S441-> F223
| S565-> F224| S293-> F224
| S216-> F225| S560-> F225| S442-> F225
| S417-> F226
| S428-> F227| S351-> F227
| S535-> F228
| S375-> F229| S622-> F229| S370-> F229
| S387-> F230| S338-> F230
| S346-> F231| S452-> F231
| S353-> F232
| S488-> F233
| S356-> F234| S426-> F234
| S360-> F235| S524-> F235| S475-> F235
| S508-> F236| S399-> F236
| S204-> F237| S619-> F237
| S539-> F238| S489-> F238| S409-> F238| S512-> F238
| S451-> F239| S543-> F239| S510-> F239
| S555-> F240| S495-> F240| S527-> F240
| S392-> F241| S573-> F241
| S485-> F242| S396-> F242| S349-> F242
| S528-> F243
| S550-> F244
| S496-> F245| S419-> F245
| S362-> F246| S377-> F246
| S445-> F247
| S604-> F248| S621-> F248
| S549-> F249| S525-> F249
| S533-> F250| S476-> F250
| S602-> F251| S591-> F251| S478-> F251
| S594-> F252| S587-> F252| S316-> F252
| S564-> F253| S506-> F253
| S568-> F254
| S472-> F255
| S618-> F256| S544-> F256
| S548-> F257
| S561-> F258| S536-> F258
| S620-> F259
| S583-> F260
| S607-> F261| S625-> F261| S613-> F261| S557-> F261
| S405-> F262| S516-> F262| S593-> F262
| S611-> F263| S624-> F263
| S606-> F264| S537-> F264
| S514-> F265
| S563-> F266| S595-> F266| S571-> F266
| S344-> F267| S434-> F267
| S455-> F268
| S628-> F269| S412-> F269
| S612-> F270| S600-> F270| S473-> F270
| S355-> F271
| S503-> F272| S453-> F272| S585-> F272
| S627-> F273| S324-> F273| S504-> F273| S566-> F273
| S350-> F274| S394-> F274
| S584-> F275| S515-> F275
| S616-> F276| S597-> F276
| S562-> F277
| S438-> F278| S531-> F278
| S513-> F279
| S440-> F280
| S588-> F281| S551-> F281| S509-> F281| S541-> F281
| S491-> F282| S596-> F282| S546-> F282
| S429-> F283| S467-> F283
| S581-> F284| S425-> F284
| S400-> F285| S517-> F285
| S468-> F286| S526-> F286| S466-> F286
| S482-> F287| S330-> F287
| S570-> F288| S552-> F288
| S592-> F289| S615-> F289| S523-> F289| S490-> F289
| S586-> F290
| S424-> F291
| S421-> F292
| S629-> F293| S603-> F293| S626-> F293| S582-> F293
| S484-> F294| S601-> F294| S567-> F294
| S500-> F295
| S605-> F296| S547-> F296
| S577-> F297
| S522-> F298| S450-> F298| S532-> F298| S599-> F298
| S609-> F299| S608-> F299
| S486-> F300| S579-> F300
| S511-> F301
| S559-> F302
| S469-> F303| S580-> F303
| S410-> F304| S423-> F304| S610-> F304
| S598-> F305| S569-> F305
| S435-> F306| S545-> F306
| S492-> F307| S449-> F307
| S576-> F308| S432-> F308

;;

let families_class_list = function | F0-> [P2B; P2B]
| F1-> [P4A; P5A]
| F2-> [P4A]
| F3-> [P5B; P2B; P2B; P6A]
| F4-> [P3C]
| F5-> [P5A]
| F6-> [P3C]
| F7-> [P1B; P1B]
| F8-> [P1A; P6B; P6A]
| F9-> [P6A; P3B]
| F10-> [P4A; P5A; P5C]
| F11-> [P3C; P1A]
| F12-> [P4C; P1A]
| F13-> [P2C]
| F14-> [P3C]
| F15-> [P5C; P5B]
| F16-> [P6A; P7C]
| F17-> [P6C; P7C; P6B; P5B]
| F18-> [P5C; P6A]
| F19-> [P4C]
| F20-> [P4C]
| F21-> [P6B; P1B; P5C; P2C]
| F22-> [P2A]
| F23-> [P5C]
| F24-> [P1C]
| F25-> [P6C; P4A]
| F26-> [P1C]
| F27-> [P3B; P5B]
| F28-> [P6C; P4B]
| F29-> [P5A; P1C]
| F30-> [P7A; P3C]
| F31-> [P4B]
| F32-> [P2C]
| F33-> [P1C; P7A]
| F34-> [P1B]
| F35-> [P5A; P2A; P7A]
| F36-> [P2C; P5B]
| F37-> [P2A; P4A]
| F38-> [P2B]
| F39-> [P6B; P2C; P7A; P4A]
| F40-> [P1A]
| F41-> [P3A]
| F42-> [P7C; P2C]
| F43-> [P7A]
| F44-> [P7B; P7B; P3B; P7C]
| F45-> [P3B]
| F46-> [P1B; P6C]
| F47-> [P7B]
| F48-> [P3C; P7A; P3A]
| F49-> [P3A]
| F50-> [P4B; P7B]
| F51-> [P2A]
| F52-> [P3A; P7C]
| F53-> [P2A; P6B]
| F54-> [P6B; P7B]
| F55-> [P5B]
| F56-> [P1B; P7C]
| F57-> [P4B; P6A]
| F58-> [P4C]
| F59-> [P1A; P4C; P5C]
| F60-> [P7B]
| F61-> [P4B]
| F62-> [P3B]
| F63-> [P4C; P3B; P2B]
| F64-> [P4B; P5A]
| F65-> [P6C]
| F66-> [P3A]
| F67-> [P1A]
| F68-> [P3A]
| F69-> [P1C; P2A]
| F70-> [P6C]
| F71-> [P1C]
| F72-> [P4C]
| F73-> [P2C; P6A]
| F74-> [P7C; P6A]
| F75-> [P4C]
| F76-> [P5A]
| F77-> [P5A; P5A; P3C]
| F78-> [P2B; P7C]
| F79-> [P3C; P5C]
| F80-> [P2B; P1B; P7C]
| F81-> [P2B; P2C]
| F82-> [P7C; P5C]
| F83-> [P2A; P1B; P7B]
| F84-> [P5A; P3C]
| F85-> [P2C]
| F86-> [P3C; P6B; P6C; P5A]
| F87-> [P1A; P6B; P3C; P1B]
| F88-> [P1A; P6C]
| F89-> [P5B]
| F90-> [P5B; P3A]
| F91-> [P7B; P6C]
| F92-> [P3B; P2A]
| F93-> [P4C; P3A]
| F94-> [P2B; P7C]
| F95-> [P7C]
| F96-> [P4B]
| F97-> [P2A; P1C]
| F98-> [P6A; P2A]
| F99-> [P1A; P7A]
| F100-> [P4C; P3A]
| F101-> [P3C; P4C; P4A]
| F102-> [P3B; P2B]
| F103-> [P1A; P3B; P6B]
| F104-> [P1B]
| F105-> [P4B; P7A]
| F106-> [P2A; P1C]
| F107-> [P4B]
| F108-> [P1A; P3B; P7A]
| F109-> [P6B; P1B]
| F110-> [P6A]
| F111-> [P2C; P5C; P3A]
| F112-> [P4C; P7A; P2B]
| F113-> [P6B; P4B; P6C; P5C]
| F114-> [P5C; P7A; P4B]
| F115-> [P7B; P1C; P2C]
| F116-> [P7B; P3B; P6B; P4A]
| F117-> [P5B; P1C]
| F118-> [P1A]
| F119-> [P7A]
| F120-> [P7B]
| F121-> [P6A; P3A]
| F122-> [P5B]
| F123-> [P5B]
| F124-> [P6C; P3A]
| F125-> [P1B; P3B]
| F126-> [P5C; P4A]
| F127-> [P1C; P4B; P1C; P5B]
| F128-> [P5A; P4A; P6A]
| F129-> [P2C]
| F130-> [P4A; P7B]
| F131-> [P2A; P4A]
| F132-> [P6C]
| F133-> [P1B]
| F134-> [P3C]
| F135-> [P1C]
| F136-> [P1B]
| F137-> [P1B; P4B; P2C; P3B]
| F138-> [P7A; P3C; P3B]
| F139-> [P5B; P6A; P2C; P1C]
| F140-> [P7C; P7C; P6A]
| F141-> [P6A; P1B]
| F142-> [P1B; P3C]
| F143-> [P4B; P4B; P3B]
| F144-> [P5B; P3C]
| F145-> [P4B; P5A; P6A]
| F146-> [P2A]
| F147-> [P1C]
| F148-> [P2A; P3A; P7A]
| F149-> [P2C]
| F150-> [P7C; P3A; P1A]
| F151-> [P7A; P1A; P5A]
| F152-> [P4C]
| F153-> [P5B; P2B]
| F154-> [P5A]
| F155-> [P4C; P7C; P1C; P2B]
| F156-> [P7C; P6C; P7A; P2B]
| F157-> [P3B; P2A; P3C; P2B]
| F158-> [P3A; P1C]
| F159-> [P4A; P7C]
| F160-> [P2A]
| F161-> [P2C]
| F162-> [P5C; P6A; P4A]
| F163-> [P4B; P4B]
| F164-> [P7A; P2B; P6C]
| F165-> [P3B; P5C; P7B]
| F166-> [P5C; P5A]
| F167-> [P5C; P6B; P4A]
| F168-> [P7A; P3B]
| F169-> [P4A; P3A; P6B; P1A]
| F170-> [P5C; P2B]
| F171-> [P5B; P6A; P3C]
| F172-> [P6B; P2A; P4C]
| F173-> [P4A]
| F174-> [P5A; P2C]
| F175-> [P7B; P5B; P1B]
| F176-> [P6C]
| F177-> [P4C; P3A]
| F178-> [P3A; P4C]
| F179-> [P4C; P1C]
| F180-> [P5A]
| F181-> [P7B; P5B]
| F182-> [P6B; P4A; P7B]
| F183-> [P2C; P6C; P7B]
| F184-> [P5C]
| F185-> [P7B]
| F186-> [P1A]
| F187-> [P6B; P2A; P6C]
| F188-> [P1A]
| F189-> [P6C; P1A; P6B]
| F190-> [P7B; P7B; P4A]
| F191-> [P4C]
| F192-> [P7B; P3A]
| F193-> [P1A; P1A]
| F194-> [P2C]
| F195-> [P6B; P5C; P7B; P1A]
| F196-> [P2C; P1A]
| F197-> [P2C; P5C; P5C]
| F198-> [P7A; P2A; P4C]
| F199-> [P4B; P4B]
| F200-> [P2A]
| F201-> [P3C; P4B]
| F202-> [P3C; P5A]
| F203-> [P5A]
| F204-> [P2B; P2B]
| F205-> [P5A; P3A]
| F206-> [P4C; P2B; P6B]
| F207-> [P4A; P2A; P2C]
| F208-> [P5C]
| F209-> [P7C; P4B]
| F210-> [P4A; P1A]
| F211-> [P5B; P7C; P1C; P7C]
| F212-> [P7A; P4B]
| F213-> [P3C; P2C]
| F214-> [P5B]
| F215-> [P5B; P2A; P7A; P7C]
| F216-> [P5C; P3B; P7C]
| F217-> [P3B; P5B]
| F218-> [P4C; P6C; P4C; P3A]
| F219-> [P6A]
| F220-> [P7B; P5A]
| F221-> [P7C; P3C; P1B]
| F222-> [P6C; P4C; P6A]
| F223-> [P1A; P6C]
| F224-> [P2B; P5A]
| F225-> [P7A; P6B; P3C]
| F226-> [P1B]
| F227-> [P2B; P7A]
| F228-> [P1B]
| F229-> [P6A; P2A; P4B]
| F230-> [P7B; P2B]
| F231-> [P1C; P3A]
| F232-> [P1B]
| F233-> [P6C]
| F234-> [P1C; P6A]
| F235-> [P4A; P5A; P1C]
| F236-> [P1B; P6B]
| F237-> [P2A; P3C]
| F238-> [P1B; P2C; P3B; P5B]
| F239-> [P4A; P5C; P1C]
| F240-> [P6B; P6C; P3B]
| F241-> [P3B; P3A]
| F242-> [P3A; P6C; P3B]
| F243-> [P7A]
| F244-> [P4A]
| F245-> [P1C; P6B]
| F246-> [P6A; P6A]
| F247-> [P5B]
| F248-> [P5A; P5A]
| F249-> [P1C; P1B]
| F250-> [P1C; P7A]
| F251-> [P1C; P7C; P1B]
| F252-> [P3C; P5A; P7C]
| F253-> [P6C; P7A]
| F254-> [P2C]
| F255-> [P1C]
| F256-> [P5B; P4A]
| F257-> [P7A]
| F258-> [P7C; P7C]
| F259-> [P4A]
| F260-> [P3B]
| F261-> [P7A; P7C; P2A; P4A]
| F262-> [P3B; P3A; P7B]
| F263-> [P2A; P1A]
| F264-> [P1B; P5B]
| F265-> [P1C]
| F266-> [P4A; P3B; P2C]
| F267-> [P3A; P7B]
| F268-> [P3A]
| F269-> [P7B; P2A]
| F270-> [P4B; P1A; P5A]
| F271-> [P7B]
| F272-> [P6B; P3A; P1A]
| F273-> [P6B; P6C; P3C; P2A]
| F274-> [P3C; P7B]
| F275-> [P4B; P6B]
| F276-> [P5C; P5C]
| F277-> [P2C]
| F278-> [P2C; P4C]
| F279-> [P7C]
| F280-> [P4C]
| F281-> [P1C; P6C; P4A; P3B]
| F282-> [P4B; P3B; P4C]
| F283-> [P2B; P6A]
| F284-> [P6A; P3B]
| F285-> [P2C; P3C]
| F286-> [P2B; P4B; P4C]
| F287-> [P3C; P4B]
| F288-> [P6C; P5A]
| F289-> [P4C; P4B; P5A; P5C]
| F290-> [P7A]
| F291-> [P6A]
| F292-> [P2B]
| F293-> [P1B; P2A; P5C; P2A]
| F294-> [P4A; P6B; P6A]
| F295-> [P2C]
| F296-> [P5B; P5C]
| F297-> [P1B]
| F298-> [P1A; P6C; P3A; P2B]
| F299-> [P5B; P6B]
| F300-> [P1B; P6A]
| F301-> [P1A]
| F302-> [P7A]
| F303-> [P5B; P3A]
| F304-> [P5C; P7B; P3C]
| F305-> [P5B; P6B]
| F306-> [P6C; P6A]
| F307-> [P4C; P2B]
| F308-> [P2B; P1A]

;;

let families_student_list = function | F0-> [S39;S4]
| F1-> [S52;S66]
| F2-> [S135]
| F3-> [S23;S30;S17;S5]
| F4-> [S1]
| F5-> [S20]
| F6-> [S7]
| F7-> [S169;S116]
| F8-> [S46;S159;S100]
| F9-> [S32;S63]
| F10-> [S98;S9;S18]
| F11-> [S14;S64]
| F12-> [S81;S93]
| F13-> [S2]
| F14-> [S34]
| F15-> [S70;S33]
| F16-> [S59;S110]
| F17-> [S122;S91;S233;S62]
| F18-> [S76;S105]
| F19-> [S158]
| F20-> [S87]
| F21-> [S247;S145;S40;S79]
| F22-> [S173]
| F23-> [S65]
| F24-> [S109]
| F25-> [S50;S51]
| F26-> [S36]
| F27-> [S127;S68]
| F28-> [S27;S193]
| F29-> [S108;S12]
| F30-> [S133;S15]
| F31-> [S166]
| F32-> [S72]
| F33-> [S29;S28]
| F34-> [S25]
| F35-> [S118;S248;S67]
| F36-> [S0;S80]
| F37-> [S48;S119]
| F38-> [S35]
| F39-> [S208;S19;S129;S55]
| F40-> [S75]
| F41-> [S3]
| F42-> [S172;S44]
| F43-> [S103]
| F44-> [S13;S8;S195;S102]
| F45-> [S88]
| F46-> [S121;S99]
| F47-> [S26]
| F48-> [S22;S141;S21]
| F49-> [S10]
| F50-> [S56;S71]
| F51-> [S82]
| F52-> [S54;S16]
| F53-> [S95;S73]
| F54-> [S24;S38]
| F55-> [S78]
| F56-> [S84;S42]
| F57-> [S86;S115]
| F58-> [S49]
| F59-> [S57;S163;S37]
| F60-> [S45]
| F61-> [S142]
| F62-> [S6]
| F63-> [S192;S124;S43]
| F64-> [S47;S94]
| F65-> [S58]
| F66-> [S11]
| F67-> [S92]
| F68-> [S60]
| F69-> [S125;S184]
| F70-> [S31]
| F71-> [S117]
| F72-> [S257]
| F73-> [S170;S236]
| F74-> [S285;S154]
| F75-> [S268]
| F76-> [S139]
| F77-> [S222;S177;S61]
| F78-> [S126;S217]
| F79-> [S53;S232]
| F80-> [S128;S198;S274]
| F81-> [S69;S97]
| F82-> [S183;S347]
| F83-> [S378;S262;S143]
| F84-> [S194;S104]
| F85-> [S157]
| F86-> [S74;S414;S149;S160]
| F87-> [S96;S373;S41;S275]
| F88-> [S230;S178]
| F89-> [S320]
| F90-> [S334;S106]
| F91-> [S120;S239]
| F92-> [S288;S304]
| F93-> [S202;S180]
| F94-> [S155;S246]
| F95-> [S213]
| F96-> [S205]
| F97-> [S295;S138]
| F98-> [S150;S386]
| F99-> [S162;S187]
| F100-> [S282;S77]
| F101-> [S85;S289;S196]
| F102-> [S258;S90]
| F103-> [S114;S348;S277]
| F104-> [S175]
| F105-> [S229;S185]
| F106-> [S395;S188]
| F107-> [S209]
| F108-> [S226;S335;S156]
| F109-> [S354;S272]
| F110-> [S255]
| F111-> [S151;S201;S83]
| F112-> [S240;S189;S107]
| F113-> [S367;S199;S182;S130]
| F114-> [S148;S179;S212]
| F115-> [S137;S144;S113]
| F116-> [S101;S321;S249;S146]
| F117-> [S267;S134]
| F118-> [S225]
| F119-> [S176]
| F120-> [S131]
| F121-> [S132;S210]
| F122-> [S89]
| F123-> [S265]
| F124-> [S207;S214]
| F125-> [S276;S301]
| F126-> [S358;S281]
| F127-> [S174;S215;S152;S165]
| F128-> [S223;S319;S161]
| F129-> [S167]
| F130-> [S140;S111]
| F131-> [S325;S136]
| F132-> [S271]
| F133-> [S317]
| F134-> [S168]
| F135-> [S309]
| F136-> [S333]
| F137-> [S303;S298;S224;S388]
| F138-> [S322;S181;S420]
| F139-> [S418;S261;S250;S206]
| F140-> [S311;S290;S264]
| F141-> [S306;S297]
| F142-> [S340;S153]
| F143-> [S287;S256;S404]
| F144-> [S397;S112]
| F145-> [S283;S474;S280]
| F146-> [S430]
| F147-> [S211]
| F148-> [S529;S310;S292]
| F149-> [S314]
| F150-> [S393;S259;S407]
| F151-> [S286;S242;S431]
| F152-> [S342]
| F153-> [S439;S245]
| F154-> [S254]
| F155-> [S326;S328;S323;S231]
| F156-> [S327;S352;S366;S191]
| F157-> [S380;S502;S200;S251]
| F158-> [S227;S197]
| F159-> [S331;S345]
| F160-> [S498]
| F161-> [S299]
| F162-> [S379;S339;S443]
| F163-> [S260;S234]
| F164-> [S219;S164;S381]
| F165-> [S463;S534;S220]
| F166-> [S390;S284]
| F167-> [S530;S416;S457]
| F168-> [S190;S462]
| F169-> [S408;S238;S465;S237]
| F170-> [S542;S171]
| F171-> [S363;S332;S123]
| F172-> [S422;S521;S336]
| F173-> [S403]
| F174-> [S269;S203]
| F175-> [S235;S401;S278]
| F176-> [S369]
| F177-> [S329;S300]
| F178-> [S243;S307]
| F179-> [S318;S252]
| F180-> [S273]
| F181-> [S186;S382]
| F182-> [S483;S447;S147]
| F183-> [S266;S359;S218]
| F184-> [S383]
| F185-> [S228]
| F186-> [S337]
| F187-> [S481;S575;S302]
| F188-> [S241]
| F189-> [S296;S357;S494]
| F190-> [S343;S263;S519]
| F191-> [S361]
| F192-> [S244;S364]
| F193-> [S411;S456]
| F194-> [S368]
| F195-> [S540;S572;S279;S480]
| F196-> [S437;S497]
| F197-> [S464;S589;S574]
| F198-> [S501;S623;S433]
| F199-> [S385;S371]
| F200-> [S614]
| F201-> [S305;S312]
| F202-> [S313;S520]
| F203-> [S553]
| F204-> [S291;S294]
| F205-> [S479;S406]
| F206-> [S372;S398;S554]
| F207-> [S538;S590;S341]
| F208-> [S578]
| F209-> [S446;S315]
| F210-> [S477;S444]
| F211-> [S507;S460;S365;S402]
| F212-> [S461;S308]
| F213-> [S253;S436]
| F214-> [S487]
| F215-> [S459;S617;S458;S505]
| F216-> [S556;S558;S470]
| F217-> [S499;S448]
| F218-> [S389;S454;S413;S374]
| F219-> [S376]
| F220-> [S270;S518]
| F221-> [S471;S221;S427]
| F222-> [S384;S415;S391]
| F223-> [S441;S493]
| F224-> [S293;S565]
| F225-> [S442;S560;S216]
| F226-> [S417]
| F227-> [S351;S428]
| F228-> [S535]
| F229-> [S370;S622;S375]
| F230-> [S338;S387]
| F231-> [S452;S346]
| F232-> [S353]
| F233-> [S488]
| F234-> [S426;S356]
| F235-> [S475;S524;S360]
| F236-> [S399;S508]
| F237-> [S619;S204]
| F238-> [S512;S409;S489;S539]
| F239-> [S510;S543;S451]
| F240-> [S527;S495;S555]
| F241-> [S573;S392]
| F242-> [S349;S396;S485]
| F243-> [S528]
| F244-> [S550]
| F245-> [S419;S496]
| F246-> [S377;S362]
| F247-> [S445]
| F248-> [S621;S604]
| F249-> [S525;S549]
| F250-> [S476;S533]
| F251-> [S478;S591;S602]
| F252-> [S316;S587;S594]
| F253-> [S506;S564]
| F254-> [S568]
| F255-> [S472]
| F256-> [S544;S618]
| F257-> [S548]
| F258-> [S536;S561]
| F259-> [S620]
| F260-> [S583]
| F261-> [S557;S613;S625;S607]
| F262-> [S593;S516;S405]
| F263-> [S624;S611]
| F264-> [S537;S606]
| F265-> [S514]
| F266-> [S571;S595;S563]
| F267-> [S434;S344]
| F268-> [S455]
| F269-> [S412;S628]
| F270-> [S473;S600;S612]
| F271-> [S355]
| F272-> [S585;S453;S503]
| F273-> [S566;S504;S324;S627]
| F274-> [S394;S350]
| F275-> [S515;S584]
| F276-> [S597;S616]
| F277-> [S562]
| F278-> [S531;S438]
| F279-> [S513]
| F280-> [S440]
| F281-> [S541;S509;S551;S588]
| F282-> [S546;S596;S491]
| F283-> [S467;S429]
| F284-> [S425;S581]
| F285-> [S517;S400]
| F286-> [S466;S526;S468]
| F287-> [S330;S482]
| F288-> [S552;S570]
| F289-> [S490;S523;S615;S592]
| F290-> [S586]
| F291-> [S424]
| F292-> [S421]
| F293-> [S582;S626;S603;S629]
| F294-> [S567;S601;S484]
| F295-> [S500]
| F296-> [S547;S605]
| F297-> [S577]
| F298-> [S599;S532;S450;S522]
| F299-> [S608;S609]
| F300-> [S579;S486]
| F301-> [S511]
| F302-> [S559]
| F303-> [S580;S469]
| F304-> [S610;S423;S410]
| F305-> [S569;S598]
| F306-> [S545;S435]
| F307-> [S449;S492]
| F308-> [S432;S576]
;;
```
We can now encode a simple solver to determine how to find a solution. This simply gives back a list of days corresponding to a day allocation per family.
```{.imandra .input}

let sort_by_days classes class_map = 
  let nums_days = List.fold_left (fun acc day -> 
      let num = (
        List.fold_left (fun inner_acc cl -> 
            let ans = Map.get (cl,day) class_map in 
            ans+inner_acc
          ) 0 classes) in (day,num)::acc
    ) [] [M;T;W;Th;F] in 
  List.sort ~leq:(fun (_,y) (_,z) -> y<=z) nums_days |>
  List.map fst
;;

let rec calc_alloc class_map families alloc = 
  match families with 
  | [] -> true,alloc 
  | h::t -> 
    begin
      let classes = families_class_list h in 
      let days_list = sort_by_days classes class_map in 
      try_all_days days_list t classes class_map class_map alloc alloc
    end 
and try_all_days days_list t classes class_map orig_class_map alloc orig_alloc= 
  match days_list with 
  | [] -> false,orig_alloc
  | h::t_days -> let updated_map = 
                   List.fold_left (fun acc el -> 
                       let ans = Map.get (el,h) acc in 
                       Map.add (el,h) (ans+1) acc) class_map classes in 
    let res = (calc_alloc updated_map t (h::alloc))  in 
    if (fst res) then res else 
      try_all_days t_days t classes orig_class_map orig_class_map alloc alloc [@@program];;
```
The resuling program gives back the answer
```
[F; T; W; T; M; F; Th; T; Th; W; W; W; Th; Th; M; T; M; M; W; W; T; M; Th; F;
 F; W; F; Th; M; W; T; M; F; T; W; F; Th; M; M; F; T; T; W; W; M; W; M; T; F;
 F; M; M; T; M; W; F; Th; F; T; Th; F; M; T; T; T; M; Th; W; M; W; F; Th; W;
 Th; M; Th; T; M; W; Th; M; F; W; W; M; T; W; M; F; T; F; Th; T; W; W; T; Th;
 F; M; M; M; M; Th; W; T; Th; T; F; T; W; M; Th; F; F; Th; Th; T; T; Th; T;
 M; M; F; M; W; W; F; Th; W; Th; M; Th; W; T; T; Th; F; M; M; W; T; T; M; W;
 F; T; F; M; Th; W; F; W; Th; W; M; F; W; T; Th; T; F; Th; T; Th; Th; M; F;
 Th; T; W; Th; F; Th; M; M; W; T; M; T; M; F; T; T; T; T; M; F; M; W; M; M;
 Th; M; F; W; Th; M; Th; F; M; F; T; W; W; F; W; T; W; T; Th; W; T; M; M; F;
 F; M; M; W; T; W; T; F; W; Th; Th; T; Th; W; M; F; W; M; T; M; T; M; M; M;
 F; M; M; Th; T; F; Th; F; F; Th; F; Th; Th; Th; M; F; Th; F; W; W; W; T; M;
 F; M; T; M; M; M; Th; Th; W; F; F; T; W; W; W; T; F; Th; M; Th; T; Th; M;
 Th; M; T; W; M; F; W; Th; M; Th; M; T; W; W; W; M; M; T; T; M; T; T; M; M]
```
We can apply this using a simple print function
```{.imandra .input}
let print_res r = 
  snd @@ List.fold_left (fun (cnt,acc) el -> 
    cnt+1,acc^("Family F"^(Z.to_string cnt)^" -- "^(string_of_day el)^"\n"))
  (0,"")  (List.rev r);;

print_endline @@ print_res @@ snd @@ calc_alloc init_map families [];;
```
Which gives the output
```
Family F0 -- M
Family F1 -- M
Family F2 -- T
Family F3 -- T
Family F4 -- M
Family F5 -- T
Family F6 -- T
Family F7 -- M
Family F8 -- M
Family F9 -- W
Family F10 -- W
Family F11 -- W
Family F12 -- T
Family F13 -- M
Family F14 -- Th
Family F15 -- M
Family F16 -- Th
Family F17 -- W
Family F18 -- F
Family F19 -- M
Family F20 -- W
Family F21 -- T
Family F22 -- M
Family F23 -- Th
Family F24 -- M
Family F25 -- Th
Family F26 -- T
Family F27 -- Th
Family F28 -- M
Family F29 -- Th
Family F30 -- F
Family F31 -- T
Family F32 -- W
Family F33 -- W
Family F34 -- W
Family F35 -- T
Family F36 -- F
Family F37 -- F
Family F38 -- W
Family F39 -- Th
Family F40 -- Th
Family F41 -- M
Family F42 -- M
Family F43 -- M
Family F44 -- T
Family F45 -- M
Family F46 -- F
Family F47 -- M
Family F48 -- T
Family F49 -- W
Family F50 -- W
Family F51 -- W
Family F52 -- F
Family F53 -- Th
Family F54 -- F
Family F55 -- M
Family F56 -- Th
Family F57 -- Th
Family F58 -- Th
Family F59 -- F
Family F60 -- Th
Family F61 -- F
Family F62 -- F
Family F63 -- Th
Family F64 -- F
Family F65 -- T
Family F66 -- Th
Family F67 -- M
Family F68 -- M
Family F69 -- F
Family F70 -- M
Family F71 -- M
Family F72 -- M
Family F73 -- T
Family F74 -- M
Family F75 -- T
Family F76 -- M
Family F77 -- W
Family F78 -- F
Family F79 -- M
Family F80 -- W
Family F81 -- Th
Family F82 -- T
Family F83 -- Th
Family F84 -- Th
Family F85 -- W
Family F86 -- F
Family F87 -- T
Family F88 -- W
Family F89 -- T
Family F90 -- W
Family F91 -- M
Family F92 -- M
Family F93 -- F
Family F94 -- F
Family F95 -- M
Family F96 -- M
Family F97 -- T
Family F98 -- W
Family F99 -- Th
Family F100 -- T
Family F101 -- W
Family F102 -- T
Family F103 -- W
Family F104 -- F
Family F105 -- W
Family F106 -- W
Family F107 -- T
Family F108 -- F
Family F109 -- M
Family F110 -- F
Family F111 -- Th
Family F112 -- M
Family F113 -- Th
Family F114 -- W
Family F115 -- F
Family F116 -- M
Family F117 -- Th
Family F118 -- M
Family F119 -- M
Family F120 -- W
Family F121 -- M
Family F122 -- F
Family F123 -- M
Family F124 -- T
Family F125 -- T
Family F126 -- T
Family F127 -- T
Family F128 -- F
Family F129 -- M
Family F130 -- T
Family F131 -- M
Family F132 -- T
Family F133 -- W
Family F134 -- M
Family F135 -- M
Family F136 -- Th
Family F137 -- F
Family F138 -- Th
Family F139 -- W
Family F140 -- T
Family F141 -- Th
Family F142 -- F
Family F143 -- M
Family F144 -- Th
Family F145 -- Th
Family F146 -- T
Family F147 -- Th
Family F148 -- F
Family F149 -- T
Family F150 -- Th
Family F151 -- T
Family F152 -- W
Family F153 -- F
Family F154 -- M
Family F155 -- W
Family F156 -- Th
Family F157 -- W
Family F158 -- F
Family F159 -- W
Family F160 -- Th
Family F161 -- M
Family F162 -- F
Family F163 -- T
Family F164 -- F
Family F165 -- W
Family F166 -- M
Family F167 -- T
Family F168 -- T
Family F169 -- W
Family F170 -- M
Family F171 -- M
Family F172 -- F
Family F173 -- Th
Family F174 -- T
Family F175 -- T
Family F176 -- W
Family F177 -- Th
Family F178 -- M
Family F179 -- Th
Family F180 -- W
Family F181 -- Th
Family F182 -- F
Family F183 -- W
Family F184 -- W
Family F185 -- M
Family F186 -- F
Family F187 -- M
Family F188 -- M
Family F189 -- T
Family F190 -- Th
Family F191 -- T
Family F192 -- T
Family F193 -- Th
Family F194 -- Th
Family F195 -- F
Family F196 -- F
Family F197 -- Th
Family F198 -- M
Family F199 -- W
Family F200 -- T
Family F201 -- F
Family F202 -- T
Family F203 -- Th
Family F204 -- T
Family F205 -- W
Family F206 -- Th
Family F207 -- M
Family F208 -- M
Family F209 -- M
Family F210 -- M
Family F211 -- F
Family F212 -- Th
Family F213 -- T
Family F214 -- W
Family F215 -- W
Family F216 -- T
Family F217 -- Th
Family F218 -- F
Family F219 -- T
Family F220 -- F
Family F221 -- M
Family F222 -- W
Family F223 -- T
Family F224 -- M
Family F225 -- W
Family F226 -- W
Family F227 -- F
Family F228 -- M
Family F229 -- Th
Family F230 -- W
Family F231 -- M
Family F232 -- T
Family F233 -- Th
Family F234 -- M
Family F235 -- Th
Family F236 -- W
Family F237 -- Th
Family F238 -- F
Family F239 -- W
Family F240 -- M
Family F241 -- W
Family F242 -- Th
Family F243 -- M
Family F244 -- T
Family F245 -- T
Family F246 -- T
Family F247 -- M
Family F248 -- F
Family F249 -- Th
Family F250 -- T
Family F251 -- F
Family F252 -- Th
Family F253 -- F
Family F254 -- W
Family F255 -- M
Family F256 -- T
Family F257 -- M
Family F258 -- M
Family F259 -- F
Family F260 -- F
Family F261 -- T
Family F262 -- M
Family F263 -- W
Family F264 -- M
Family F265 -- W
Family F266 -- W
Family F267 -- T
Family F268 -- T
Family F269 -- F
Family F270 -- M
Family F271 -- M
Family F272 -- Th
Family F273 -- F
Family F274 -- W
Family F275 -- T
Family F276 -- F
Family F277 -- M
Family F278 -- T
Family F279 -- W
Family F280 -- M
Family F281 -- Th
Family F282 -- F
Family F283 -- W
Family F284 -- F
Family F285 -- F
Family F286 -- Th
Family F287 -- M
Family F288 -- T
Family F289 -- W
Family F290 -- W
Family F291 -- M
Family F292 -- M
Family F293 -- T
Family F294 -- M
Family F295 -- Th
Family F296 -- Th
Family F297 -- W
Family F298 -- W
Family F299 -- W
Family F300 -- Th
Family F301 -- T
Family F302 -- Th
Family F303 -- F
Family F304 -- M
Family F305 -- T
Family F306 -- W
Family F307 -- T
Family F308 -- F
```