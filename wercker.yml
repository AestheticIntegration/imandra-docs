box: jekyll/jekyll:3.6.2

build:
  steps:
    - script:
        name: build
        code: |
          set -ex
          git submodule update --init --recursive
          bundle install
          cp jekyll-resources/rouge-lexers/ipl.rb /usr/local/bundle/gems/rouge-2.2.1/lib/rouge/lexers/ipl.rb
          cp jekyll-resources/rouge-lexers/iml.rb /usr/local/bundle/gems/rouge-2.2.1/lib/rouge/lexers/iml.rb
          mkdir _site
          jekyll build

deploy:
  steps:
    - hijonathan/gh-pages@0.2.3:
        basedir: _site
        token: $GITHUB_TOKEN
        branch: gh-pages
