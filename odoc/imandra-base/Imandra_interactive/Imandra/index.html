<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Imandra (imandra-base.Imandra_interactive.Imandra)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">imandra-base</a> &#x00BB; <a href="../index.html">Imandra_interactive</a> &#x00BB; Imandra</nav><h1>Module <code>Imandra_interactive.Imandra</code></h1><nav class="toc"><ul><li><a href="#initialization">Initialization</a></li><li><a href="#processing-statements">Processing Statements</a></li><li><a href="#extension-points">Extension Points</a></li><li><a href="#main-loop">Main Loop</a></li><li><a href="#render-documents">Render Documents</a><ul><li><a href="#string--&gt;-term-and-expr-conversion">String -&gt; Term and Expr conversion</a></li></ul></li><li><a href="#module-system">Module System</a></li></ul></nav></header><section><header><h3 id="initialization"><a href="#initialization" class="anchor"></a>Initialization</h3></header><dl><dt class="spec value" id="val-set_lockdown"><a href="#val-set_lockdown" class="anchor"></a><code><span class="keyword">val</span> set_lockdown : int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_lockdown uid</code> enables lockdown mode. It will restrict what functions are in scope, and will <code>Unix.setuid</code> to the given user ID. <b>NOTE</b>: must be called before <a href="index.html#val-do_init"><code>do_init</code></a> or <a href="index.html#val-loop"><code>loop</code></a></p></dd></dl><dl><dt class="spec value" id="val-do_init"><a href="#val-do_init" class="anchor"></a><code><span class="keyword">val</span> do_init : <span>?&#8288;linenoise:bool</span> <span>&#45;&gt;</span> <span>?&#8288;syntax:<a href="../../Imandra_syntax/Syntax/index.html#type-t">Imandra_syntax.Syntax.t</a></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Initialize the toplevel environment. Can be safely called several times but will only do something on the first call</p></dd></dl></section><section><header><h3 id="processing-statements"><a href="#processing-statements" class="anchor"></a>Processing Statements</h3></header><dl><dt class="spec value" id="val-use_iml"><a href="#val-use_iml" class="anchor"></a><code><span class="keyword">val</span> use_iml : <span>?&#8288;syntax:<a href="../../Imandra_syntax/Syntax/index.html#type-t">Imandra_syntax.Syntax.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;batch:bool</span> <span>&#45;&gt;</span> <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>use_iml file</code> loads the file in imandra, as <code>#use &quot;file&quot;</code> would do.</p></dd></dl><dl><dt class="spec value" id="val-eval_string"><a href="#val-eval_string" class="anchor"></a><code><span class="keyword">val</span> eval_string : <span>?&#8288;interrupted:<a href="../../Imandra_util/Switch/index.html#type-t">Imandra_util.Switch.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;batch:bool</span> <span>&#45;&gt;</span> <span>?&#8288;out:Format.formatter</span> <span>&#45;&gt;</span> <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> <span>?&#8288;loc:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="../../Imandra_surface/Top_result/index.html#type-t">Imandra_surface.Top_result.t</a> list</span></code></dt><dd><p><code>eval_string &quot;1+1;;&quot;</code> will evaluate the given string as an Imandra statement.</p><dl><dt>parameter batch</dt><dd><p>if true, process all events in the string at once</p></dd></dl><dl><dt>returns</dt><dd><p>a list of toplevel results, to be printed somehow Precondition: <code>do_init ()</code> was called.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-eval"><a href="#val-eval" class="anchor"></a><code><span class="keyword">val</span> eval : <span>?&#8288;interrupted:<a href="../../Imandra_util/Switch/index.html#type-t">Imandra_util.Switch.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;out:Format.formatter</span> <span>&#45;&gt;</span> <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> <span>?&#8288;loc:<a href="../../Imandra_util/Iloc/index.html#type-t">Imandra_util.Iloc.t</a></span> <span>&#45;&gt;</span> Parsetree.toplevel_phrase <span>&#45;&gt;</span> <span><a href="../../Imandra_surface/Top_result/index.html#type-t">Imandra_surface.Top_result.t</a> list</span></code></dt><dd><p>evaluate the given toplevel phrase.</p><dl><dt>returns</dt><dd><p>a list of toplevel results, to be printed somehow Precondition: <code>do_init ()</code> was called.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-eval_string_result"><a href="#val-eval_string_result" class="anchor"></a><code><span class="keyword">val</span> eval_string_result : <span>?&#8288;batch:bool</span> <span>&#45;&gt;</span> <span>?&#8288;out:Format.formatter</span> <span>&#45;&gt;</span> <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> <span>?&#8288;loc:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span><a href="../../Imandra_surface/Top_result/index.html#type-t">Imandra_surface.Top_result.t</a> list</span>, exn)</span> Pervasives.result</span></code></dt><dd><p><code>eval_string_result &quot;1+1;;&quot;</code> will evaluate the given string as an Imandra statement.</p><dl><dt>parameter batch</dt><dd><p>if true, process all events in the string at once</p></dd></dl><dl><dt>returns</dt><dd><p><code>Ok l</code> where <code>l</code> is a list of toplevel results, to be printed somehow, if evaluation succeeded; <code>Error e</code> if evaluation failed with exception <code>e</code>. Precondition: <code>do_init ()</code> was called.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-eval_string_iter"><a href="#val-eval_string_iter" class="anchor"></a><code><span class="keyword">val</span> eval_string_iter : <span>?&#8288;out:Format.formatter</span> <span>&#45;&gt;</span> <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> <span>?&#8288;interrupted:<a href="../../Imandra_util/Switch/index.html#type-t">Imandra_util.Switch.t</a></span> <span>&#45;&gt;</span> <span>filename:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>(<span>(<span><a href="../../Imandra_util/Iloc/index.html#type-t">Imandra_util.Iloc.t</a> list</span> * <a href="../../Imandra_util/Console/Capture/index.html#type-t">Imandra_util.Console.Capture.t</a> * <span><span>(<span><a href="../../Imandra_surface/Event/index.html#type-t">Imandra_surface.Event.t</a> list</span>, string)</span> Pervasives.result</span>)</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>eval_string_iter code f</code> evaluates <code>code</code> into a list of events, processes these events one by one, calling <code>f</code> on the result of each event. Each result is: <code>(locations, console, res)</code> Precondition: <code>do_init ()</code> was called.</p></dd></dl><dl><dt class="spec value" id="val-eval_string_returning_string"><a href="#val-eval_string_returning_string" class="anchor"></a><code><span class="keyword">val</span> eval_string_returning_string : string <span>&#45;&gt;</span> string</code></dt><dd><p><code>eval_string_returning_string s</code> evaluates <code>s</code>, which must be a code fragment returning a string, and returns the resulting string value.</p><p>Example:</p><pre><code class="ml"># Imandra.eval_string_returning_string {| &quot;hello &quot; ^ &quot;world&quot; |};;
- : string = &quot;hello world&quot;

# Imandra.eval_string_returning_string {| Printf.sprintf &quot;%B&quot; true |};;
- : string = &quot;true&quot;</code></pre></dd></dl><dl><dt class="spec value" id="val-port"><a href="#val-port" class="anchor"></a><code><span class="keyword">val</span> port : <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> <span>var:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>port ~var expr</code> ports the content of <code>expr</code>, typically a variable (which must have a logic type) into logic mode, into the new variable <code>var</code>.</p><dl><dt>parameter var</dt><dd><p>the name of the variable that will receive the logic-mode value</p></dd></dl><dl><dt>parameter quiet</dt><dd><p>if true, won't print the binding</p></dd></dl><dl><dt>parameter expr</dt><dd><p>a string containing an OCaml expression whose type is defined in logic mode. In general this expression can be a simple variable, or a more complicated computation.</p><p>Example:</p><pre><code class="ml">let a = print_endline &quot;coucou&quot;; 42 [@@program];;

Imandra.port ~var:&quot;logic_a&quot; &quot;a&quot;;;

verify (logic_a=42);;

Imandra.port ~var:&quot;logic_a_succ&quot; &quot;a+1&quot;;;

verify (logic_a_succ=43);;</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-eval_code_fragment"><a href="#val-eval_code_fragment" class="anchor"></a><code><span class="keyword">val</span> eval_code_fragment : <span>?&#8288;quiet:bool</span> <span>&#45;&gt;</span> <a href="../../Imandra_surface/Code_fragment/index.html#type-t">Imandra_surface.Code_fragment.t</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-within_program"><a href="#val-within_program" class="anchor"></a><code><span class="keyword">val</span> within_program : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>within_program f</code> calls <code>f ()</code> in program mode, then restores to the current mode.</p></dd></dl><dl><dt class="spec value" id="val-undo"><a href="#val-undo" class="anchor"></a><code><span class="keyword">val</span> undo : int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>undo n</code> cancels the last <code>n</code> toplevel phrases entered by the user</p></dd></dl><dl><dt class="spec value" id="val-add_plugin"><a href="#val-add_plugin" class="anchor"></a><code><span class="keyword">val</span> add_plugin : <a href="../../Imandra_surface/Plugin/class-t/index.html">Imandra_surface.Plugin.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Add the given plugin and apply it to history retroactively. From now on all events will be processed by this plugin.</p><p>It is simpler to call this as early as possible if one wants to use <code>#reset</code> or <code>#undo</code>.</p><p>See <code>Plugin</code> for more information.</p></dd></dl><dl><dt class="spec value" id="val-add_plugin_pp"><a href="#val-add_plugin_pp" class="anchor"></a><code><span class="keyword">val</span> add_plugin_pp : unit <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_plugin_reflect"><a href="#val-add_plugin_reflect" class="anchor"></a><code><span class="keyword">val</span> add_plugin_reflect : unit <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_plugin_yojson"><a href="#val-add_plugin_yojson" class="anchor"></a><code><span class="keyword">val</span> add_plugin_yojson : unit <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_plugin_gen_json"><a href="#val-add_plugin_gen_json" class="anchor"></a><code><span class="keyword">val</span> add_plugin_gen_json : <span>mod_name:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_plugin_rand"><a href="#val-add_plugin_rand" class="anchor"></a><code><span class="keyword">val</span> add_plugin_rand : <span>?&#8288;mod_name:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt></dl></section><section><header><h3 id="extension-points"><a href="#extension-points" class="anchor"></a>Extension Points</h3></header><div class="spec module" id="module-Custom_extension_point"><a href="#module-Custom_extension_point" class="anchor"></a><code><span class="keyword">module</span> Custom_extension_point = <a href="../../Imandra_syntax/Rewrite_parsetree/index.html#module-Custom_extension">Imandra_syntax.Rewrite_parsetree.Custom_extension</a></code></div><dl><dt class="spec value" id="val-add_custom_extension_expr"><a href="#val-add_custom_extension_expr" class="anchor"></a><code><span class="keyword">val</span> add_custom_extension_expr : string <span>&#45;&gt;</span> <a href="../../Imandra_syntax__Rewrite_parsetree/Custom_extension/index.html#type-expr_tr">Custom_extension_point.expr_tr</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Define a custom extension point</p></dd></dl><dl><dt class="spec value" id="val-add_custom_extension_value_binding"><a href="#val-add_custom_extension_value_binding" class="anchor"></a><code><span class="keyword">val</span> add_custom_extension_value_binding : string <span>&#45;&gt;</span> <a href="../../Imandra_syntax__Rewrite_parsetree/Custom_extension/index.html#type-value_binding_tr">Custom_extension_point.value_binding_tr</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-with_local_custom_extensions"><a href="#val-with_local_custom_extensions" class="anchor"></a><code><span class="keyword">val</span> with_local_custom_extensions : <span><span>(string * <a href="../../Imandra_syntax__Rewrite_parsetree/Custom_extension/index.html#type-tr">Custom_extension_point.tr</a>)</span> list</span> <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl></section><section><header><h3 id="main-loop"><a href="#main-loop" class="anchor"></a>Main Loop</h3></header><dl><dt class="spec value" id="val-loop"><a href="#val-loop" class="anchor"></a><code><span class="keyword">val</span> loop : <span>?&#8288;init:bool</span> <span>&#45;&gt;</span> <span>?&#8288;syntax:<a href="../../Imandra_syntax/Syntax/index.html#type-t">Imandra_syntax.Syntax.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;linenoise:bool</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Main loop for a toplevel that reads on stdin and prints on stdout.</p><dl><dt>parameter init</dt><dd><p>if true, calls <a href="index.html#val-do_init"><code>do_init</code></a> first</p></dd></dl><dl><dt>parameter linenoise</dt><dd><p>if true, use linenoise for interactive input</p></dd></dl><dl><dt>parameter syntax</dt><dd><p>syntax to use</p></dd></dl></dd></dl></section><section><header><h3 id="render-documents"><a href="#render-documents" class="anchor"></a>Render Documents</h3></header><dl><dt class="spec value" id="val-display"><a href="#val-display" class="anchor"></a><code><span class="keyword">val</span> display : <a href="../../Imandra_surface/Document/index.html#type-t">Imandra_surface.Document.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Prints the document a way or another</p></dd></dl><section><header><h4 id="string--&gt;-term-and-expr-conversion"><a href="#string--&gt;-term-and-expr-conversion" class="anchor"></a>String -&gt; Term and Expr conversion</h4></header><dl><dt class="spec value" id="val-term_of_string"><a href="#val-term_of_string" class="anchor"></a><code><span class="keyword">val</span> term_of_string : string <span>&#45;&gt;</span> <a href="../../Imandra_surface/Term/index.html#type-t">Imandra_surface.Term.t</a></code></dt></dl></section></section><section><header><h3 id="module-system"><a href="#module-system" class="anchor"></a>Module System</h3></header><dl><dt class="spec value" id="val-import_file"><a href="#val-import_file" class="anchor"></a><code><span class="keyword">val</span> import_file : <span>?&#8288;syntax:<a href="../../Imandra_syntax/Syntax/index.html#type-t">Imandra_syntax.Syntax.t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Import given module (and its dependencies, recursively) by its file name</p></dd></dl><dl><dt class="spec value" id="val-require_lib"><a href="#val-require_lib" class="anchor"></a><code><span class="keyword">val</span> require_lib : <span>?&#8288;meth:<span>[ `Mod_use <span>| `Import</span> <span>| `Use</span> ]</span></span> <span>&#45;&gt;</span> <span>?&#8288;syntax:<a href="../../Imandra_syntax/Syntax/index.html#type-t">Imandra_syntax.Syntax.t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Require an ocamlfind library and its Imandra attachment, using either <code>import</code> or <code>mod_use</code> to load its content.</p></dd></dl><div class="spec module" id="module-Gist"><a href="#module-Gist" class="anchor"></a><code><span class="keyword">module</span> <a href="Gist/index.html">Gist</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec exception" id="exception-Init_fail"><a href="#exception-Init_fail" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Init_fail</span></code></dt></dl></section></div></body></html>